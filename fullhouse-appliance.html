<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex,nofollow">
    <title>Repair or Replace Calculator | Full House Appliance Repair ‚Äî Madison, WI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 50:'#f0f9ff', 100:'#e0f2fe', 200:'#bae6fd', 300:'#7dd3fc', 400:'#38bdf8', 500:'#0ea5e9', 600:'#0284c7', 700:'#0369a1', 800:'#075985', 900:'#0c4a6e' },
                        dark: { 700:'#1e293b', 800:'#0f172a', 900:'#020617' }
                    },
                    fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] }
                }
            }
        }
    </script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .step-enter { animation: stepIn 0.35s ease-out; }
        @keyframes stepIn { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:translateY(0)} }
        .pulse-glow { animation: glow 2s ease-in-out infinite alternate; }
        @keyframes glow { from{box-shadow:0 0 8px rgba(14,165,233,.3)} to{box-shadow:0 0 20px rgba(14,165,233,.5)} }
        .gauge-fill { transition: width 1.2s ease-out; }
    </style>

    <style>
    /* Kimi UI/UX Improvements */
    .fade-in-up { animation: fadeInUp 0.4s ease-out forwards; }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    .radio-option, [class*="option"], [class*="choice"] { 
        min-height: 52px; transition: all 0.15s ease !important; 
    }
    .radio-option:active, [class*="option"]:active { transform: scale(0.98); }
    .btn-primary:active, [class*="btn"]:active { transform: translateY(1px); }
    /* Better progress bar */
    [class*="progress"] { height: 6px !important; border-radius: 3px; }
    </style>
    
</head>
<body class="bg-dark-900 text-white font-sans min-h-screen">

    <header class="bg-dark-800/90 backdrop-blur border-b border-dark-700/50">
        <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-brand-500 rounded-lg flex items-center justify-center">
                    <i data-lucide="wrench" class="w-5 h-5 text-white"></i>
                </div>
                <div>
                    <h1 class="font-bold text-lg leading-tight">Full House Appliance Repair</h1>
                    <p class="text-xs text-gray-400">Madison, WI ‚Ä¢ (608) 843-7851</p>
                </div>
            </div>
            <span class="text-xs bg-brand-500/20 text-brand-400 px-3 py-1 rounded-full font-medium">Free Diagnostic</span>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 py-8">
        <div class="text-center mb-10">
            <div class="inline-flex items-center gap-2 bg-dark-800 rounded-full px-4 py-2 mb-4">
                <i data-lucide="calculator" class="w-4 h-4 text-brand-400"></i>
                <span class="text-sm text-gray-400">Smart Appliance Tool</span>
            </div>
            <h2 class="text-3xl md:text-4xl font-extrabold mb-3">Should You <span class="text-brand-400">Repair</span> or <span class="text-amber-400">Replace</span>?</h2>
            <p class="text-gray-400 max-w-lg mx-auto">Answer a few questions about your appliance. Get an instant recommendation with estimated repair costs ‚Äî no call required.</p>
        </div>

        <!-- Progress -->
        <div class="max-w-md mx-auto mb-8">
            <div class="flex justify-between text-xs text-gray-400 mb-2">
                <span id="stepLabel">Step 1 of 3</span>
                <span id="stepPct">33%</span>
            </div>
            <div class="h-2 bg-dark-800 rounded-full overflow-hidden">
                <div id="progBar" class="h-full bg-gradient-to-r from-brand-500 to-brand-400 rounded-full transition-all duration-500" style="width:33%"></div>
            </div>
        </div>

        <!-- Step 1: Appliance Type -->
        <div id="step1" class="step-enter">
            <div class="bg-dark-800/60 border border-dark-700/50 rounded-2xl p-6 md:p-8 mb-6">
                <h3 class="text-xl font-bold mb-1 flex items-center gap-2"><i data-lucide="box" class="w-5 h-5 text-brand-400"></i> Your Appliance</h3>
                <p class="text-sm text-gray-400 mb-6">Which appliance is giving you trouble?</p>

                <div class="grid grid-cols-2 md:grid-cols-3 gap-3 mb-6" id="appGrid">
                    <button onclick="selApp(this,'fridge')" class="app-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-center hover:border-brand-500/50 transition-all">
                        <div class="text-3xl mb-2">üßä</div>
                        <div class="text-sm font-medium">Refrigerator</div>
                    </button>
                    <button onclick="selApp(this,'washer')" class="app-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-center hover:border-brand-500/50 transition-all">
                        <div class="text-3xl mb-2">ü´ß</div>
                        <div class="text-sm font-medium">Washer</div>
                    </button>
                    <button onclick="selApp(this,'dryer')" class="app-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-center hover:border-brand-500/50 transition-all">
                        <div class="text-3xl mb-2">üëï</div>
                        <div class="text-sm font-medium">Dryer</div>
                    </button>
                    <button onclick="selApp(this,'dishwasher')" class="app-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-center hover:border-brand-500/50 transition-all">
                        <div class="text-3xl mb-2">üçΩÔ∏è</div>
                        <div class="text-sm font-medium">Dishwasher</div>
                    </button>
                    <button onclick="selApp(this,'oven')" class="app-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-center hover:border-brand-500/50 transition-all">
                        <div class="text-3xl mb-2">üî•</div>
                        <div class="text-sm font-medium">Oven / Stove</div>
                    </button>
                    <button onclick="selApp(this,'microwave')" class="app-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-center hover:border-brand-500/50 transition-all">
                        <div class="text-3xl mb-2">üìª</div>
                        <div class="text-sm font-medium">Microwave</div>
                    </button>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-300 mb-3">How Old Is It?</label>
                    <div class="grid grid-cols-4 gap-3" id="ageGrid">
                        <button onclick="selAge(this,'0-3')" class="age-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-sm font-bold">0-3</div>
                            <div class="text-xs text-gray-400">years</div>
                        </button>
                        <button onclick="selAge(this,'4-7')" class="age-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-sm font-bold">4-7</div>
                            <div class="text-xs text-gray-400">years</div>
                        </button>
                        <button onclick="selAge(this,'8-12')" class="age-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-sm font-bold">8-12</div>
                            <div class="text-xs text-gray-400">years</div>
                        </button>
                        <button onclick="selAge(this,'13+')" class="age-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-sm font-bold">13+</div>
                            <div class="text-xs text-gray-400">years</div>
                        </button>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Brand (optional)</label>
                    <select id="brandSel" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white focus:border-brand-500 focus:outline-none">
                        <option value="">‚Äî Select Brand ‚Äî</option>
                        <option>Whirlpool</option><option>GE</option><option>Samsung</option><option>LG</option>
                        <option>Maytag</option><option>Kenmore</option><option>KitchenAid</option><option>Frigidaire</option>
                        <option>Bosch</option><option>Amana</option><option>Other</option>
                    </select>
                </div>
            </div>
            <div class="text-center">
                <button onclick="goStep(2)" class="bg-brand-500 hover:bg-brand-400 text-white font-semibold px-8 py-3 rounded-xl transition-all pulse-glow">Describe the Problem ‚Üí</button>
            </div>
        </div>

        <!-- Step 2: Symptoms -->
        <div id="step2" class="hidden step-enter">
            <div class="bg-dark-800/60 border border-dark-700/50 rounded-2xl p-6 md:p-8 mb-6">
                <h3 class="text-xl font-bold mb-1 flex items-center gap-2"><i data-lucide="stethoscope" class="w-5 h-5 text-brand-400"></i> What's Happening?</h3>
                <p class="text-sm text-gray-400 mb-6">Select all symptoms that apply.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3" id="symptomGrid">
                    <!-- Filled by JS based on appliance type -->
                </div>
            </div>
            <div class="flex justify-between">
                <button onclick="goStep(1)" class="text-gray-400 hover:text-white font-medium px-6 py-3 transition-all">‚Üê Back</button>
                <button onclick="analyze()" class="bg-amber-500 hover:bg-amber-400 text-dark-900 font-bold px-8 py-3 rounded-xl transition-all pulse-glow">Get My Recommendation ‚Üí</button>
            </div>
        </div>

        <!-- Step 3: Results -->
        <div id="step3" class="hidden step-enter">
            <div class="bg-dark-800/60 border border-dark-700/50 rounded-2xl p-6 md:p-8 mb-6">
                <div class="text-center mb-6">
                    <div id="verdictBadge" class="inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-medium mb-3"></div>
                    <h3 class="text-2xl font-bold" id="verdictTitle"></h3>
                </div>

                <!-- Repair Score Gauge -->
                <div class="bg-dark-900/60 rounded-xl p-6 mb-6">
                    <div class="flex justify-between text-sm mb-2">
                        <span class="text-amber-400 font-medium">Replace</span>
                        <span class="text-green-400 font-medium">Repair</span>
                    </div>
                    <div class="h-4 bg-gradient-to-r from-amber-500/30 via-gray-600/30 to-green-500/30 rounded-full overflow-hidden relative">
                        <div id="gaugeIndicator" class="absolute top-0 h-full w-1.5 bg-white rounded-full transition-all duration-1000" style="left:50%"></div>
                    </div>
                    <div class="text-center mt-3">
                        <span class="text-3xl font-extrabold" id="repairScore">75</span>
                        <span class="text-sm text-gray-400">/100 repair confidence</span>
                    </div>
                </div>

                <!-- Cost Comparison -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="bg-green-500/10 border border-green-500/30 rounded-xl p-4 text-center">
                        <div class="text-xs text-gray-400 mb-1">Estimated Repair</div>
                        <div class="text-2xl font-bold text-green-400" id="repairCost">$150‚Äì$250</div>
                        <div class="text-xs text-gray-400 mt-1" id="repairNote">Parts + labor</div>
                    </div>
                    <div class="bg-amber-500/10 border border-amber-500/30 rounded-xl p-4 text-center">
                        <div class="text-xs text-gray-400 mb-1">New Appliance</div>
                        <div class="text-2xl font-bold text-amber-400" id="replaceCost">$800‚Äì$1,500</div>
                        <div class="text-xs text-gray-400 mt-1">Average for your type</div>
                    </div>
                </div>

                <!-- Likely Issue -->
                <div class="bg-dark-700/30 rounded-xl p-5 mb-6">
                    <h4 class="font-semibold text-sm mb-2 flex items-center gap-2"><i data-lucide="search" class="w-4 h-4 text-brand-400"></i> Likely Issue</h4>
                    <p class="text-sm text-gray-300" id="diagnosisText"></p>
                </div>

                <!-- Remaining Life -->
                <div class="bg-dark-700/30 rounded-xl p-5 mb-6">
                    <h4 class="font-semibold text-sm mb-3 flex items-center gap-2"><i data-lucide="clock" class="w-4 h-4 text-brand-400"></i> Appliance Lifespan</h4>
                    <div class="flex items-center gap-3">
                        <div class="flex-1">
                            <div class="h-3 bg-dark-900 rounded-full overflow-hidden">
                                <div id="lifespanBar" class="h-full bg-gradient-to-r from-green-500 to-amber-500 rounded-full gauge-fill" style="width:0%"></div>
                            </div>
                        </div>
                        <span class="text-sm font-medium" id="lifespanText">6 of 15 years used</span>
                    </div>
                </div>
            </div>

            <!-- Lead Capture -->
            <div id="leadForm" class="bg-gradient-to-br from-brand-600/20 to-dark-800/60 border border-brand-500/30 rounded-2xl p-6 md:p-8 mb-6">
                <h3 class="text-xl font-bold mb-2 text-center">Schedule Your Repair with Ben</h3>
                <p class="text-sm text-gray-400 text-center mb-6">Get an exact diagnosis and quote. Ben responds fast ‚Äî most appointments within 1-3 days.</p>
                <div class="space-y-4 max-w-md mx-auto">
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-xs font-medium text-gray-300 mb-1">Name *</label>
                            <input type="text" id="leadName" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-gray-500 focus:border-brand-500 focus:outline-none" placeholder="Your name">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-300 mb-1">Phone *</label>
                            <input type="tel" id="leadPhone" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-gray-500 focus:border-brand-500 focus:outline-none" placeholder="(608) 555-0000">
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-300 mb-1">Address (Madison area)</label>
                        <input type="text" id="leadAddr" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-gray-500 focus:border-brand-500 focus:outline-none" placeholder="Your address">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-300 mb-1">Anything Else?</label>
                        <textarea id="leadNotes" rows="2" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-gray-500 focus:border-brand-500 focus:outline-none resize-none" placeholder="Model number, when it started, etc."></textarea>
                    </div>
                    <button onclick="submitLead()" id="submitBtn" class="w-full bg-brand-500 hover:bg-brand-400 text-white font-bold py-3 rounded-xl transition-all text-lg">Schedule Repair Visit</button>
                </div>
            </div>

            <div id="successMsg" class="hidden bg-green-500/20 border border-green-500/40 rounded-2xl p-8 text-center mb-6">
                <div class="text-4xl mb-3">‚úÖ</div>
                <h3 class="text-xl font-bold text-green-400 mb-2">Request Sent!</h3>
                <p class="text-gray-300">Ben from Full House Appliance Repair will reach out shortly to confirm your appointment.</p>
                <p class="text-gray-400 text-sm mt-3">Need faster service? Text <a href="tel:6088437851" class="text-brand-400 underline">(608) 843-7851</a> ‚Äî Ben prefers texts!</p>
            </div>
        </div>
    </main>

    <footer class="border-t border-dark-800 py-6 text-center text-xs text-gray-500">
        <p>Built for Full House Appliance Repair LLC ‚Ä¢ 713 S. Main St. #4, Oregon, WI 53575</p>
        <p class="mt-1">Estimates are approximate. Exact pricing determined during on-site diagnosis.</p>
    </footer>

    <script>
        let state = { appliance:null, age:null, brand:'', symptoms:[] };

        const APPLIANCE_DATA = {
            fridge: { lifespan:15, newCost:[800,2200], symptoms:[
                {id:'not-cooling',text:'Not Cooling / Warm Inside',icon:'üå°Ô∏è',repair:[150,350],diag:'Likely a compressor, thermostat, or sealed system issue.'},
                {id:'leaking',text:'Leaking Water',icon:'üíß',repair:[100,250],diag:'Usually a clogged defrost drain or faulty water inlet valve.'},
                {id:'noisy',text:'Making Strange Noises',icon:'üîä',repair:[100,300],diag:'Could be evaporator fan motor, condenser fan, or compressor.'},
                {id:'ice-buildup',text:'Ice Buildup / Frost',icon:'‚ùÑÔ∏è',repair:[120,280],diag:'Typically a defrost heater, thermostat, or timer issue.'},
                {id:'not-running',text:'Won\'t Turn On',icon:'‚ö°',repair:[80,250],diag:'Check power first. Could be start relay, overload, or control board.'},
                {id:'warm-fridge',text:'Freezer OK But Fridge Warm',icon:'ü•∂',repair:[100,300],diag:'Often the evaporator fan motor or damper control.'}
            ]},
            washer: { lifespan:12, newCost:[500,1200], symptoms:[
                {id:'no-spin',text:'Won\'t Spin / Agitate',icon:'üîÑ',repair:[120,300],diag:'Likely a drive belt, motor coupling, or lid switch.'},
                {id:'leaking',text:'Leaking Water',icon:'üíß',repair:[100,250],diag:'Usually a pump, hose, or door seal issue.'},
                {id:'no-drain',text:'Won\'t Drain',icon:'üöø',repair:[100,250],diag:'Clogged drain pump or pump failure.'},
                {id:'noisy',text:'Loud Noise During Cycle',icon:'üîä',repair:[150,350],diag:'Bearing failure, tub seal, or foreign object in drum.'},
                {id:'no-start',text:'Won\'t Start',icon:'‚ö°',repair:[80,250],diag:'Could be lid switch, timer, or control board.'},
                {id:'shaking',text:'Excessive Vibration',icon:'üì≥',repair:[80,200],diag:'Usually shock absorbers or suspension springs.'}
            ]},
            dryer: { lifespan:13, newCost:[400,1100], symptoms:[
                {id:'no-heat',text:'No Heat / Not Drying',icon:'üå°Ô∏è',repair:[100,250],diag:'Heating element, thermal fuse, or gas igniter.'},
                {id:'no-start',text:'Won\'t Start',icon:'‚ö°',repair:[80,200],diag:'Door switch, start switch, or thermal fuse.'},
                {id:'noisy',text:'Squeaking / Thumping',icon:'üîä',repair:[100,250],diag:'Drum rollers, belt, or idler pulley.'},
                {id:'long-dry',text:'Takes Too Long to Dry',icon:'‚è±Ô∏è',repair:[80,200],diag:'Clogged vent, blower wheel, or heating element.'},
                {id:'overheating',text:'Getting Too Hot',icon:'üî•',repair:[100,250],diag:'Cycling thermostat or clogged exhaust vent.'},
                {id:'no-tumble',text:'Drum Not Turning',icon:'üîÑ',repair:[100,250],diag:'Broken belt, motor, or idler pulley.'}
            ]},
            dishwasher: { lifespan:10, newCost:[400,1000], symptoms:[
                {id:'not-cleaning',text:'Not Cleaning Well',icon:'üçΩÔ∏è',repair:[80,200],diag:'Spray arm, wash motor, or water inlet valve.'},
                {id:'leaking',text:'Leaking',icon:'üíß',repair:[100,250],diag:'Door gasket, spray arm seal, or pump.'},
                {id:'no-drain',text:'Won\'t Drain',icon:'üöø',repair:[100,250],diag:'Drain pump, check valve, or clogged drain.'},
                {id:'no-start',text:'Won\'t Start',icon:'‚ö°',repair:[80,200],diag:'Door latch, timer, or control board.'},
                {id:'noisy',text:'Unusual Noise',icon:'üîä',repair:[80,200],diag:'Wash pump motor, spray arm, or chopper blade.'},
                {id:'no-dry',text:'Not Drying Dishes',icon:'‚òÄÔ∏è',repair:[80,200],diag:'Heating element or rinse aid dispenser.'}
            ]},
            oven: { lifespan:15, newCost:[600,2000], symptoms:[
                {id:'no-heat',text:'Not Heating Up',icon:'üå°Ô∏è',repair:[100,300],diag:'Heating element (bake or broil), igniter, or control board.'},
                {id:'uneven',text:'Uneven Cooking',icon:'üçï',repair:[80,250],diag:'Convection fan, temperature sensor, or calibration.'},
                {id:'no-ignite',text:'Gas Won\'t Ignite',icon:'üî•',repair:[100,250],diag:'Igniter, spark module, or safety valve.'},
                {id:'door',text:'Door Won\'t Close / Seal',icon:'üö™',repair:[80,200],diag:'Door hinge, springs, or gasket.'},
                {id:'self-clean',text:'Self-Clean Not Working',icon:'‚ú®',repair:[100,300],diag:'Door lock motor, control board, or thermal fuse.'},
                {id:'burner',text:'Burner Not Working',icon:'‚≠ï',repair:[80,200],diag:'Burner switch, element, or wiring.'}
            ]},
            microwave: { lifespan:9, newCost:[100,500], symptoms:[
                {id:'no-heat',text:'Runs But No Heat',icon:'üå°Ô∏è',repair:[80,200],diag:'Magnetron, diode, or capacitor (high voltage components).'},
                {id:'no-start',text:'Won\'t Turn On',icon:'‚ö°',repair:[60,150],diag:'Door switch, fuse, or control board.'},
                {id:'sparking',text:'Sparking Inside',icon:'‚ö°',repair:[60,150],diag:'Waveguide cover damage or metal rack issue.'},
                {id:'noisy',text:'Loud Humming / Buzzing',icon:'üîä',repair:[80,200],diag:'Magnetron, diode, or turntable motor.'},
                {id:'turntable',text:'Turntable Not Spinning',icon:'üîÑ',repair:[40,120],diag:'Turntable motor or coupler.'},
                {id:'display',text:'Display Not Working',icon:'üì∫',repair:[60,180],diag:'Control board or membrane switch.'}
            ]}
        };

        function selApp(el,val) {
            state.appliance = val;
            document.querySelectorAll('.app-btn').forEach(b => { b.classList.remove('border-brand-500','bg-brand-500/10'); b.classList.add('border-dark-700'); });
            el.classList.add('border-brand-500','bg-brand-500/10'); el.classList.remove('border-dark-700');
        }
        function selAge(el,val) {
            state.age = val;
            document.querySelectorAll('.age-btn').forEach(b => { b.classList.remove('border-brand-500','bg-brand-500/10'); b.classList.add('border-dark-700'); });
            el.classList.add('border-brand-500','bg-brand-500/10'); el.classList.remove('border-dark-700');
        }

        function goStep(n) {
            if(n===2 && state.appliance) buildSymptoms();
            [1,2,3].forEach(i => document.getElementById('step'+i).classList.add('hidden'));
            document.getElementById('step'+n).classList.remove('hidden');
            document.getElementById('stepLabel').textContent = `Step ${n} of 3`;
            document.getElementById('stepPct').textContent = (n*33) + '%';
            document.getElementById('progBar').style.width = (n*33) + '%';
            window.scrollTo({top:0,behavior:'smooth'});
        }

        function buildSymptoms() {
            state.symptoms = [];
            const data = APPLIANCE_DATA[state.appliance];
            const grid = document.getElementById('symptomGrid');
            grid.innerHTML = '';
            data.symptoms.forEach(s => {
                grid.innerHTML += `<button onclick="toggleSym(this,'${s.id}')" class="sym-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-left hover:border-brand-500/50 transition-all">
                    <div class="flex items-center gap-3"><span class="text-2xl">${s.icon}</span><div class="text-sm font-medium">${s.text}</div></div>
                </button>`;
            });
        }

        function toggleSym(el,id) {
            const idx = state.symptoms.indexOf(id);
            if(idx>-1) { state.symptoms.splice(idx,1); el.classList.remove('border-brand-500','bg-brand-500/10'); el.classList.add('border-dark-700'); }
            else { state.symptoms.push(id); el.classList.add('border-brand-500','bg-brand-500/10'); el.classList.remove('border-dark-700'); }
        }

        function analyze() {
            state.brand = document.getElementById('brandSel').value;
            const data = APPLIANCE_DATA[state.appliance] || APPLIANCE_DATA.fridge;
            const ageMap = {'0-3':2,'4-7':5.5,'8-12':10,'13+':14};
            const ageYrs = ageMap[state.age] || 5;
            const lifeUsed = Math.min(ageYrs / data.lifespan, 1);

            // Find primary symptom for diagnosis
            const primarySym = data.symptoms.find(s => state.symptoms.includes(s.id)) || data.symptoms[0];
            const allSyms = data.symptoms.filter(s => state.symptoms.includes(s.id));

            // Calculate repair cost (sum of selected symptoms, with overlap discount)
            let repLow = 0, repHigh = 0;
            allSyms.forEach((s,i) => {
                const mult = i===0 ? 1 : 0.6; // discount overlapping repairs
                repLow += s.repair[0] * mult;
                repHigh += s.repair[1] * mult;
            });
            if(repLow===0) { repLow = primarySym.repair[0]; repHigh = primarySym.repair[1]; }
            repLow = Math.round(repLow); repHigh = Math.round(repHigh);

            // Repair score (higher = more worth repairing)
            let score = 80;
            score -= lifeUsed * 40; // older = less worth repairing
            score -= (allSyms.length - 1) * 8; // more problems = less worth
            const repairRatio = ((repLow+repHigh)/2) / ((data.newCost[0]+data.newCost[1])/2);
            score -= repairRatio * 30; // expensive repair = less worth
            score = Math.max(10, Math.min(95, Math.round(score)));

            const isRepair = score >= 45;

            // Update UI
            const badge = document.getElementById('verdictBadge');
            if(isRepair) {
                badge.className = 'inline-flex items-center gap-2 bg-green-500/20 text-green-400 rounded-full px-4 py-2 text-sm font-medium mb-3';
                badge.innerHTML = '<i data-lucide="check-circle" class="w-4 h-4"></i> Repair Recommended';
                document.getElementById('verdictTitle').textContent = 'Your ' + state.appliance.charAt(0).toUpperCase()+state.appliance.slice(1) + ' Is Worth Repairing';
            } else {
                badge.className = 'inline-flex items-center gap-2 bg-amber-500/20 text-amber-400 rounded-full px-4 py-2 text-sm font-medium mb-3';
                badge.innerHTML = '<i data-lucide="alert-triangle" class="w-4 h-4"></i> Consider Replacing';
                document.getElementById('verdictTitle').textContent = 'Your ' + state.appliance.charAt(0).toUpperCase()+state.appliance.slice(1) + ' May Need Replacing';
            }

            document.getElementById('repairScore').textContent = score;
            document.getElementById('gaugeIndicator').style.left = score + '%';
            document.getElementById('repairCost').textContent = `$${repLow}‚Äì$${repHigh}`;
            document.getElementById('replaceCost').textContent = `$${data.newCost[0].toLocaleString()}‚Äì$${data.newCost[1].toLocaleString()}`;
            document.getElementById('diagnosisText').textContent = primarySym.diag + (allSyms.length > 1 ? ' Multiple symptoms may indicate related underlying issues ‚Äî an on-site diagnosis will pinpoint the exact cause.' : ' Ben can confirm this with a hands-on diagnosis.');

            const lifePct = Math.round(lifeUsed * 100);
            document.getElementById('lifespanBar').style.width = lifePct + '%';
            document.getElementById('lifespanText').textContent = `~${Math.round(ageYrs)} of ${data.lifespan} years used`;

            setTimeout(() => { document.getElementById('lifespanBar').style.width = lifePct + '%'; }, 100);

            localStorage.setItem('fh_analysis', JSON.stringify({...state, score, repLow, repHigh, diagnosis: primarySym.diag, ts:new Date().toISOString()}));
            goStep(3);
            lucide.createIcons();
        }

        function submitLead() {
            const name = document.getElementById('leadName').value.trim();
            const phone = document.getElementById('leadPhone').value.trim();
            if(!name||!phone) { alert('Please enter your name and phone.'); return; }
            const lead = { name, phone, address:document.getElementById('leadAddr').value.trim(), notes:document.getElementById('leadNotes').value.trim(), analysis:JSON.parse(localStorage.getItem('fh_analysis')||'{}'), submitted:new Date().toISOString() };
            localStorage.setItem('fh_lead', JSON.stringify(lead));
            document.getElementById('leadForm').classList.add('hidden');
            document.getElementById('successMsg').classList.remove('hidden');
        }

        lucide.createIcons();
    </script>

<!-- BennyCuTools Purchase CTA ‚Äî injected by inject-cta.py -->
<style>
#bct-cta-bar {
  position: fixed;
  bottom: 48px;
  left: 0;
  right: 0;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  border-top: 2px solid #6366f1;
  padding: 10px 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  z-index: 99998;
  flex-wrap: wrap;
  box-shadow: 0 -4px 20px rgba(0,0,0,0.3);
}
#bct-cta-bar .bct-cta-text {
  color: #e4e4e7;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 14px;
  font-weight: 500;
}
#bct-cta-bar .bct-cta-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 20px;
  background: #6366f1;
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 14px;
  font-weight: 600;
  border: none;
  border-radius: 6px;
  text-decoration: none;
  cursor: pointer;
  transition: background 0.2s, transform 0.1s;
}
#bct-cta-bar .bct-cta-btn:hover {
  background: #4f46e5;
  transform: translateY(-1px);
}
#bct-cta-bar .bct-cta-btn-secondary {
  background: transparent;
  border: 1px solid #6366f1;
  color: #a5b4fc;
}
#bct-cta-bar .bct-cta-btn-secondary:hover {
  background: rgba(99,102,241,0.15);
}
@media (max-width: 600px) {
  #bct-cta-bar {
    flex-direction: column;
    gap: 8px;
    padding: 8px 12px;
    bottom: 44px;
  }
  #bct-cta-bar .bct-cta-text { font-size: 12px; }
  #bct-cta-bar .bct-cta-btn { font-size: 13px; padding: 7px 16px; width: 100%; justify-content: center; }
}
</style>
<div id="bct-cta-bar" role="banner" aria-label="Purchase this tool">
  <span class="bct-cta-text">Like this tool? Make it yours.</span>
  <a class="bct-cta-btn" id="bct-buy-btn" href="https://bennycutools.com/buy.html">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
    Get It ‚Äî $200 One-Time
  </a>
  <a class="bct-cta-btn bct-cta-btn-secondary" href="mailto:cuuper225@gmail.com?subject=Question%20about%20my%20custom%20tool">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
    Questions? Email Ben
  </a>
</div>
<script>
// Auto-fill the buy link with the current tool's page name
(function(){
  try {
    var pg = location.pathname.replace(/.*\//, '').replace('.html','');
    var buyBtn = document.getElementById('bct-buy-btn');
    if (buyBtn && pg) {
      buyBtn.href = 'https://bennycutools.com/buy.html?tool=' + encodeURIComponent(pg);
    }
  } catch(e){}
})();
</script>
<!-- End BennyCuTools Purchase CTA -->

</body>
</html>
