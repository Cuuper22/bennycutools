<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Fence Quote Pro | The Wood Restoration Company</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    
    :root {
      --wood-dark: oklch(0.35 0.08 55);
      --wood-medium: oklch(0.45 0.10 50);
      --wood-light: oklch(0.65 0.12 60);
      --wood-pale: oklch(0.88 0.05 70);
      --wood-cream: oklch(0.96 0.02 80);
      --bark: oklch(0.28 0.06 45);
      --forest: oklch(0.42 0.08 145);
      --forest-light: oklch(0.55 0.10 150);
      --rust: oklch(0.55 0.14 35);
      --rust-light: oklch(0.70 0.12 40);
      --white: oklch(0.99 0 0);
      --gray-100: oklch(0.97 0 0);
      --gray-200: oklch(0.92 0 0);
      --gray-400: oklch(0.70 0 0);
      --gray-600: oklch(0.50 0 0);
      --gray-800: oklch(0.25 0 0);
      --red: oklch(0.55 0.18 25);
      --green: oklch(0.55 0.15 145);
      --blue: oklch(0.55 0.12 250);
      --yellow: oklch(0.75 0.15 85);
      
      --shadow-sm: 0 1px 2px oklch(0 0 0 / 0.06);
      --shadow-md: 0 4px 12px oklch(0 0 0 / 0.08), 0 1px 3px oklch(0 0 0 / 0.05);
      --shadow-lg: 0 8px 24px oklch(0 0 0 / 0.12), 0 2px 6px oklch(0 0 0 / 0.06);
      --shadow-wood: 0 4px 16px oklch(0.35 0.08 55 / 0.15);
      
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      
      --font: 'DM Sans', system-ui, sans-serif;
    }
    
    html { font-size: 16px; }
    
    body {
      font-family: var(--font);
      background: linear-gradient(145deg, var(--wood-cream) 0%, var(--wood-pale) 100%);
      color: var(--gray-800);
      min-height: 100dvh;
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      padding-bottom: 60px;
    }
    
    /* App Shell */
    .app {
      max-width: 480px;
      margin: 0 auto;
      min-height: 100dvh;
      display: flex;
      flex-direction: column;
      background: var(--white);
      box-shadow: var(--shadow-lg);
    }
    
    /* Header */
    .header {
      background: linear-gradient(135deg, var(--wood-dark) 0%, var(--bark) 100%);
      color: var(--white);
      padding: 16px 20px;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .logo-icon {
      width: 36px;
      height: 36px;
      background: var(--wood-light);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .logo-icon svg { width: 22px; height: 22px; stroke: var(--white); fill: none; }
    
    .logo-text {
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: -0.02em;
    }
    
    .logo-sub {
      font-size: 0.7rem;
      opacity: 0.8;
      font-weight: 400;
      margin-top: -2px;
    }
    
    .weather-badge {
      display: flex;
      align-items: center;
      gap: 6px;
      background: oklch(1 0 0 / 0.15);
      padding: 6px 10px;
      border-radius: var(--radius-md);
      font-size: 0.75rem;
      cursor: pointer;
      transition: background 0.15s ease;
    }
    
    .weather-badge:hover { background: oklch(1 0 0 / 0.2); }
    .weather-badge svg { width: 16px; height: 16px; }
    .weather-temp { font-weight: 600; }
    .weather-status { opacity: 0.9; }
    .weather-loading { opacity: 0.7; font-style: italic; }
    
    /* Navigation Tabs */
    .nav-tabs {
      display: flex;
      background: var(--bark);
      padding: 4px;
      gap: 4px;
      border-radius: var(--radius-md);
      margin-top: 12px;
    }
    
    .nav-tab {
      flex: 1;
      padding: 10px 8px;
      background: transparent;
      border: none;
      color: oklch(1 0 0 / 0.7);
      font-family: var(--font);
      font-size: 0.8rem;
      font-weight: 500;
      border-radius: var(--radius-sm);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: all 0.2s ease;
    }
    
    .nav-tab svg { width: 16px; height: 16px; }
    
    .nav-tab:hover { color: var(--white); background: oklch(1 0 0 / 0.1); }
    
    .nav-tab.active {
      background: var(--white);
      color: var(--wood-dark);
      box-shadow: var(--shadow-sm);
    }
    
    .nav-tab.disabled {
      opacity: 0.4;
      cursor: not-allowed;
      position: relative;
    }
    
    .nav-tab .lock-icon {
      width: 10px;
      height: 10px;
      margin-left: 2px;
    }
    
    /* Main Content */
    .main {
      flex: 1;
      overflow-y: auto;
      padding-bottom: 100px;
    }
    
    .view {
      display: none;
      animation: fadeSlideIn 0.3s ease;
    }
    
    .view.active { display: block; }
    
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Section Styles */
    .section {
      padding: 20px;
      border-bottom: 1px solid var(--gray-200);
    }
    
    .section:last-child { border-bottom: none; }
    
    .section-title {
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--gray-600);
      margin-bottom: 12px;
    }
    
    /* Quote Card */
    .quote-card {
      background: linear-gradient(145deg, var(--wood-pale) 0%, var(--wood-cream) 100%);
      border-radius: var(--radius-lg);
      padding: 20px;
      margin: 16px;
      border: 1px solid oklch(0.45 0.10 50 / 0.2);
      box-shadow: var(--shadow-wood);
    }
    
    .quote-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 16px;
    }
    
    .quote-customer {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--wood-dark);
    }
    
    .quote-address {
      font-size: 0.85rem;
      color: var(--gray-600);
      margin-top: 2px;
    }
    
    .quote-date {
      font-size: 0.75rem;
      color: var(--gray-600);
      text-align: right;
    }
    
    .quote-status {
      display: inline-block;
      padding: 3px 8px;
      border-radius: var(--radius-sm);
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.03em;
      margin-top: 4px;
    }
    
    .quote-status.pending { background: var(--yellow); color: var(--gray-800); }
    .quote-status.approved { background: var(--green); color: var(--white); }
    .quote-status.completed { background: var(--blue); color: var(--white); }
    
    .quote-specs {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-bottom: 16px;
    }
    
    .spec-item {
      text-align: center;
      padding: 12px 8px;
      background: var(--white);
      border-radius: var(--radius-md);
    }
    
    .spec-value {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--wood-dark);
    }
    
    .spec-label {
      font-size: 0.7rem;
      color: var(--gray-600);
      margin-top: 2px;
    }
    
    .quote-total {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding-top: 16px;
      border-top: 1px dashed oklch(0.45 0.10 50 / 0.3);
    }
    
    .total-label {
      font-size: 0.85rem;
      color: var(--gray-600);
    }
    
    .total-amount {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--wood-dark);
    }
    
    .quote-actions {
      display: flex;
      gap: 8px;
      margin-top: 16px;
    }
    
    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 20px;
      border: none;
      border-radius: var(--radius-md);
      font-family: var(--font);
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s ease;
    }
    
    .btn:active { transform: scale(0.97); }
    
    .btn svg { width: 18px; height: 18px; }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--wood-medium) 0%, var(--wood-dark) 100%);
      color: var(--white);
      box-shadow: var(--shadow-md);
    }
    
    .btn-primary:hover { box-shadow: var(--shadow-lg); }
    
    .btn-secondary {
      background: var(--white);
      color: var(--wood-dark);
      border: 1px solid var(--gray-200);
    }
    
    .btn-secondary:hover { background: var(--gray-100); }
    
    .btn-ghost {
      background: transparent;
      color: var(--wood-medium);
      padding: 8px 12px;
    }
    
    .btn-ghost:hover { background: var(--gray-100); }
    
    .btn-small {
      padding: 8px 14px;
      font-size: 0.8rem;
    }
    
    .btn-full { width: 100%; }
    
    .btn-icon {
      width: 44px;
      height: 44px;
      padding: 0;
      border-radius: var(--radius-md);
    }
    
    /* Form Styles */
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-label {
      display: block;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--gray-800);
      margin-bottom: 6px;
    }
    
    .form-input {
      width: 100%;
      padding: 14px 16px;
      border: 1.5px solid var(--gray-200);
      border-radius: var(--radius-md);
      font-family: var(--font);
      font-size: 1rem;
      color: var(--gray-800);
      background: var(--white);
      transition: border-color 0.15s ease, box-shadow 0.15s ease;
    }
    
    .form-input:focus {
      outline: none;
      border-color: var(--wood-medium);
      box-shadow: 0 0 0 3px oklch(0.45 0.10 50 / 0.15);
    }
    
    .form-input::placeholder { color: var(--gray-400); }
    
    .form-row {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }
    
    .form-row-3 {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    
    .input-unit {
      position: relative;
    }
    
    .input-unit .form-input {
      padding-right: 40px;
    }
    
    .input-unit-label {
      position: absolute;
      right: 14px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.8rem;
      color: var(--gray-400);
      pointer-events: none;
    }
    
    /* Select Styles */
    .form-select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 14px center;
      padding-right: 44px;
    }
    
    /* Photo Grid */
    .photo-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }
    
    .photo-slot {
      aspect-ratio: 4/3;
      border: 2px dashed var(--gray-200);
      border-radius: var(--radius-md);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--gray-100);
      overflow: hidden;
      position: relative;
    }
    
    .photo-slot:hover {
      border-color: var(--wood-light);
      background: var(--wood-cream);
    }
    
    .photo-slot svg { width: 28px; height: 28px; stroke: var(--gray-400); }
    
    .photo-slot span {
      font-size: 0.75rem;
      color: var(--gray-600);
      font-weight: 500;
    }
    
    .photo-slot.has-photo {
      border: none;
    }
    
    .photo-slot img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .photo-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, oklch(0 0 0 / 0.6) 0%, transparent 50%);
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding-bottom: 8px;
      opacity: 0;
      transition: opacity 0.2s ease;
    }
    
    .photo-slot:hover .photo-overlay { opacity: 1; }
    
    .photo-badge {
      position: absolute;
      top: 8px;
      left: 8px;
      background: var(--wood-dark);
      color: var(--white);
      font-size: 0.65rem;
      font-weight: 600;
      padding: 3px 6px;
      border-radius: 4px;
      text-transform: uppercase;
    }
    
    /* Stain Color Picker */
    .stain-colors {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }
    
    .stain-option {
      aspect-ratio: 1;
      border-radius: var(--radius-md);
      border: 2px solid transparent;
      cursor: pointer;
      position: relative;
      transition: all 0.2s ease;
      box-shadow: var(--shadow-sm);
    }
    
    .stain-option:hover { transform: scale(1.05); }
    
    .stain-option.selected {
      border-color: var(--wood-dark);
      box-shadow: 0 0 0 3px oklch(0.35 0.08 55 / 0.3);
    }
    
    .stain-option::after {
      content: attr(data-name);
      position: absolute;
      bottom: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.65rem;
      color: var(--gray-600);
      white-space: nowrap;
    }
    
    .stain-option svg {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      width: 24px;
      height: 24px;
      stroke: var(--white);
      transition: transform 0.2s ease;
    }
    
    .stain-option.selected svg { transform: translate(-50%, -50%) scale(1); }
    
    /* Calculation Results */
    .calc-results {
      background: var(--gray-100);
      border-radius: var(--radius-lg);
      padding: 20px;
      margin-top: 20px;
    }
    
    .calc-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid var(--gray-200);
    }
    
    .calc-row:last-child { border-bottom: none; }
    
    .calc-label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      color: var(--gray-600);
    }
    
    .calc-label svg { width: 18px; height: 18px; stroke: var(--wood-medium); }
    
    .calc-value {
      font-size: 1rem;
      font-weight: 600;
      color: var(--gray-800);
    }
    
    .calc-total {
      background: var(--wood-dark);
      color: var(--white);
      margin: -20px;
      margin-top: 16px;
      padding: 16px 20px;
      border-radius: 0 0 var(--radius-lg) var(--radius-lg);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .calc-total-label { font-size: 0.9rem; }
    .calc-total-amount { font-size: 1.4rem; font-weight: 700; }
    
    /* Weather Panel */
    .weather-panel {
      background: linear-gradient(135deg, var(--forest) 0%, var(--forest-light) 100%);
      border-radius: var(--radius-lg);
      padding: 20px;
      color: var(--white);
      margin: 16px;
    }
    
    .weather-main {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 16px;
    }
    
    .weather-icon {
      width: 64px;
      height: 64px;
    }
    
    .weather-big-temp {
      font-size: 2.5rem;
      font-weight: 700;
      line-height: 1;
    }
    
    .weather-desc {
      font-size: 0.9rem;
      opacity: 0.9;
    }
    
    .weather-details {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      padding-top: 16px;
      border-top: 1px solid oklch(1 0 0 / 0.2);
    }
    
    .weather-detail {
      text-align: center;
    }
    
    .weather-detail-value {
      font-size: 1.1rem;
      font-weight: 600;
    }
    
    .weather-detail-label {
      font-size: 0.7rem;
      opacity: 0.8;
      margin-top: 2px;
    }
    
    .stain-advice {
      background: oklch(1 0 0 / 0.15);
      border-radius: var(--radius-md);
      padding: 14px;
      margin-top: 16px;
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }
    
    .stain-advice svg {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      margin-top: 2px;
    }
    
    .stain-advice-text {
      font-size: 0.85rem;
      line-height: 1.4;
    }
    
    .advice-good { background: oklch(0.55 0.15 145 / 0.3); }
    .advice-caution { background: oklch(0.75 0.15 85 / 0.3); }
    .advice-bad { background: oklch(0.55 0.18 25 / 0.3); }
    
    /* Jobs List */
    .jobs-list {
      padding: 16px;
    }
    
    .job-card {
      background: var(--white);
      border: 1px solid var(--gray-200);
      border-radius: var(--radius-lg);
      padding: 16px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .job-card:hover {
      border-color: var(--wood-light);
      box-shadow: var(--shadow-md);
    }
    
    .job-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
    }
    
    .job-customer { font-weight: 600; color: var(--gray-800); }
    
    .job-address {
      font-size: 0.8rem;
      color: var(--gray-600);
      margin-top: 2px;
    }
    
    .job-preview {
      display: flex;
      gap: 8px;
      font-size: 0.8rem;
      color: var(--gray-600);
    }
    
    .job-preview-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .job-preview-item svg { width: 14px; height: 14px; }
    
    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 30px;
    }
    
    .empty-state svg {
      width: 80px;
      height: 80px;
      stroke: var(--gray-400);
      margin-bottom: 20px;
    }
    
    .empty-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--gray-800);
      margin-bottom: 8px;
    }
    
    .empty-text {
      font-size: 0.9rem;
      color: var(--gray-600);
      margin-bottom: 24px;
    }
    
    /* Toast */
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--gray-800);
      color: var(--white);
      padding: 14px 24px;
      border-radius: var(--radius-lg);
      font-size: 0.9rem;
      font-weight: 500;
      box-shadow: var(--shadow-lg);
      z-index: 1000;
      opacity: 0;
      transition: all 0.3s ease;
    }
    
    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    
    /* FAB */
    .fab {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, var(--wood-medium) 0%, var(--wood-dark) 100%);
      color: var(--white);
      border: none;
      border-radius: 50%;
      box-shadow: var(--shadow-lg), 0 4px 20px oklch(0.35 0.08 55 / 0.3);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      z-index: 100;
    }
    
    .fab:hover { transform: scale(1.08); box-shadow: var(--shadow-lg), 0 6px 24px oklch(0.35 0.08 55 / 0.4); }
    .fab:active { transform: scale(0.95); }
    .fab svg { width: 28px; height: 28px; }
    
    /* Upsell Banner */
    .upsell-banner {
      background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%);
      border: 1px dashed var(--gray-400);
      border-radius: var(--radius-lg);
      padding: 20px;
      margin: 16px;
      text-align: center;
      opacity: 0.85;
    }
    
    .upsell-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--gray-600);
      margin-bottom: 4px;
    }
    
    .upsell-desc {
      font-size: 0.8rem;
      color: var(--gray-400);
    }
    
    .upsell-badge {
      display: inline-block;
      background: var(--gray-400);
      color: var(--white);
      font-size: 0.65rem;
      font-weight: 600;
      padding: 3px 8px;
      border-radius: 4px;
      text-transform: uppercase;
      margin-top: 8px;
    }
    
    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: oklch(0 0 0 / 0.5);
      z-index: 200;
      display: none;
      align-items: flex-end;
      justify-content: center;
      animation: fadeIn 0.2s ease;
    }
    
    .modal-overlay.show { display: flex; }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .modal {
      background: var(--white);
      width: 100%;
      max-width: 480px;
      max-height: 90dvh;
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
      overflow: hidden;
      animation: slideUp 0.3s ease;
    }
    
    @keyframes slideUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }
    
    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px;
      border-bottom: 1px solid var(--gray-200);
    }
    
    .modal-title {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--gray-800);
    }
    
    .modal-close {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--gray-100);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      transition: background 0.15s ease;
    }
    
    .modal-close:hover { background: var(--gray-200); }
    .modal-close svg { width: 20px; height: 20px; stroke: var(--gray-600); }
    
    .modal-body {
      padding: 20px;
      overflow-y: auto;
      max-height: calc(90dvh - 80px);
    }
    
    .modal-footer {
      padding: 16px 20px;
      border-top: 1px solid var(--gray-200);
      display: flex;
      gap: 12px;
    }
    
    /* Camera View */
    .camera-view {
      position: fixed;
      inset: 0;
      background: black;
      z-index: 300;
      display: none;
      flex-direction: column;
    }
    
    .camera-view.show { display: flex; }
    
    .camera-preview {
      flex: 1;
      position: relative;
      overflow: hidden;
    }
    
    .camera-preview video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .camera-controls {
      padding: 24px;
      display: flex;
      align-items: center;
      justify-content: space-around;
      background: linear-gradient(to top, oklch(0 0 0 / 0.8) 0%, transparent 100%);
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
    }
    
    .camera-btn {
      width: 72px;
      height: 72px;
      border-radius: 50%;
      background: var(--white);
      border: 4px solid oklch(1 0 0 / 0.3);
      cursor: pointer;
      transition: all 0.15s ease;
    }
    
    .camera-btn:active { transform: scale(0.9); }
    
    .camera-close {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: oklch(1 0 0 / 0.2);
      border: none;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    
    .camera-close svg { width: 24px; height: 24px; }
    
    .camera-label {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: oklch(0 0 0 / 0.6);
      color: white;
      padding: 8px 16px;
      border-radius: var(--radius-md);
      font-size: 0.9rem;
      font-weight: 500;
    }
    
    /* Demo Disclaimer */
    #bct-demo-disclaimer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #f8f8f8;
      border-top: 1px solid #ddd;
      padding: 10px 16px;
      font-size: 12px;
      line-height: 1.4;
      color: #666;
      z-index: 99999;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
      gap: 8px 16px;
      text-align: center;
    }
    
    #bct-demo-disclaimer p {
      margin: 0;
      max-width: 700px;
    }
    
    #bct-demo-disclaimer strong {
      color: #333;
    }
    
    #bct-demo-disclaimer a {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: #dc3545;
      color: #fff;
      padding: 5px 12px;
      border-radius: 4px;
      text-decoration: none;
      font-size: 11px;
      font-weight: 500;
      white-space: nowrap;
    }
    
    /* Focus Styles */
    button:focus-visible, input:focus-visible, select:focus-visible, a:focus-visible {
      outline: 2px solid var(--wood-medium);
      outline-offset: 2px;
    }
    
    /* Animations */
    .stagger-1 { animation-delay: 0.05s; }
    .stagger-2 { animation-delay: 0.1s; }
    .stagger-3 { animation-delay: 0.15s; }
    .stagger-4 { animation-delay: 0.2s; }
    
    @media (min-width: 480px) {
      .app {
        margin: 20px auto;
        border-radius: var(--radius-xl);
        min-height: calc(100dvh - 40px);
      }
    }
    
    /* Print Styles */
    @media print {
      .header, .nav-tabs, .fab, .toast, .modal-overlay { display: none !important; }
      .app { box-shadow: none; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="header">
      <div class="header-top">
        <div class="logo">
          <div class="logo-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
              <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
              <line x1="12" y1="6" x2="12" y2="18"/>
              <line x1="8" y1="10" x2="8" y2="18"/>
              <line x1="16" y1="8" x2="16" y2="18"/>
            </svg>
          </div>
          <div>
            <div class="logo-text">Fence Quote Pro</div>
            <div class="logo-sub">The Wood Restoration Company</div>
          </div>
        </div>
        <button class="weather-badge" id="weatherBadge" aria-label="View weather conditions" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <line x1="12" y1="1" x2="12" y2="3"/>
            <line x1="12" y1="21" x2="12" y2="23"/>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
            <line x1="1" y1="12" x2="3" y2="12"/>
            <line x1="21" y1="12" x2="23" y2="12"/>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
          </svg>
          <span id="weatherDisplay" class="weather-loading">Checking...</span>
        </button>
      </div>
      <nav class="nav-tabs" role="tablist" aria-label="Main navigation">
        <button class="nav-tab active" role="tab" aria-selected="true" aria-controls="view-jobs" id="tab-jobs" data-view="jobs" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
            <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
          </svg>
          Jobs
        </button>
        <button class="nav-tab" role="tab" aria-selected="false" aria-controls="view-quote" id="tab-quote" data-view="quote" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="1" x2="12" y2="23"/>
            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
          </svg>
          Quote
        </button>
        <button class="nav-tab" role="tab" aria-selected="false" aria-controls="view-photos" id="tab-photos" data-view="photos" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <circle cx="8.5" cy="8.5" r="1.5"/>
            <polyline points="21 15 16 10 5 21"/>
          </svg>
          Photos
        </button>
        <button class="nav-tab disabled" role="tab" aria-selected="false" aria-disabled="true" title="Available in full version" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 20h9"/>
            <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
          </svg>
          Contracts
          <svg class="lock-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
        </button>
      </nav>
    </header>

    <main class="main" id="mainContent">
      <!-- Jobs View -->
      <section class="view active" id="view-jobs" role="tabpanel" aria-labelledby="tab-jobs">
        <div class="jobs-list" id="jobsList">
          <!-- Jobs render here -->
        </div>
      </section>

      <!-- Quote View -->
      <section class="view" id="view-quote" role="tabpanel" aria-labelledby="tab-quote">
        <div class="section">
          <h2 class="section-title">Customer Info</h2>
          <div class="form-group">
            <label class="form-label" for="customerName">Customer Name</label>
            <input type="text" class="form-input" id="customerName" placeholder="John Smith" autocomplete="name">
          </div>
          <div class="form-group">
            <label class="form-label" for="customerAddress">Property Address</label>
            <input type="text" class="form-input" id="customerAddress" placeholder="123 Oak Street, Marietta, GA" autocomplete="street-address">
          </div>
          <div class="form-group">
            <label class="form-label" for="customerPhone">Phone</label>
            <input type="tel" class="form-input" id="customerPhone" placeholder="(770) 555-1234" autocomplete="tel">
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">Fence Details</h2>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="fenceLength">Total Length</label>
              <div class="input-unit">
                <input type="number" class="form-input" id="fenceLength" placeholder="150" min="1" inputmode="numeric">
                <span class="input-unit-label">ft</span>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label" for="fenceHeight">Height</label>
              <div class="input-unit">
                <input type="number" class="form-input" id="fenceHeight" placeholder="6" min="1" max="12" inputmode="numeric">
                <span class="input-unit-label">ft</span>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label" for="woodType">Wood Type</label>
            <select class="form-input form-select" id="woodType">
              <option value="pine">Pine (Standard)</option>
              <option value="cedar">Cedar</option>
              <option value="cypress">Cypress</option>
              <option value="redwood">Redwood</option>
              <option value="composite">Composite</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" for="condition">Current Condition</label>
            <select class="form-input form-select" id="condition">
              <option value="good">Good - Light cleaning needed</option>
              <option value="fair">Fair - Some gray, minor mildew</option>
              <option value="poor">Poor - Heavy weathering, restoration needed</option>
            </select>
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">Stain Color</h2>
          <div class="stain-colors" role="radiogroup" aria-label="Select stain color">
            <button class="stain-option selected" style="background: #8B7355;" data-stain="natural-oak" data-name="Natural Oak" role="radio" aria-checked="true" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </button>
            <button class="stain-option" style="background: #5C4033;" data-stain="dark-walnut" data-name="Dark Walnut" role="radio" aria-checked="false" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </button>
            <button class="stain-option" style="background: #A0522D;" data-stain="sienna" data-name="Sienna" role="radio" aria-checked="false" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </button>
            <button class="stain-option" style="background: #C4A484;" data-stain="honey" data-name="Honey" role="radio" aria-checked="false" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </button>
            <button class="stain-option" style="background: #704214;" data-stain="chestnut" data-name="Chestnut" role="radio" aria-checked="false" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </button>
            <button class="stain-option" style="background: #3D2B1F;" data-stain="espresso" data-name="Espresso" role="radio" aria-checked="false" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </button>
            <button class="stain-option" style="background: #D2B48C;" data-stain="driftwood" data-name="Driftwood" role="radio" aria-checked="false" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </button>
            <button class="stain-option" style="background: transparent; border: 2px dashed #999;" data-stain="clear" data-name="Clear Seal" role="radio" aria-checked="false" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </button>
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">Estimate</h2>
          <div class="calc-results" id="calcResults">
            <div class="calc-row">
              <span class="calc-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="2" y="2" width="20" height="8" rx="2" ry="2"/>
                  <rect x="2" y="14" width="20" height="8" rx="2" ry="2"/>
                  <line x1="6" y1="6" x2="6.01" y2="6"/>
                  <line x1="6" y1="18" x2="6.01" y2="18"/>
                </svg>
                Square Footage
              </span>
              <span class="calc-value" id="sqft">0 sq ft</span>
            </div>
            <div class="calc-row">
              <span class="calc-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
                  <line x1="3" y1="6" x2="21" y2="6"/>
                  <path d="M16 10a4 4 0 0 1-8 0"/>
                </svg>
                Stain Needed
              </span>
              <span class="calc-value" id="stainGal">0 gallons</span>
            </div>
            <div class="calc-row">
              <span class="calc-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <polyline points="12 6 12 12 16 14"/>
                </svg>
                Est. Labor
              </span>
              <span class="calc-value" id="laborHrs">0 hours</span>
            </div>
            <div class="calc-row">
              <span class="calc-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
                </svg>
                Prep Work
              </span>
              <span class="calc-value" id="prepCost">$0</span>
            </div>
            <div class="calc-total">
              <span class="calc-total-label">Estimated Total</span>
              <span class="calc-total-amount" id="totalPrice">$0</span>
            </div>
          </div>
          <div style="margin-top: 20px; display: flex; gap: 12px;">
            <button class="btn btn-primary btn-full" id="saveQuoteBtn" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                <polyline points="17 21 17 13 7 13 7 21"/>
                <polyline points="7 3 7 8 15 8"/>
              </svg>
              Save Quote
            </button>
            <button class="btn btn-secondary btn-icon" id="shareQuoteBtn" type="button" aria-label="Share quote">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="18" cy="5" r="3"/>
                <circle cx="6" cy="12" r="3"/>
                <circle cx="18" cy="19" r="3"/>
                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
              </svg>
            </button>
          </div>
        </div>
      </section>

      <!-- Photos View -->
      <section class="view" id="view-photos" role="tabpanel" aria-labelledby="tab-photos">
        <div class="section">
          <h2 class="section-title">Job Photos</h2>
          <p style="font-size: 0.85rem; color: var(--gray-600); margin-bottom: 16px;">Tap to capture before and after shots. Photos save with the current job.</p>
          <div class="photo-grid">
            <div class="photo-slot" id="photoBefore" role="button" tabindex="0" aria-label="Capture before photo">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                <circle cx="12" cy="13" r="4"/>
              </svg>
              <span>Before</span>
            </div>
            <div class="photo-slot" id="photoAfter" role="button" tabindex="0" aria-label="Capture after photo">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                <circle cx="12" cy="13" r="4"/>
              </svg>
              <span>After</span>
            </div>
            <div class="photo-slot" id="photoDetail1" role="button" tabindex="0" aria-label="Capture detail photo 1">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                <circle cx="12" cy="13" r="4"/>
              </svg>
              <span>Detail 1</span>
            </div>
            <div class="photo-slot" id="photoDetail2" role="button" tabindex="0" aria-label="Capture detail photo 2">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                <circle cx="12" cy="13" r="4"/>
              </svg>
              <span>Detail 2</span>
            </div>
          </div>
        </div>

        <div class="upsell-banner">
          <div class="upsell-title">Before/After Comparison Generator</div>
          <div class="upsell-desc">Auto-create shareable side-by-side images for your portfolio</div>
          <span class="upsell-badge">Full Version</span>
        </div>
      </section>
    </main>

    <!-- FAB for new quote -->
    <button class="fab" id="newQuoteFab" aria-label="Create new quote" type="button">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="5" x2="12" y2="19"/>
        <line x1="5" y1="12" x2="19" y2="12"/>
      </svg>
    </button>

    <!-- Toast -->
    <div class="toast" id="toast" role="status" aria-live="polite"></div>

    <!-- Weather Modal -->
    <div class="modal-overlay" id="weatherModal">
      <div class="modal">
        <div class="modal-header">
          <h2 class="modal-title">Staining Conditions</h2>
          <button class="modal-close" id="closeWeatherModal" aria-label="Close" type="button">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <div class="modal-body" id="weatherModalBody">
          <!-- Weather content renders here -->
        </div>
      </div>
    </div>

    <!-- Camera View -->
    <div class="camera-view" id="cameraView">
      <div class="camera-preview">
        <video id="cameraVideo" autoplay playsinline></video>
        <div class="camera-label" id="cameraLabel">Before Photo</div>
      </div>
      <div class="camera-controls">
        <button class="camera-close" id="cameraClose" aria-label="Cancel" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
        <button class="camera-btn" id="cameraCapture" aria-label="Take photo" type="button"></button>
        <div style="width: 48px;"></div>
      </div>
    </div>

<div id="bct-demo-disclaimer" role="contentinfo" aria-label="Demo disclaimer">
  <p><strong>DEMO NOTICE:</strong> This tool was created by BennyCuTools as a free demonstration only. It is not affiliated with, endorsed by, or authorized by The Wood Restoration Company. All brand references are used solely for demonstration purposes.</p>
  <a href="mailto:cuuper225@gmail.com?subject=Delete%20Demo%3A%20Wood%20Restoration%20Co&body=I%20am%20the%20owner%20and%20I%20request%20permanent%20deletion%20of%20this%20demo.">Request Permanent Deletion</a>
</div>
  </div>

  <script>
    // App State
    const state = {
      currentView: 'jobs',
      currentJob: null,
      jobs: [],
      weather: null,
      photos: {
        before: null,
        after: null,
        detail1: null,
        detail2: null
      },
      stain: 'natural-oak',
      cameraTarget: null,
      stream: null
    };

    // IndexedDB Setup
    const DB_NAME = 'FenceQuotePro';
    const DB_VERSION = 1;
    let db;

    function openDB() {
      return new Promise((resolve, reject) => {
        const request = indexedDB.open(DB_NAME, DB_VERSION);
        request.onerror = () => reject(request.error);
        request.onsuccess = () => {
          db = request.result;
          resolve(db);
        };
        request.onupgradeneeded = (e) => {
          const database = e.target.result;
          if (!database.objectStoreNames.contains('jobs')) {
            database.createObjectStore('jobs', { keyPath: 'id' });
          }
          if (!database.objectStoreNames.contains('settings')) {
            database.createObjectStore('settings', { keyPath: 'key' });
          }
        };
      });
    }

    async function saveJob(job) {
      return new Promise((resolve, reject) => {
        const tx = db.transaction('jobs', 'readwrite');
        const store = tx.objectStore('jobs');
        store.put(job);
        tx.oncomplete = () => resolve();
        tx.onerror = () => reject(tx.error);
      });
    }

    async function getAllJobs() {
      return new Promise((resolve, reject) => {
        const tx = db.transaction('jobs', 'readonly');
        const store = tx.objectStore('jobs');
        const request = store.getAll();
        request.onsuccess = () => resolve(request.result);
        request.onerror = () => reject(request.error);
      });
    }

    async function deleteJob(id) {
      return new Promise((resolve, reject) => {
        const tx = db.transaction('jobs', 'readwrite');
        const store = tx.objectStore('jobs');
        store.delete(id);
        tx.oncomplete = () => resolve();
        tx.onerror = () => reject(tx.error);
      });
    }

    // Demo Data
    const demoJobs = [
      {
        id: 'demo-1',
        customer: 'Johnson Family',
        address: '1847 Roswell Rd, Marietta, GA',
        phone: '(770) 555-3421',
        date: '2026-02-10',
        status: 'pending',
        length: 185,
        height: 6,
        woodType: 'cedar',
        condition: 'fair',
        stain: 'dark-walnut',
        sqft: 1110,
        gallons: 5,
        laborHrs: 8,
        prepCost: 150,
        total: 1850,
        photos: { before: null, after: null, detail1: null, detail2: null }
      },
      {
        id: 'demo-2',
        customer: 'Patterson Residence',
        address: '3290 Shallowford Rd NE, Atlanta, GA',
        phone: '(404) 555-8712',
        date: '2026-02-08',
        status: 'approved',
        length: 120,
        height: 6,
        woodType: 'pine',
        condition: 'poor',
        stain: 'natural-oak',
        sqft: 720,
        gallons: 4,
        laborHrs: 7,
        prepCost: 200,
        total: 1420,
        photos: { before: null, after: null, detail1: null, detail2: null }
      },
      {
        id: 'demo-3',
        customer: 'Whitfield HOA',
        address: '2100 Johnson Ferry Rd, Marietta, GA',
        phone: '(678) 555-9934',
        date: '2026-02-05',
        status: 'completed',
        length: 450,
        height: 6,
        woodType: 'pine',
        condition: 'fair',
        stain: 'honey',
        sqft: 2700,
        gallons: 11,
        laborHrs: 18,
        prepCost: 350,
        total: 4250,
        photos: { before: null, after: null, detail1: null, detail2: null }
      },
      {
        id: 'demo-4',
        customer: 'Chen Property',
        address: '890 Powers Ferry Rd SE, Marietta, GA',
        phone: '(770) 555-2208',
        date: '2026-02-03',
        status: 'completed',
        length: 95,
        height: 4,
        woodType: 'cedar',
        condition: 'good',
        stain: 'clear',
        sqft: 380,
        gallons: 2,
        laborHrs: 4,
        prepCost: 75,
        total: 680,
        photos: { before: null, after: null, detail1: null, detail2: null }
      }
    ];

    // Weather API (using Open-Meteo - free, no key needed)
    async function fetchWeather() {
      try {
        // Default to Marietta, GA
        let lat = 33.9526;
        let lon = -84.5499;

        // Try geolocation
        if ('geolocation' in navigator) {
          try {
            const pos = await new Promise((resolve, reject) => {
              navigator.geolocation.getCurrentPosition(resolve, reject, { timeout: 5000 });
            });
            lat = pos.coords.latitude;
            lon = pos.coords.longitude;
          } catch (e) {
            console.log('Using default location');
          }
        }

        const response = await fetch(
          `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m&daily=precipitation_probability_max&timezone=America/New_York`
        );
        const data = await response.json();
        
        state.weather = {
          temp: Math.round(data.current.temperature_2m * 9/5 + 32),
          humidity: data.current.relative_humidity_2m,
          wind: Math.round(data.current.wind_speed_10m * 0.621371),
          weatherCode: data.current.weather_code,
          rainChance: data.daily.precipitation_probability_max[0]
        };

        updateWeatherBadge();
      } catch (e) {
        console.error('Weather fetch failed:', e);
        document.getElementById('weatherDisplay').textContent = 'Unavailable';
      }
    }

    function getWeatherIcon(code) {
      if (code <= 3) return 'sunny';
      if (code <= 48) return 'cloudy';
      if (code <= 67) return 'rainy';
      if (code <= 77) return 'snowy';
      return 'stormy';
    }

    function getStainAdvice() {
      if (!state.weather) return { type: 'unknown', text: 'Weather data unavailable' };
      
      const { temp, humidity, rainChance } = state.weather;
      
      if (rainChance > 40) {
        return { type: 'bad', text: `High rain chance (${rainChance}%). Stain needs 24-48 hours to dry. Consider rescheduling.` };
      }
      if (temp < 50) {
        return { type: 'caution', text: `Temperature is ${temp}F. Most stains need 50F+ to cure properly. May take longer to dry.` };
      }
      if (humidity > 85) {
        return { type: 'caution', text: `Humidity is ${humidity}%. High moisture slows drying. Allow extra cure time.` };
      }
      if (temp >= 50 && temp <= 90 && humidity < 80 && rainChance < 30) {
        return { type: 'good', text: `Great conditions. ${temp}F, ${humidity}% humidity, ${rainChance}% rain chance. Perfect for staining.` };
      }
      return { type: 'caution', text: `Conditions are OK. Monitor weather before starting.` };
    }

    function updateWeatherBadge() {
      const display = document.getElementById('weatherDisplay');
      if (state.weather) {
        display.innerHTML = `<span class="weather-temp">${state.weather.temp}F</span>`;
        display.classList.remove('weather-loading');
      }
    }

    function renderWeatherModal() {
      const body = document.getElementById('weatherModalBody');
      if (!state.weather) {
        body.innerHTML = '<p style="text-align: center; padding: 40px;">Loading weather data...</p>';
        return;
      }

      const advice = getStainAdvice();
      const iconMap = {
        sunny: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>`,
        cloudy: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"/></svg>`,
        rainy: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="16" y1="13" x2="16" y2="21"/><line x1="8" y1="13" x2="8" y2="21"/><line x1="12" y1="15" x2="12" y2="23"/><path d="M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"/></svg>`
      };

      body.innerHTML = `
        <div class="weather-panel">
          <div class="weather-main">
            <div class="weather-icon">${iconMap[getWeatherIcon(state.weather.weatherCode)] || iconMap.sunny}</div>
            <div>
              <div class="weather-big-temp">${state.weather.temp}F</div>
              <div class="weather-desc">${getWeatherDescription(state.weather.weatherCode)}</div>
            </div>
          </div>
          <div class="weather-details">
            <div class="weather-detail">
              <div class="weather-detail-value">${state.weather.humidity}%</div>
              <div class="weather-detail-label">Humidity</div>
            </div>
            <div class="weather-detail">
              <div class="weather-detail-value">${state.weather.wind} mph</div>
              <div class="weather-detail-label">Wind</div>
            </div>
            <div class="weather-detail">
              <div class="weather-detail-value">${state.weather.rainChance}%</div>
              <div class="weather-detail-label">Rain Chance</div>
            </div>
          </div>
          <div class="stain-advice advice-${advice.type}">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="16" x2="12" y2="12"/>
              <line x1="12" y1="8" x2="12.01" y2="8"/>
            </svg>
            <div class="stain-advice-text">${advice.text}</div>
          </div>
        </div>
      `;
    }

    function getWeatherDescription(code) {
      if (code === 0) return 'Clear sky';
      if (code <= 3) return 'Partly cloudy';
      if (code <= 48) return 'Foggy';
      if (code <= 57) return 'Drizzle';
      if (code <= 67) return 'Rain';
      if (code <= 77) return 'Snow';
      return 'Thunderstorm';
    }

    // UI Helpers
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    function switchView(view) {
      state.currentView = view;
      
      // Update tabs
      document.querySelectorAll('.nav-tab').forEach(tab => {
        const isActive = tab.dataset.view === view;
        tab.classList.toggle('active', isActive);
        tab.setAttribute('aria-selected', isActive);
      });
      
      // Update views
      document.querySelectorAll('.view').forEach(v => {
        v.classList.toggle('active', v.id === `view-${view}`);
      });
    }

    function calculateQuote() {
      const length = parseFloat(document.getElementById('fenceLength').value) || 0;
      const height = parseFloat(document.getElementById('fenceHeight').value) || 6;
      const condition = document.getElementById('condition').value;
      const woodType = document.getElementById('woodType').value;

      // Both sides of fence
      const sqft = length * height * 2;
      
      // Coverage: ~250-300 sq ft per gallon for stain
      const gallons = Math.ceil(sqft / 275);
      
      // Labor: ~100-150 sq ft per hour
      const laborHrs = Math.ceil(sqft / 120);
      
      // Prep cost based on condition
      const prepMultiplier = { good: 0.5, fair: 1, poor: 1.5 };
      const prepCost = Math.round(length * 1.5 * (prepMultiplier[condition] || 1));
      
      // Wood type multiplier
      const woodMultiplier = { pine: 1, cedar: 1.15, cypress: 1.2, redwood: 1.3, composite: 0.8 };
      
      // Price per sq ft (including labor, materials, overhead)
      const basePricePerSqft = 1.25;
      const pricePerSqft = basePricePerSqft * (woodMultiplier[woodType] || 1);
      
      // Total
      const materialLabor = sqft * pricePerSqft;
      const total = Math.round(materialLabor + prepCost);

      // Update UI
      document.getElementById('sqft').textContent = `${sqft.toLocaleString()} sq ft`;
      document.getElementById('stainGal').textContent = `${gallons} gallon${gallons !== 1 ? 's' : ''}`;
      document.getElementById('laborHrs').textContent = `${laborHrs} hour${laborHrs !== 1 ? 's' : ''}`;
      document.getElementById('prepCost').textContent = `$${prepCost}`;
      document.getElementById('totalPrice').textContent = `$${total.toLocaleString()}`;

      return { sqft, gallons, laborHrs, prepCost, total };
    }

    function renderJobs() {
      const container = document.getElementById('jobsList');
      const jobs = state.jobs.sort((a, b) => new Date(b.date) - new Date(a.date));

      if (jobs.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
              <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
              <line x1="9" y1="12" x2="15" y2="12"/>
              <line x1="9" y1="16" x2="13" y2="16"/>
            </svg>
            <div class="empty-title">No jobs yet</div>
            <div class="empty-text">Tap the + button to create your first quote</div>
          </div>
        `;
        return;
      }

      container.innerHTML = jobs.map(job => `
        <article class="job-card" data-id="${job.id}" tabindex="0" role="button" aria-label="View ${job.customer} job">
          <div class="job-card-header">
            <div>
              <div class="job-customer">${escapeHtml(job.customer)}</div>
              <div class="job-address">${escapeHtml(job.address)}</div>
            </div>
            <span class="quote-status ${job.status}">${job.status}</span>
          </div>
          <div class="job-preview">
            <span class="job-preview-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="2" y="2" width="20" height="8" rx="2" ry="2"/>
              </svg>
              ${job.sqft} sq ft
            </span>
            <span class="job-preview-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="1" x2="12" y2="23"/>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
              </svg>
              $${job.total.toLocaleString()}
            </span>
            <span class="job-preview-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                <line x1="16" y1="2" x2="16" y2="6"/>
                <line x1="8" y1="2" x2="8" y2="6"/>
                <line x1="3" y1="10" x2="21" y2="10"/>
              </svg>
              ${formatDate(job.date)}
            </span>
          </div>
        </article>
      `).join('');

      // Add click handlers
      container.querySelectorAll('.job-card').forEach(card => {
        card.addEventListener('click', () => loadJob(card.dataset.id));
        card.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            loadJob(card.dataset.id);
          }
        });
      });
    }

    function loadJob(id) {
      const job = state.jobs.find(j => j.id === id);
      if (!job) return;

      state.currentJob = job;
      state.photos = { ...job.photos };

      // Fill form
      document.getElementById('customerName').value = job.customer;
      document.getElementById('customerAddress').value = job.address;
      document.getElementById('customerPhone').value = job.phone || '';
      document.getElementById('fenceLength').value = job.length;
      document.getElementById('fenceHeight').value = job.height;
      document.getElementById('woodType').value = job.woodType;
      document.getElementById('condition').value = job.condition;

      // Select stain
      document.querySelectorAll('.stain-option').forEach(opt => {
        const isSelected = opt.dataset.stain === job.stain;
        opt.classList.toggle('selected', isSelected);
        opt.setAttribute('aria-checked', isSelected);
      });
      state.stain = job.stain;

      // Update photos
      updatePhotoSlots();

      calculateQuote();
      switchView('quote');
    }

    function clearForm() {
      state.currentJob = null;
      state.photos = { before: null, after: null, detail1: null, detail2: null };
      
      document.getElementById('customerName').value = '';
      document.getElementById('customerAddress').value = '';
      document.getElementById('customerPhone').value = '';
      document.getElementById('fenceLength').value = '';
      document.getElementById('fenceHeight').value = '';
      document.getElementById('woodType').value = 'pine';
      document.getElementById('condition').value = 'good';
      
      document.querySelectorAll('.stain-option').forEach((opt, i) => {
        const isFirst = i === 0;
        opt.classList.toggle('selected', isFirst);
        opt.setAttribute('aria-checked', isFirst);
      });
      state.stain = 'natural-oak';
      
      updatePhotoSlots();
      calculateQuote();
    }

    async function saveCurrentQuote() {
      const name = document.getElementById('customerName').value.trim();
      const address = document.getElementById('customerAddress').value.trim();
      
      if (!name || !address) {
        showToast('Please enter customer name and address');
        return;
      }

      const length = parseFloat(document.getElementById('fenceLength').value) || 0;
      const height = parseFloat(document.getElementById('fenceHeight').value) || 6;
      
      if (length === 0) {
        showToast('Please enter fence length');
        return;
      }

      const calc = calculateQuote();

      const job = {
        id: state.currentJob?.id || `job-${Date.now()}`,
        customer: name,
        address: address,
        phone: document.getElementById('customerPhone').value.trim(),
        date: new Date().toISOString().split('T')[0],
        status: state.currentJob?.status || 'pending',
        length: length,
        height: height,
        woodType: document.getElementById('woodType').value,
        condition: document.getElementById('condition').value,
        stain: state.stain,
        sqft: calc.sqft,
        gallons: calc.gallons,
        laborHrs: calc.laborHrs,
        prepCost: calc.prepCost,
        total: calc.total,
        photos: { ...state.photos }
      };

      await saveJob(job);
      
      // Update state
      const existingIdx = state.jobs.findIndex(j => j.id === job.id);
      if (existingIdx >= 0) {
        state.jobs[existingIdx] = job;
      } else {
        state.jobs.push(job);
      }

      state.currentJob = job;
      renderJobs();
      showToast('Quote saved');
    }

    async function shareQuote() {
      const name = document.getElementById('customerName').value.trim() || 'Customer';
      const total = document.getElementById('totalPrice').textContent;
      const sqft = document.getElementById('sqft').textContent;
      
      const text = `Fence Staining Quote for ${name}\n\nTotal Area: ${sqft}\nEstimated Total: ${total}\n\nThe Wood Restoration Company\n37 Years of Quality Service\n(678) 560-5030`;
      
      if (navigator.share) {
        try {
          await navigator.share({ title: 'Fence Quote', text });
        } catch (e) {
          if (e.name !== 'AbortError') {
            fallbackCopy(text);
          }
        }
      } else {
        fallbackCopy(text);
      }
    }

    async function fallbackCopy(text) {
      try {
        await navigator.clipboard.writeText(text);
        showToast('Quote copied to clipboard');
      } catch (e) {
        showToast('Could not share quote');
      }
    }

    // Camera Functions
    async function openCamera(target) {
      state.cameraTarget = target;
      const labelMap = {
        before: 'Before Photo',
        after: 'After Photo',
        detail1: 'Detail Photo 1',
        detail2: 'Detail Photo 2'
      };
      document.getElementById('cameraLabel').textContent = labelMap[target] || 'Photo';

      try {
        const stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: 'environment', width: { ideal: 1920 }, height: { ideal: 1080 } }
        });
        state.stream = stream;
        const video = document.getElementById('cameraVideo');
        video.srcObject = stream;
        document.getElementById('cameraView').classList.add('show');
      } catch (e) {
        console.error('Camera error:', e);
        showToast('Could not access camera');
      }
    }

    function closeCamera() {
      if (state.stream) {
        state.stream.getTracks().forEach(track => track.stop());
        state.stream = null;
      }
      document.getElementById('cameraView').classList.remove('show');
    }

    function capturePhoto() {
      const video = document.getElementById('cameraVideo');
      const canvas = document.createElement('canvas');
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(video, 0, 0);
      
      const dataUrl = canvas.toDataURL('image/jpeg', 0.8);
      state.photos[state.cameraTarget] = dataUrl;
      
      updatePhotoSlots();
      closeCamera();
      showToast('Photo captured');
    }

    function updatePhotoSlots() {
      ['before', 'after', 'detail1', 'detail2'].forEach(key => {
        const slot = document.getElementById(`photo${key.charAt(0).toUpperCase() + key.slice(1)}`);
        if (state.photos[key]) {
          slot.classList.add('has-photo');
          slot.innerHTML = `
            <img src="${state.photos[key]}" alt="${key} photo">
            <span class="photo-badge">${key}</span>
            <div class="photo-overlay">
              <button class="btn btn-small btn-secondary" type="button">Retake</button>
            </div>
          `;
        } else {
          slot.classList.remove('has-photo');
          slot.innerHTML = `
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
              <circle cx="12" cy="13" r="4"/>
            </svg>
            <span>${key.charAt(0).toUpperCase() + key.slice(1).replace(/\d/, ' $&')}</span>
          `;
        }
      });
    }

    // Utilities
    function escapeHtml(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }

    function formatDate(dateStr) {
      const date = new Date(dateStr);
      return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
    }

    // Auth Check
    function checkAuth() {
      const params = new URLSearchParams(window.location.search);
      const key = params.get('key');
      if (key) {
        // Simple hash check
        let hash = 0;
        for (let i = 0; i < key.length; i++) {
          hash = ((hash << 5) - hash) + key.charCodeAt(i);
          hash |= 0;
        }
        if (hash === 1897980662) {
          localStorage.setItem('fence-quote-auth', 'true');
          return true;
        }
      }
      return localStorage.getItem('fence-quote-auth') === 'true';
    }

    // Initialize
    async function init() {
      // Check auth
      if (!checkAuth()) {
        document.body.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; height: 100vh; text-align: center; padding: 20px;">
            <div>
              <h1 style="font-size: 1.5rem; margin-bottom: 10px;">Access Required</h1>
              <p style="color: #666;">Please use the link provided in your email to access this tool.</p>
            </div>
          </div>
        `;
        return;
      }

      // Open database
      await openDB();

      // Load jobs
      state.jobs = await getAllJobs();

      // Load demo data if first time
      if (state.jobs.length === 0) {
        for (const job of demoJobs) {
          await saveJob(job);
        }
        state.jobs = demoJobs;
      }

      renderJobs();
      calculateQuote();
      fetchWeather();

      // Event Listeners
      document.querySelectorAll('.nav-tab:not(.disabled)').forEach(tab => {
        tab.addEventListener('click', () => {
          if (tab.dataset.view) switchView(tab.dataset.view);
        });
      });

      document.getElementById('newQuoteFab').addEventListener('click', () => {
        clearForm();
        switchView('quote');
      });

      document.getElementById('saveQuoteBtn').addEventListener('click', saveCurrentQuote);
      document.getElementById('shareQuoteBtn').addEventListener('click', shareQuote);

      // Stain color selection
      document.querySelectorAll('.stain-option').forEach(opt => {
        opt.addEventListener('click', () => {
          document.querySelectorAll('.stain-option').forEach(o => {
            o.classList.remove('selected');
            o.setAttribute('aria-checked', 'false');
          });
          opt.classList.add('selected');
          opt.setAttribute('aria-checked', 'true');
          state.stain = opt.dataset.stain;
        });
      });

      // Form inputs trigger recalculation
      ['fenceLength', 'fenceHeight', 'woodType', 'condition'].forEach(id => {
        document.getElementById(id).addEventListener('input', calculateQuote);
        document.getElementById(id).addEventListener('change', calculateQuote);
      });

      // Weather modal
      document.getElementById('weatherBadge').addEventListener('click', () => {
        renderWeatherModal();
        document.getElementById('weatherModal').classList.add('show');
      });

      document.getElementById('closeWeatherModal').addEventListener('click', () => {
        document.getElementById('weatherModal').classList.remove('show');
      });

      document.getElementById('weatherModal').addEventListener('click', (e) => {
        if (e.target.id === 'weatherModal') {
          document.getElementById('weatherModal').classList.remove('show');
        }
      });

      // Photo slots
      ['before', 'after', 'detail1', 'detail2'].forEach(key => {
        const id = `photo${key.charAt(0).toUpperCase() + key.slice(1)}`;
        document.getElementById(id).addEventListener('click', () => openCamera(key));
      });

      // Camera controls
      document.getElementById('cameraClose').addEventListener('click', closeCamera);
      document.getElementById('cameraCapture').addEventListener('click', capturePhoto);

      // Keyboard escape for modals
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          document.getElementById('weatherModal').classList.remove('show');
          closeCamera();
        }
      });
    }

    init();
  </script>
</body>
</html>
