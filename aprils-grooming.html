<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>April's Furry Tail Mobile Pet Grooming</title>
    <!-- Google Fonts: DM Sans -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom CSS */
        :root {
            --primary-coral: #e8736c;
            --accent-teal: #4ecdc4;
            --bg-cream: #faf3e0;
            --text-charcoal: #2c3e50;
        }
        body {
            font-family: 'DM Sans', sans-serif;
            background-color: var(--bg-cream);
            color: var(--text-charcoal);
        }
        .paw-pattern-bg {
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23e8736c' opacity='0.1'%3E%3Ccircle cx='25' cy='25' r='5'/%3E%3Ccircle cx='40' cy='15' r='5'/%3E%3Ccircle cx='10' cy='15' r='5'/%3E%3Ccircle cx='25' cy='40' r='10'/%3E%3C/g%3E%3C/svg%3E");
            background-size: 50px 50px;
            background-repeat: repeat;
        }

        /* Custom Tailwind configuration for colors */
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        coral: '#e8736c',
                        teal: '#4ecdc4',
                        cream: '#faf3e0',
                        charcoal: '#2c3e50',
                    }
                }
            }
        }

        .active-tab {
            border-color: var(--primary-coral);
            color: var(--primary-coral);
        }

        /* Paw stamp animation for confirmation */
        @keyframes pawPrintFadeIn {
            0% { opacity: 0; transform: scale(0.5); }
            100% { opacity: 1; transform: scale(1); }
        }
        .paw-stamp {
            font-size: 4rem;
            animation: pawPrintFadeIn 0.5s ease-out forwards;
            display: inline-block;
        }

        /* Pet silhouette styles */
        .silhouette {
            width: 80px;
            height: 80px;
            background-color: var(--accent-teal);
            border-radius: 50%;
            position: relative;
            overflow: hidden;
        }
        .silhouette.dog::before {
            content: '🐕'; /* Example simple dog icon */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            color: white;
        }
        .silhouette.cat::before {
            content: '🐈'; /* Example simple cat icon */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            color: white;
        }

        /* Masonry Grid (simple flexbox simulation for responsiveness) */
        .masonry-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .masonry-item {
            flex: 1 1 150px; /* Adjust as needed for various screen sizes */
            max-width: calc(50% - 0.5rem); /* Two columns on larger screens */
        }
        @media (min-width: 768px) {
            .masonry-item {
                max-width: calc(33.333% - 0.666rem); /* Three columns */
            }
        }
        @media (min-width: 1024px) {
            .masonry-item {
                max-width: calc(25% - 0.75rem); /* Four columns */
            }
        }
    </style>

    <style>
    /* Kimi UI/UX Improvements */
    .fade-in-up { animation: fadeInUp 0.4s ease-out forwards; }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    .radio-option, [class*="option"], [class*="choice"] { 
        min-height: 52px; transition: all 0.15s ease !important; 
    }
    .radio-option:active, [class*="option"]:active { transform: scale(0.98); }
    .btn-primary:active, [class*="btn"]:active { transform: translateY(1px); }
    /* Better progress bar */
    [class*="progress"] { height: 6px !important; border-radius: 3px; }
    </style>
    
</head>
<body class="paw-pattern-bg min-h-screen flex flex-col">
    <header class="bg-coral text-white p-4 text-center shadow-md">
        <h1 class="text-3xl font-bold">April's Furry Tail Mobile Pet Grooming</h1>
        <p class="text-lg">Longview, TX</p>
    </header>

    <!-- New Client Special Banner -->
    <div id="newClientBanner" class="bg-teal text-white p-2 text-center text-sm md:text-base font-semibold relative">
        New Client Special: 15% off!
        <button onclick="document.getElementById('newClientBanner').style.display='none'" class="absolute right-2 top-1/2 -translate-y-1/2 text-white hover:text-gray-200">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>
    </div>

    <main class="container mx-auto p-4 flex-grow">
        <!-- Tabs Navigation -->
        <div class="flex border-b border-gray-200 mb-4 bg-white rounded-t-lg shadow-sm">
            <button class="tab-button flex-1 py-3 px-4 text-center font-medium text-charcoal hover:text-coral border-b-2 border-transparent hover:border-coral active-tab" data-tab="bookGrooming">
                Book Your Grooming
            </button>
            <button class="tab-button flex-1 py-3 px-4 text-center font-medium text-charcoal hover:text-coral border-b-2 border-transparent hover:border-coral" data-tab="myPets">
                My Pets
            </button>
            <button class="tab-button flex-1 py-3 px-4 text-center font-medium text-charcoal hover:text-coral border-b-2 border-transparent hover:border-coral" data-tab="petGallery">
                Pet Gallery
            </button>
        </div>

        <!-- Tab Content -->
        <div id="bookGrooming" class="tab-content bg-white p-6 rounded-b-lg shadow-lg">
            <h2 class="text-2xl font-bold text-coral mb-4">Book Your Grooming</h2>
            <p class="text-sm text-gray-600 mb-4">
                April serves Longview, Tyler, Kilgore, and surrounding East Texas.
            </p>

            <!-- Owner Info -->
            <section class="mb-8">
                <h3 class="text-xl font-semibold text-charcoal mb-3 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user mr-2 text-teal"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                    Your Information
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="ownerName" class="block text-sm font-medium text-gray-700">Name <span class="text-red-500">*</span></label>
                        <input type="text" id="ownerName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" required>
                        <p id="ownerNameError" class="text-red-500 text-xs mt-1 hidden">Oops! We need your name.</p>
                    </div>
                    <div>
                        <label for="ownerPhone" class="block text-sm font-medium text-gray-700">Phone <span class="text-red-500">*</span></label>
                        <input type="tel" id="ownerPhone" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" required>
                        <p id="ownerPhoneError" class="text-red-500 text-xs mt-1 hidden">Oops! We need your phone number.</p>
                    </div>
                    <div class="md:col-span-2">
                        <label for="ownerAddress" class="block text-sm font-medium text-gray-700">Address (Longview area) <span class="text-red-500">*</span></label>
                        <input type="text" id="ownerAddress" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" required>
                        <p id="ownerAddressError" class="text-red-500 text-xs mt-1 hidden">Oops! We need your address.</p>
                    </div>
                    <div class="md:col-span-2">
                        <label for="ownerEmail" class="block text-sm font-medium text-gray-700">Email (Optional)</label>
                        <input type="email" id="ownerEmail" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2">
                    </div>
                </div>
            </section>

            <!-- Pet Info -->
            <section class="mb-8">
                <h3 class="text-xl font-semibold text-charcoal mb-3 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-paw-print mr-2 text-teal"><path d="M11 20A7 7 0 0 1 9.8 15.6L1.5 7.3A4.9 4.9 0 0 1 8.5 0A4.9 4.9 0 0 1 15.5 7.3L7.2 15.6A7 7 0 0 1 6 20a7 7 0 0 1 14 0Z"/><path d="M13 5h.01"/><path d="M17 5h.01"/><path d="M19 9h.01"/><path d="M21 13h.01"/></svg>
                    Your Pet's Information
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="petName" class="block text-sm font-medium text-gray-700">Pet's Name <span class="text-red-500">*</span></label>
                        <input type="text" id="petName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" required>
                        <p id="petNameError" class="text-red-500 text-xs mt-1 hidden">Oops! We need your fur baby's name.</p>
                    </div>
                    <div>
                        <label for="petBreed" class="block text-sm font-medium text-gray-700">Breed <span class="text-red-500">*</span></label>
                        <select id="petBreed" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" required>
                            <option value="">Select a breed</option>
                            <!-- Breeds will be populated by JS -->
                        </select>
                        <p id="petBreedError" class="text-red-500 text-xs mt-1 hidden">Oops! Please select a breed.</p>
                    </div>
                    <div>
                        <label for="petWeight" class="block text-sm font-medium text-gray-700">Weight (lbs) <span class="text-red-500">*</span></label>
                        <input type="number" id="petWeight" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" min="1" required>
                        <p id="petWeightError" class="text-red-500 text-xs mt-1 hidden">Oops! We need your pet's weight.</p>
                    </div>
                    <div>
                        <label for="petAge" class="block text-sm font-medium text-gray-700">Age (years) <span class="text-red-500">*</span></label>
                        <input type="number" id="petAge" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" min="0" required>
                        <p id="petAgeError" class="text-red-500 text-xs mt-1 hidden">Oops! We need your pet's age.</p>
                    </div>
                    <div>
                        <label for="petTemperament" class="block text-sm font-medium text-gray-700">Temperament</label>
                        <select id="petTemperament" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2">
                            <option value="Calm">😊 Calm</option>
                            <option value="Playful">🐕 Playful</option>
                            <option value="Anxious">😰 Anxious</option>
                            <option value="Reactive">😠 Reactive</option>
                            <option value="Diva">👑 Diva</option>
                        </select>
                    </div>
                    <div>
                        <label for="petSpecialNeeds" class="block text-sm font-medium text-gray-700">Special Needs (e.g., medical, mobility)</label>
                        <textarea id="petSpecialNeeds" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2"></textarea>
                    </div>
                </div>
            </section>

            <!-- Services -->
            <section class="mb-8">
                <h3 class="text-xl font-semibold text-charcoal mb-3 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cut mr-2 text-teal"><circle cx="7.5" cy="12.5" r="2.5"/><path d="M17.5 12.5h-8.8"/><circle cx="17.5" cy="12.5" r="2.5"/><path d="M10 5L7.5 7.5"/><path d="M14 10l-2.5 2.5"/><path d="M10 20l-2.5-2.5"/><path d="M14 15l-2.5-2.5"/></svg>
                    Select Services
                </h3>
                <div class="space-y-3">
                    <div class="flex items-center">
                        <input type="checkbox" id="serviceBathBrush" value="Bath & Brush" data-base-price="35" data-price-range="35-55" class="h-4 w-4 text-teal focus:ring-teal border-gray-300 rounded mr-2">
                        <label for="serviceBathBrush" class="text-sm font-medium text-gray-700">Bath & Brush <span class="text-gray-500">($35-55)</span></label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="serviceFullGroom" value="Full Groom" data-base-price="55" data-price-range="55-85" class="h-4 w-4 text-teal focus:ring-teal border-gray-300 rounded mr-2">
                        <label for="serviceFullGroom" class="text-sm font-medium text-gray-700">Full Groom <span class="text-gray-500">($55-85)</span></label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="servicePuppyFirst" value="Puppy First" data-base-price="40" data-price-range="40-60" class="h-4 w-4 text-teal focus:ring-teal border-gray-300 rounded mr-2">
                        <label for="servicePuppyFirst" class="text-sm font-medium text-gray-700">Puppy First <span class="text-gray-500">($40-60)</span></label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="serviceDeShedding" value="De-shedding" data-base-price="50" data-price-range="50-75" class="h-4 w-4 text-teal focus:ring-teal border-gray-300 rounded mr-2">
                        <label for="serviceDeShedding" class="text-sm font-medium text-gray-700">De-shedding <span class="text-gray-500">($50-75)</span></label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="serviceNailTrim" value="Nail Trim" data-base-price="15" data-price-range="15-20" class="h-4 w-4 text-teal focus:ring-teal border-gray-300 rounded mr-2">
                        <label for="serviceNailTrim" class="text-sm font-medium text-gray-700">Nail Trim <span class="text-gray-500">($15-20)</span></label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="addonTeethBrushing" value="Teeth Brushing" data-price="10" class="h-4 w-4 text-teal focus:ring-teal border-gray-300 rounded mr-2">
                        <label for="addonTeethBrushing" class="text-sm font-medium text-gray-700">Teeth Brushing <span class="text-gray-500">(+$10)</span></label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="addonFleaTreatment" value="Flea Treatment" data-price="15" class="h-4 w-4 text-teal focus:ring-teal border-gray-300 rounded mr-2">
                        <label for="addonFleaTreatment" class="text-sm font-medium text-gray-700">Flea Treatment <span class="text-gray-500">(+$15)</span></label>
                    </div>
                </div>
            </section>

            <!-- Calendar -->
            <section class="mb-8">
                <h3 class="text-xl font-semibold text-charcoal mb-3 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar mr-2 text-teal"><path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/></svg>
                    Select Date & Time
                </h3>
                <div class="flex items-center justify-between mb-4">
                    <button id="prevWeek" class="bg-gray-200 hover:bg-gray-300 text-charcoal font-bold py-2 px-4 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left"><path d="m15 18-6-6 6-6"/></svg>
                    </button>
                    <span id="currentWeekRange" class="text-lg font-semibold text-charcoal"></span>
                    <button id="nextWeek" class="bg-gray-200 hover:bg-gray-300 text-charcoal font-bold py-2 px-4 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right"><path d="m9 18 6-6-6-6"/></svg>
                    </button>
                </div>
                <div id="calendar" class="grid grid-cols-1 md:grid-cols-7 gap-3">
                    <!-- Calendar days will be populated by JS -->
                </div>
                <p id="calendarError" class="text-red-500 text-xs mt-2 hidden">Oops! Please select a grooming slot.</p>
            </section>

            <!-- Notes -->
            <section class="mb-8">
                <h3 class="text-xl font-semibold text-charcoal mb-3 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil mr-2 text-teal"><path d="M17 3a2.85 2.85 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="M15 5l4 4"/></svg>
                    Additional Notes
                </h3>
                <textarea id="bookingNotes" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" placeholder="Gate codes, pet behavior, parking instructions, specific requests..."></textarea>
            </section>

            <!-- Total and Submit -->
            <section class="flex flex-col md:flex-row justify-between items-center bg-gray-100 p-4 rounded-lg shadow-inner mt-8">
                <div class="mb-4 md:mb-0">
                    <p class="text-lg font-medium text-charcoal">Estimated Total:</p>
                    <p id="totalPrice" class="text-3xl font-bold text-coral">$0.00</p>
                    <p id="discountInfo" class="text-sm text-teal hidden">Includes 15% New Client Discount!</p>
                </div>
                <button id="bookNowButton" class="bg-teal hover:bg-emerald-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-colors duration-200">
                    Book Now!
                </button>
            </section>

            <!-- Booking Confirmation Modal -->
            <div id="confirmationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
                <div class="bg-white p-8 rounded-lg shadow-2xl text-center max-w-sm w-full relative">
                    <button id="closeModal" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                    </button>
                    <p class="paw-stamp text-coral mb-4">🐾</p>
                    <h3 class="text-2xl font-bold text-charcoal mb-4">Booking Confirmed!</h3>
                    <p class="text-gray-700 mb-6">Thank you for choosing April's Furry Tail. We're excited to groom your pet!</p>
                    <button id="newBookingButton" class="bg-coral hover:bg-red-600 text-white font-bold py-2 px-6 rounded-full transition-colors duration-200">
                        Make Another Booking
                    </button>
                </div>
            </div>
        </div>

        <div id="myPets" class="tab-content bg-white p-6 rounded-b-lg shadow-lg hidden">
            <h2 class="text-2xl font-bold text-coral mb-4">My Pets</h2>
            <p class="text-sm text-gray-600 mb-4">Manage your furry friends' profiles and keep track of their important details.</p>

            <button id="addPetButton" class="bg-teal hover:bg-emerald-600 text-white font-bold py-2 px-4 rounded-full mb-6 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-circle mr-2"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>
                Add New Pet
            </button>

            <div id="petList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Pet cards will be dynamically loaded here -->
                <p id="noPetsMessage" class="col-span-full text-center text-gray-500 italic">No pets added yet. Click "Add New Pet" to get started!</p>
            </div>

            <!-- Pet Management Modal -->
            <div id="petModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
                <div class="bg-white p-8 rounded-lg shadow-2xl max-w-lg w-full relative">
                    <button id="closePetModal" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                    </button>
                    <h3 id="petModalTitle" class="text-2xl font-bold text-charcoal mb-4">Add New Pet</h3>
                    <form id="petForm" class="space-y-4">
                        <input type="hidden" id="petId">
                        <div>
                            <label for="modalPetName" class="block text-sm font-medium text-gray-700">Pet's Name <span class="text-red-500">*</span></label>
                            <input type="text" id="modalPetName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" required>
                            <p id="modalPetNameError" class="text-red-500 text-xs mt-1 hidden">Please enter pet's name.</p>
                        </div>
                        <div>
                            <label for="modalPetBreed" class="block text-sm font-medium text-gray-700">Breed <span class="text-red-500">*</span></label>
                            <select id="modalPetBreed" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" required>
                                <option value="">Select a breed</option>
                                <!-- Breeds will be populated by JS -->
                            </select>
                            <p id="modalPetBreedError" class="text-red-500 text-xs mt-1 hidden">Please select a breed.</p>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label for="modalPetWeight" class="block text-sm font-medium text-gray-700">Weight (lbs) <span class="text-red-500">*</span></label>
                                <input type="number" id="modalPetWeight" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" min="1" required>
                                <p id="modalPetWeightError" class="text-red-500 text-xs mt-1 hidden">Please enter pet's weight.</p>
                            </div>
                            <div>
                                <label for="modalPetAge" class="block text-sm font-medium text-gray-700">Age (years) <span class="text-red-500">*</span></label>
                                <input type="number" id="modalPetAge" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2" min="0" required>
                                <p id="modalPetAgeError" class="text-red-500 text-xs mt-1 hidden">Please enter pet's age.</p>
                            </div>
                        </div>
                        <div>
                            <label for="modalPetTemperament" class="block text-sm font-medium text-gray-700">Temperament</label>
                            <select id="modalPetTemperament" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2">
                                <option value="Calm">😊 Calm</option>
                                <option value="Playful">🐕 Playful</option>
                                <option value="Anxious">😰 Anxious</option>
                                <option value="Reactive">😠 Reactive</option>
                                <option value="Diva">👑 Diva</option>
                            </select>
                        </div>
                        <div>
                            <label for="modalPetSpecialNeeds" class="block text-sm font-medium text-gray-700">Special Needs</label>
                            <textarea id="modalPetSpecialNeeds" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2"></textarea>
                        </div>

                        <h4 class="text-lg font-semibold text-charcoal mt-6 mb-3">Vaccination Tracker</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="vaccineRabies" class="block text-sm font-medium text-gray-700">Rabies Expiration</label>
                                <input type="date" id="vaccineRabies" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2">
                            </div>
                            <div>
                                <label for="vaccineDHPP" class="block text-sm font-medium text-gray-700">DHPP Expiration</label>
                                <input type="date" id="vaccineDHPP" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-2">
                            </div>
                        </div>

                        <h4 class="text-lg font-semibold text-charcoal mt-6 mb-3">Grooming History</h4>
                        <div id="groomingHistoryContainer" class="space-y-2">
                            <!-- Grooming history items will be added here -->
                        </div>
                        <button type="button" id="addGroomingEntry" class="text-sm text-teal hover:text-emerald-600 flex items-center mt-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus mr-1"><path d="M12 5v14"/><path d="M5 12h14"/></svg>
                            Add Grooming Entry
                        </button>


                        <div class="flex justify-end space-x-2 mt-6">
                            <button type="button" id="deletePetButton" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full transition-colors duration-200 hidden">Delete Pet</button>
                            <button type="submit" class="bg-coral hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full transition-colors duration-200">Save Pet</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div id="petGallery" class="tab-content bg-white p-6 rounded-b-lg shadow-lg hidden">
            <h2 class="text-2xl font-bold text-coral mb-4">Pet Gallery</h2>
            <p class="text-sm text-gray-600 mb-4">See some amazing transformations! Your pet could be featured here next.</p>

            <div class="masonry-grid">
                <!-- Gallery items - placeholders -->
                <div class="masonry-item relative group overflow-hidden rounded-lg shadow-md">
                    <img src="https://via.placeholder.com/300x400/4ecdc4/ffffff?text=Before" alt="Before Grooming" class="w-full h-auto object-cover">
                    <img src="https://via.placeholder.com/300x400/e8736c/ffffff?text=After" alt="After Grooming" class="w-full h-full absolute top-0 left-0 object-cover opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <span class="text-white text-lg font-semibold text-center">Before & After!</span>
                    </div>
                </div>
                <div class="masonry-item relative group overflow-hidden rounded-lg shadow-md">
                    <img src="https://via.placeholder.com/300x300/4ecdc4/ffffff?text=Before" alt="Before Grooming" class="w-full h-auto object-cover">
                    <img src="https://via.placeholder.com/300x300/e8736c/ffffff?text=After" alt="After Grooming" class="w-full h-full absolute top-0 left-0 object-cover opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <span class="text-white text-lg font-semibold text-center">Your pet could be featured!</span>
                    </div>
                </div>
                <div class="masonry-item relative group overflow-hidden rounded-lg shadow-md">
                    <img src="https://via.placeholder.com/300x500/4ecdc4/ffffff?text=Before" alt="Before Grooming" class="w-full h-auto object-cover">
                    <img src="https://via.placeholder.com/300x500/e8736c/ffffff?text=After" alt="After Grooming" class="w-full h-full absolute top-0 left-0 object-cover opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <span class="text-white text-lg font-semibold text-center">Click to see transformation!</span>
                    </div>
                </div>
                <div class="masonry-item relative group overflow-hidden rounded-lg shadow-md">
                    <img src="https://via.placeholder.com/300x350/4ecdc4/ffffff?text=Before" alt="Before Grooming" class="w-full h-auto object-cover">
                    <img src="https://via.placeholder.com/300x350/e8736c/ffffff?text=After" alt="After Grooming" class="w-full h-full absolute top-0 left-0 object-cover opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <span class="text-white text-lg font-semibold text-center">So fluffy!</span>
                    </div>
                </div>
                <div class="masonry-item relative group overflow-hidden rounded-lg shadow-md">
                    <img src="https://via.placeholder.com/300x450/4ecdc4/ffffff?text=Before" alt="Before Grooming" class="w-full h-auto object-cover">
                    <img src="https://via.placeholder.com/300x450/e8736c/ffffff?text=After" alt="After Grooming" class="w-full h-full absolute top-0 left-0 object-cover opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <span class="text-white text-lg font-semibold text-center">Ready for cuddles!</span>
                    </div>
                </div>
                <div class="masonry-item relative group overflow-hidden rounded-lg shadow-md">
                    <img src="https://via.placeholder.com/300x300/4ecdc4/ffffff?text=Before" alt="Before Grooming" class="w-full h-auto object-cover">
                    <img src="https://via.placeholder.com/300x300/e8736c/ffffff?text=After" alt="After Grooming" class="w-full h-full absolute top-0 left-0 object-cover opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <span class="text-white text-lg font-semibold text-center">Fresh and clean!</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-charcoal text-white p-6 text-center text-sm mt-8 shadow-inner">
        <p class="mb-2">&copy; 2023 April's Furry Tail | Longview, TX</p>
        <p class="mb-2">Phone: (903) 215-2541 | Email: <a href="mailto:aprilsfurrytail@gmail.com" class="text-teal hover:underline">aprilsfurrytail@gmail.com</a></p>
        <p class="text-gray-400">Built for April's Furry Tail</p>
    </footer>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // --- Tab Switching Logic ---
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active-tab'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));

                button.classList.add('active-tab');
                document.getElementById(button.dataset.tab).classList.remove('hidden');

                // Re-create Lucide icons for newly visible content if needed (not strictly necessary with current structure)
                lucide.createIcons();
            });
        });

        // --- Global Data & State ---
        const NEW_CLIENT_DISCOUNT_PERCENTAGE = 0.15; // 15%
        let pets = JSON.parse(localStorage.getItem('pets')) || [];
        let selectedBookingDate = null;
        let selectedBookingTime = null;
        let currentCalendarWeek = 0; // 0 for current week, 1 for next week, etc.

        // --- Pet Breeds (simplified for example, would be a much larger list) ---
        const petBreeds = [
            "Mixed Breed (Dog)", "Labrador Retriever", "German Shepherd", "Golden Retriever", "French Bulldog", "Bulldog", "Poodle", "Beagle", "Rottweiler", "German Shorthaired Pointer", "Dachshund", "Pembroke Welsh Corgi", "Australian Shepherd", "Yorkshire Terrier", "Boxer", "Siberian Husky", "Great Dane", "Shih Tzu", "Doberman Pinscher", "Bernese Mountain Dog", "Vizsla", "Havanese", "Cavalier King Charles Spaniel", "Pomeranian", "Shetland Sheepdog", "Brittany", "Boston Terrier", "Mastiff", "Chow Chow", "Akita", "Basset Hound", "Bichon Frise", "Border Collie", "Greyhound", "Jack Russell Terrier", "Maltese", "Miniature Schnauzer", "Pug", "Saint Bernard", "Shiba Inu", "Staffordshire Bull Terrier", "West Highland White Terrier", "Cane Corso", "Australian Cattle Dog", "Belgian Malinois", "Weimaraner", "Newfoundland", "Chihuahua", "Border Terrier", "Cairn Terrier", "Coton de Tulear", "English Springer Spaniel", "Soft Coated Wheaten Terrier", "Mixed Breed (Cat)", "Domestic Shorthair", "Domestic Longhair", "Maine Coon", "Ragdoll", "Siamese", "Persian", "Bengal", "Russian Blue", "British Shorthair", "Abyssinian", "Birman", "Sphynx", "Oriental Shorthair", "Devon Rex", "Cornish Rex", "American Shorthair", "Scottish Fold"
        ].sort(); // Sort alphabetically

        function populateBreedDropdowns() {
            const dropdowns = [
                document.getElementById('petBreed'),
                document.getElementById('modalPetBreed')
            ];
            dropdowns.forEach(dropdown => {
                if (dropdown) {
                    const currentSelected = dropdown.value; // Preserve selection if editing
                    dropdown.innerHTML = '<option value="">Select a breed</option>';
                    petBreeds.forEach(breed => {
                        const option = document.createElement('option');
                        option.value = breed;
                        option.textContent = breed;
                        if (breed === currentSelected) {
                            option.selected = true;
                        }
                        dropdown.appendChild(option);
                    });
                }
            });
        }
        populateBreedDropdowns();

        // --- Book Your Grooming Tab Logic ---
        const ownerNameInput = document.getElementById('ownerName');
        const ownerPhoneInput = document.getElementById('ownerPhone');
        const ownerAddressInput = document.getElementById('ownerAddress');
        const petNameInput = document.getElementById('petName');
        const petBreedSelect = document.getElementById('petBreed');
        const petWeightInput = document.getElementById('petWeight');
        const petAgeInput = document.getElementById('petAge');

        const serviceCheckboxes = document.querySelectorAll('#bookGrooming input[type="checkbox"][id^="service"]');
        const addonCheckboxes = document.querySelectorAll('#bookGrooming input[type="checkbox"][id^="addon"]');
        const totalPriceDisplay = document.getElementById('totalPrice');
        const discountInfo = document.getElementById('discountInfo');
        const bookNowButton = document.getElementById('bookNowButton');
        const confirmationModal = document.getElementById('confirmationModal');
        const closeModalButton = document.getElementById('closeModal');
        const newBookingButton = document.getElementById('newBookingButton');

        function calculateTotal() {
            let total = 0;
            let hasService = false;

            serviceCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    hasService = true;
                    // For services, we take the base price for calculation
                    total += parseFloat(checkbox.dataset.basePrice);
                }
            });

            addonCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    total += parseFloat(checkbox.dataset.price);
                }
            });

            // Apply new client discount if it's the first booking (simplified: always apply for now)
            // In a real app, this would check localStorage for previous bookings
            total *= (1 - NEW_CLIENT_DISCOUNT_PERCENTAGE);
            discountInfo.classList.remove('hidden');


            totalPriceDisplay.textContent = `$${total.toFixed(2)}`;
            return total;
        }

        [...serviceCheckboxes, ...addonCheckboxes].forEach(checkbox => {
            checkbox.addEventListener('change', calculateTotal);
        });

        // Calendar Logic
        const calendarElement = document.getElementById('calendar');
        const currentWeekRangeElement = document.getElementById('currentWeekRange');
        const prevWeekButton = document.getElementById('prevWeek');
        const nextWeekButton = document.getElementById('nextWeek');

        function formatDate(date) {
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        function renderCalendar() {
            calendarElement.innerHTML = ''; // Clear previous calendar
            const today = new Date();
            const startOfWeek = new Date(today);
            startOfWeek.setDate(today.getDate() - today.getDay() + (currentCalendarWeek * 7)); // Start of current/next/prev week

            const weekdays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const weekDates = [];

            // Populate weekDates array
            for (let i = 0; i < 7; i++) {
                const date = new Date(startOfWeek);
                date.setDate(startOfWeek.getDate() + i);
                weekDates.push(date);
            }

            currentWeekRangeElement.textContent = `${formatDate(weekDates[0])} - ${formatDate(weekDates[6])}`;

            weekDates.forEach((date, index) => {
                const dayDiv = document.createElement('div');
                dayDiv.classList.add('bg-gray-50', 'p-3', 'rounded-lg', 'text-center', 'shadow-sm', 'relative');

                const isSunday = date.getDay() === 0; // Sunday
                const isFriday = date.getDay() === 5; // Friday
                const isPastDate = date < new Date(today.getFullYear(), today.getMonth(), today.getDate()); // Ignore time for past date check

                let status = '';
                let timeSlots = [];

                if (isSunday || isPastDate) {
                    status = 'Closed';
                    dayDiv.classList.add('bg-gray-200', 'text-gray-500', 'line-through');
                } else if (isFriday) {
                    status = 'Limited';
                    dayDiv.classList.add('bg-orange-100', 'text-orange-700');
                    timeSlots = ['AM']; // Only AM for limited
                } else {
                    status = 'Available';
                    dayDiv.classList.add('bg-white');
                    timeSlots = ['AM', 'PM'];
                }

                dayDiv.innerHTML = `
                    <p class="font-bold text-charcoal">${weekdays[index]}</p>
                    <p class="text-sm text-gray-600">${formatDate(date)}</p>
                    <div class="mt-2 text-xs font-semibold">
                        ${isPastDate || isSunday ? `<span class="text-red-500">${status}</span>` : timeSlots.map(slot => `
                            <button
                                class="time-slot-button block w-full mt-1 py-1 rounded-md
                                ${selectedBookingDate === date.toDateString() && selectedBookingTime === slot
                                    ? 'bg-teal text-white'
                                    : 'bg-gray-100 hover:bg-gray-200 text-charcoal'
                                }
                                "
                                data-date="${date.toDateString()}" data-time="${slot}"
                                ${isFriday && slot === 'PM' ? 'disabled title="PM slots are limited on Fridays"' : ''}
                            >
                                ${slot} ${isFriday && slot === 'PM' ? '(Limited)' : ''}
                            </button>
                        `).join('')}
                    </div>
                `;

                calendarElement.appendChild(dayDiv);
            });

            document.querySelectorAll('.time-slot-button').forEach(button => {
                button.addEventListener('click', (event) => {
                    document.querySelectorAll('.time-slot-button').forEach(btn => {
                        btn.classList.remove('bg-teal', 'text-white');
                        btn.classList.add('bg-gray-100', 'hover:bg-gray-200', 'text-charcoal');
                    });
                    event.target.classList.add('bg-teal', 'text-white');
                    event.target.classList.remove('bg-gray-100', 'hover:bg-gray-200', 'text-charcoal');
                    selectedBookingDate = event.target.dataset.date;
                    selectedBookingTime = event.target.dataset.time;
                    document.getElementById('calendarError').classList.add('hidden');
                });
            });
        }

        prevWeekButton.addEventListener('click', () => {
            currentCalendarWeek--;
            renderCalendar();
        });

        nextWeekButton.addEventListener('click', () => {
            currentCalendarWeek++;
            renderCalendar();
        });

        renderCalendar();
        calculateTotal(); // Initial total calculation

        // Form Validation & Submission
        bookNowButton.addEventListener('click', () => {
            let isValid = true;

            // Clear previous errors
            document.querySelectorAll('.text-red-500.text-xs').forEach(el => el.classList.add('hidden'));

            if (!ownerNameInput.value) { isValid = false; document.getElementById('ownerNameError').classList.remove('hidden'); }
            if (!ownerPhoneInput.value) { isValid = false; document.getElementById('ownerPhoneError').classList.remove('hidden'); }
            if (!ownerAddressInput.value) { isValid = false; document.getElementById('ownerAddressError').classList.remove('hidden'); }
            if (!petNameInput.value) { isValid = false; document.getElementById('petNameError').classList.remove('hidden'); }
            if (!petBreedSelect.value) { isValid = false; document.getElementById('petBreedError').classList.remove('hidden'); }
            if (!petWeightInput.value || parseFloat(petWeightInput.value) <= 0) { isValid = false; document.getElementById('petWeightError').classList.remove('hidden'); }
            if (!petAgeInput.value || parseInt(petAgeInput.value) < 0) { isValid = false; document.getElementById('petAgeError').classList.remove('hidden'); }

            const anyServiceSelected = [...serviceCheckboxes].some(cb => cb.checked);
            if (!anyServiceSelected) {
                isValid = false;
                alert("Please select at least one grooming service.");
            }

            if (!selectedBookingDate || !selectedBookingTime) {
                isValid = false;
                document.getElementById('calendarError').classList.remove('hidden');
            }


            if (isValid) {
                // Here you would typically send data to a backend
                // For this exercise, we just show a confirmation modal
                confirmationModal.classList.remove('hidden');
                document.body.classList.add('overflow-hidden'); // Prevent scrolling
            } else {
                alert("Please fill in all required fields and select a service/time slot.");
            }
        });

        closeModalButton.addEventListener('click', () => {
            confirmationModal.classList.add('hidden');
            document.body.classList.remove('overflow-hidden');
        });

        newBookingButton.addEventListener('click', () => {
            confirmationModal.classList.add('hidden');
            document.body.classList.remove('overflow-hidden');
            // Reset form for new booking
            document.getElementById('bookGrooming').reset(); // This won't reset custom elements
            ownerNameInput.value = '';
            ownerPhoneInput.value = '';
            ownerAddressInput.value = '';
            document.getElementById('ownerEmail').value = '';
            petNameInput.value = '';
            petBreedSelect.value = '';
            petWeightInput.value = '';
            petAgeInput.value = '';
            document.getElementById('petTemperament').value = 'Calm';
            document.getElementById('petSpecialNeeds').value = '';
            serviceCheckboxes.forEach(cb => cb.checked = false);
            addonCheckboxes.forEach(cb => cb.checked = false);
            selectedBookingDate = null;
            selectedBookingTime = null;
            renderCalendar();
            calculateTotal();
        });


        // --- My Pets Tab Logic ---
        const petListElement = document.getElementById('petList');
        const addPetButton = document.getElementById('addPetButton');
        const petModal = document.getElementById('petModal');
        const closePetModalButton = document.getElementById('closePetModal');
        const petModalTitle = document.getElementById('petModalTitle');
        const petForm = document.getElementById('petForm');
        const modalPetId = document.getElementById('petId');
        const modalPetName = document.getElementById('modalPetName');
        const modalPetBreed = document.getElementById('modalPetBreed');
        const modalPetWeight = document.getElementById('modalPetWeight');
        const modalPetAge = document.getElementById('modalPetAge');
        const modalPetTemperament = document.getElementById('modalPetTemperament');
        const modalPetSpecialNeeds = document.getElementById('modalPetSpecialNeeds');
        const vaccineRabiesInput = document.getElementById('vaccineRabies');
        const vaccineDHPPInput = document.getElementById('vaccineDHPP');
        const groomingHistoryContainer = document.getElementById('groomingHistoryContainer');
        const addGroomingEntryButton = document.getElementById('addGroomingEntry');
        const deletePetButton = document.getElementById('deletePetButton');
        const noPetsMessage = document.getElementById('noPetsMessage');

        function generateUniqueId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function savePets() {
            localStorage.setItem('pets', JSON.stringify(pets));
            renderPetList();
        }

        function getBreedCategory(breed) {
            const dogBreeds = petBreeds.filter(b => b.includes('(Dog)') || !b.includes('(Cat)')); // Simple heuristic
            return dogBreeds.includes(breed) ? 'dog' : 'cat';
        }

        function renderVaccineBadge(dateString) {
            if (!dateString) return `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">No Date</span>`;

            const expiryDate = new Date(dateString);
            const today = new Date();
            const threeMonthsFromNow = new Date();
            threeMonthsFromNow.setMonth(today.getMonth() + 3);

            let colorClass = 'bg-red-100 text-red-800';
            let status = 'Expired';

            if (expiryDate > today) {
                if (expiryDate > threeMonthsFromNow) {
                    colorClass = 'bg-green-100 text-green-800';
                    status = 'Current';
                } else {
                    colorClass = 'bg-yellow-100 text-yellow-800';
                    status = 'Expires Soon';
                }
            }
            return `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${colorClass}">${status}</span>`;
        }

        function renderGroomingHistory(history) {
            groomingHistoryContainer.innerHTML = '';
            if (!history || history.length === 0) {
                groomingHistoryContainer.innerHTML = '<p class="text-gray-500 text-sm italic">No grooming history yet.</p>';
                return;
            }
            history.forEach((entry, index) => {
                const entryDiv = document.createElement('div');
                entryDiv.classList.add('flex', 'items-center', 'space-x-2', 'bg-gray-50', 'p-2', 'rounded-md');
                entryDiv.innerHTML = `
                    <input type="date" value="${entry.date}" class="w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-1" onchange="updateGroomingEntry('${modalPetId.value}', ${index}, 'date', this.value)">
                    <textarea rows="1" class="w-full rounded-md border-gray-300 shadow-sm focus:border-teal focus:ring-teal sm:text-sm p-1" placeholder="Service notes" onchange="updateGroomingEntry('${modalPetId.value}', ${index}, 'notes', this.value)">${entry.notes}</textarea>
                    <button type="button" class="text-red-500 hover:text-red-700" onclick="removeGroomingEntry('${modalPetId.value}', ${index})">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x-circle"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>
                    </button>
                `;
                groomingHistoryContainer.appendChild(entryDiv);
            });
        }

        window.updateGroomingEntry = function(petId, index, field, value) {
            const petIndex = pets.findIndex(p => p.id === petId);
            if (petIndex !== -1) {
                pets[petIndex].groomingHistory[index][field] = value;
                savePets();
            }
        };

        window.removeGroomingEntry = function(petId, index) {
            const petIndex = pets.findIndex(p => p.id === petId);
            if (petIndex !== -1) {
                pets[petIndex].groomingHistory.splice(index, 1);
                savePets();
                renderGroomingHistory(pets[petIndex].groomingHistory); // Re-render in modal
            }
        };

        addGroomingEntryButton.addEventListener('click', () => {
            const petId = modalPetId.value;
            const petIndex = pets.findIndex(p => p.id === petId);
            if (petIndex !== -1) {
                pets[petIndex].groomingHistory.push({ date: new Date().toISOString().split('T')[0], notes: '' });
                savePets();
                renderGroomingHistory(pets[petIndex].groomingHistory); // Re-render in modal
            }
        });


        function renderPetList() {
            petListElement.innerHTML = '';
            if (pets.length === 0) {
                noPetsMessage.classList.remove('hidden');
            } else {
                noPetsMessage.classList.add('hidden');
                pets.forEach(pet => {
                    const petCard = document.createElement('div');
                    petCard.classList.add('bg-gray-50', 'p-4', 'rounded-lg', 'shadow-md', 'flex', 'items-start', 'space-x-4');
                    petCard.innerHTML = `
                        <div class="silhouette ${getBreedCategory(pet.breed)} flex-shrink-0"></div>
                        <div class="flex-grow">
                            <h4 class="text-xl font-bold text-charcoal">${pet.name}</h4>
                            <p class="text-sm text-gray-600">${pet.breed}</p>
                            <p class="text-sm text-gray-600">Weight: ${pet.weight} lbs | Age: ${pet.age} years</p>
                            <p class="text-sm text-gray-600">Temperament: ${pet.temperament}</p>
                            ${pet.specialNeeds ? `<p class="text-xs text-gray-500 mt-1">Needs: ${pet.specialNeeds}</p>` : ''}

                            <div class="mt-3 flex flex-wrap gap-2 text-xs">
                                <span class="font-medium text-gray-700">Rabies:</span> ${renderVaccineBadge(pet.vaccines.rabies)}
                                <span class="font-medium text-gray-700 ml-2">DHPP:</span> ${renderVaccineBadge(pet.vaccines.dhpp)}
                            </div>
                            <div class="mt-3">
                                <p class="font-medium text-gray-700">Grooming History:</p>
                                ${pet.groomingHistory && pet.groomingHistory.length > 0 ?
                                    `<ul class="list-disc list-inside text-xs text-gray-600">
                                        ${pet.groomingHistory.map(entry => `<li>${entry.date}: ${entry.notes || 'No notes'}</li>`).join('')}
                                    </ul>` : `<p class="text-xs text-gray-500 italic">No history.</p>`
                                }
                            </div>
                            <button class="edit-pet-button bg-teal hover:bg-emerald-600 text-white text-xs py-1 px-3 rounded-full mt-3 transition-colors duration-200" data-id="${pet.id}">
                                Edit Pet
                            </button>
                        </div>
                    `;
                    petListElement.appendChild(petCard);
                });

                document.querySelectorAll('.edit-pet-button').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const petId = event.target.dataset.id;
                        editPet(petId);
                    });
                });
            }
        }

        function openPetModal(pet = null) {
            petForm.reset();
            groomingHistoryContainer.innerHTML = '';
            deletePetButton.classList.add('hidden');
            modalPetId.value = '';

            if (pet) {
                petModalTitle.textContent = 'Edit Pet';
                modalPetId.value = pet.id;
                modalPetName.value = pet.name;
                modalPetBreed.value = pet.breed;
                modalPetWeight.value = pet.weight;
                modalPetAge.value = pet.age;
                modalPetTemperament.value = pet.temperament || 'Calm';
                modalPetSpecialNeeds.value = pet.specialNeeds || '';
                vaccineRabiesInput.value = pet.vaccines?.rabies || '';
                vaccineDHPPInput.value = pet.vaccines?.dhpp || '';
                renderGroomingHistory(pet.groomingHistory);
                deletePetButton.classList.remove('hidden');
            } else {
                petModalTitle.textContent = 'Add New Pet';
                renderGroomingHistory([]); // Clear history for new pet
            }
            petModal.classList.remove('hidden');
            document.body.classList.add('overflow-hidden');
            populateBreedDropdowns(); // Ensure breeds are loaded each time
        }

        function closePetModal() {
            petModal.classList.add('hidden');
            document.body.classList.remove('overflow-hidden');
            document.querySelectorAll('.text-red-500.text-xs').forEach(el => el.classList.add('hidden')); // Clear errors
        }

        addPetButton.addEventListener('click', () => openPetModal());
        closePetModalButton.addEventListener('click', closePetModal);

        function editPet(id) {
            const pet = pets.find(p => p.id === id);
            if (pet) {
                openPetModal(pet);
            }
        }

        deletePetButton.addEventListener('click', () => {
            if (confirm("Are you sure you want to delete this pet?")) {
                const idToDelete = modalPetId.value;
                pets = pets.filter(p => p.id !== idToDelete);
                savePets();
                closePetModal();
            }
        });

        petForm.addEventListener('submit', (event) => {
            event.preventDefault();
            let isValid = true;
            document.querySelectorAll('#petModal .text-red-500.text-xs').forEach(el => el.classList.add('hidden'));

            if (!modalPetName.value) { isValid = false; document.getElementById('modalPetNameError').classList.remove('hidden'); }
            if (!modalPetBreed.value) { isValid = false; document.getElementById('modalPetBreedError').classList.remove('hidden'); }
            if (!modalPetWeight.value || parseFloat(modalPetWeight.value) <= 0) { isValid = false; document.getElementById('modalPetWeightError').classList.remove('hidden'); }
            if (!modalPetAge.value || parseInt(modalPetAge.value) < 0) { isValid = false; document.getElementById('modalPetAgeError').classList.remove('hidden'); }

            if (!isValid) return;

            const petData = {
                id: modalPetId.value || generateUniqueId(),
                name: modalPetName.value,
                breed: modalPetBreed.value,
                weight: parseFloat(modalPetWeight.value),
                age: parseInt(modalPetAge.value),
                temperament: modalPetTemperament.value,
                specialNeeds: modalPetSpecialNeeds.value,
                vaccines: {
                    rabies: vaccineRabiesInput.value,
                    dhpp: vaccineDHPPInput.value
                },
                groomingHistory: [] // Initialize, will be updated if editing
            };

            const existingIndex = pets.findIndex(p => p.id === petData.id);
            if (existingIndex !== -1) {
                // Keep existing grooming history when editing
                petData.groomingHistory = pets[existingIndex].groomingHistory;
                pets[existingIndex] = petData;
            } else {
                pets.push(petData);
            }
            savePets();
            closePetModal();
        });

        renderPetList(); // Initial render of pet list

        // --- Lucide Icons initialization for dynamic content (though not strictly needed if only on load) ---
        // New icons in modals/dynamically added content might need re-initialization if they aren't parsed initially
        // window.addEventListener('load', () => {
        //     lucide.createIcons();
        // });
    </script>
<script>// Anti-scrape protection — injected into all tool pages
(function(){
  // Disable right-click context menu

  
  
  // Disable text selection on body (forms still selectable)
  
  
  // Re-enable for inputs/textareas
  document.querySelectorAll('input,textarea,select').forEach(function(el){
    el.style.userSelect = 'auto'; el.style.webkitUserSelect = 'auto';
  });
  
  // Disable drag
  document.addEventListener('dragstart', function(e){ e.preventDefault(); });
  
  // Disable print
  var style = document.createElement('style');
  style.textContent = '@media print { body { display: none !important; } }';
  document.head.appendChild(style);
  
  // Add invisible watermark
  var wm = document.createElement('div');
  wm.style.cssText = 'position:fixed;bottom:0;right:0;opacity:0.03;font-size:10px;pointer-events:none;z-index:99999;color:#000;';
  wm.textContent = 'Licensed demo — bennycutools.com — ' + new Date().toISOString().slice(0,10);
  document.body.appendChild(wm);
  
  // Detect devtools (basic)
  var threshold = 160;
  setInterval(function(){
    if (window.outerWidth - window.innerWidth > threshold || window.outerHeight - window.innerHeight > threshold) {
      document.body.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100vh;font-family:sans-serif;"><h1>This demo is proprietary. Please contact ben@bennycutools.com for licensing.</h1></div>';
    }
  }, 1000);
})();
</script>

<!-- BennyCuTools Purchase CTA — injected by inject-cta.py -->
<style>
#bct-cta-bar {
  position: fixed;
  bottom: 48px;
  left: 0;
  right: 0;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  border-top: 2px solid #6366f1;
  padding: 10px 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  z-index: 99998;
  flex-wrap: wrap;
  box-shadow: 0 -4px 20px rgba(0,0,0,0.3);
}
#bct-cta-bar .bct-cta-text {
  color: #e4e4e7;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 14px;
  font-weight: 500;
}
#bct-cta-bar .bct-cta-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 20px;
  background: #6366f1;
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 14px;
  font-weight: 600;
  border: none;
  border-radius: 6px;
  text-decoration: none;
  cursor: pointer;
  transition: background 0.2s, transform 0.1s;
}
#bct-cta-bar .bct-cta-btn:hover {
  background: #4f46e5;
  transform: translateY(-1px);
}
#bct-cta-bar .bct-cta-btn-secondary {
  background: transparent;
  border: 1px solid #6366f1;
  color: #a5b4fc;
}
#bct-cta-bar .bct-cta-btn-secondary:hover {
  background: rgba(99,102,241,0.15);
}
@media (max-width: 600px) {
  #bct-cta-bar {
    flex-direction: column;
    gap: 8px;
    padding: 8px 12px;
    bottom: 44px;
  }
  #bct-cta-bar .bct-cta-text { font-size: 12px; }
  #bct-cta-bar .bct-cta-btn { font-size: 13px; padding: 7px 16px; width: 100%; justify-content: center; }
}
</style>
<div id="bct-cta-bar" role="banner" aria-label="Purchase this tool">
  <span class="bct-cta-text">Like this tool? Make it yours.</span>
  <a class="bct-cta-btn" id="bct-buy-btn" href="https://bennycutools.com/buy.html">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
    Get It — $200 One-Time
  </a>
  <a class="bct-cta-btn bct-cta-btn-secondary" href="mailto:cuuper225@gmail.com?subject=Question%20about%20my%20custom%20tool">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
    Questions? Email Ben
  </a>
</div>
<script>
// Auto-fill the buy link with the current tool's page name
(function(){
  try {
    var pg = location.pathname.replace(/.*\//, '').replace('.html','');
    var buyBtn = document.getElementById('bct-buy-btn');
    if (buyBtn && pg) {
      buyBtn.href = 'https://bennycutools.com/buy.html?tool=' + encodeURIComponent(pg);
    }
  } catch(e){}
})();
</script>
<!-- End BennyCuTools Purchase CTA -->

</body>
</html>
