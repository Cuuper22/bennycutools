<!DOCTYPE html>
<html lang="en">
<head>
<meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CleaningPro - Business Management</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #10b981;
            --accent: #3b82f6;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --shadow: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: var(--card);
            border-right: 1px solid var(--border);
            padding: 1.5rem 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
            z-index: 100;
        }

        .logo {
            padding: 0 1.5rem 1.5rem;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1rem;
        }

        .logo h1 {
            color: var(--primary);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .company-info {
            padding: 0 1.5rem;
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
        }

        .company-name {
            font-weight: 600;
            color: var(--text);
            margin-bottom: 0.25rem;
        }

        .company-tagline {
            color: var(--text-light);
            font-size: 0.8rem;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin: 0.25rem 0.75rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-light);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.2s;
            cursor: pointer;
            font-weight: 500;
        }

        .nav-link:hover {
            background: var(--bg);
            color: var(--primary);
        }

        .nav-link.active {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
        }

        .nav-icon {
            font-size: 1.25rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 260px;
            padding: 2rem;
        }

        .page-header {
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 2rem;
            color: var(--text);
            margin-bottom: 0.5rem;
        }

        .page-subtitle {
            color: var(--text-light);
        }

        /* Dashboard Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--card);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .stat-card.success {
            border-left-color: var(--success);
        }

        .stat-card.warning {
            border-left-color: var(--warning);
        }

        .stat-card.info {
            border-left-color: var(--accent);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.875rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 0.25rem;
        }

        .stat-change {
            font-size: 0.875rem;
            color: var(--success);
        }

        /* Cards */
        .card {
            background: var(--card);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text);
        }

        /* Buttons */
        .btn {
            padding: 0.625rem 1.25rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .btn-secondary {
            background: var(--bg);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.8125rem;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--card);
        }

        thead {
            background: var(--bg);
        }

        th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--text);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 2px solid var(--border);
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            color: var(--text);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background: var(--bg);
        }

        /* Forms */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text);
            font-size: 0.875rem;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.875rem;
            transition: border-color 0.2s;
            background: var(--card);
            color: var(--text);
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Schedule Grid */
        .schedule-grid {
            display: grid;
            grid-template-columns: 100px repeat(7, 1fr);
            gap: 0;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .schedule-header, .schedule-time, .schedule-cell {
            padding: 1rem;
            border: 1px solid var(--border);
            min-height: 80px;
        }

        .schedule-header {
            background: var(--bg);
            font-weight: 600;
            text-align: center;
            padding: 1rem 0.5rem;
        }

        .schedule-time {
            background: var(--bg);
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
        }

        .schedule-cell {
            background: var(--card);
            cursor: pointer;
            transition: background 0.2s;
            position: relative;
        }

        .schedule-cell:hover {
            background: #f1f5f9;
        }

        .schedule-job {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 0.5rem;
            border-radius: 6px;
            font-size: 0.75rem;
            margin-bottom: 0.25rem;
            cursor: move;
            transition: transform 0.2s;
        }

        .schedule-job:hover {
            transform: scale(1.02);
        }

        .schedule-job-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .schedule-job-crew {
            opacity: 0.9;
            font-size: 0.7rem;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .badge-success {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-danger {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge-info {
            background: #dbeafe;
            color: #1e40af;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card);
            border-radius: 12px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            transition: background 0.2s;
        }

        .modal-close:hover {
            background: var(--bg);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Checklist */
        .checklist-item {
            display: flex;
            align-items: flex-start;
            padding: 1rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 0.75rem;
            transition: background 0.2s;
        }

        .checklist-item:hover {
            background: var(--bg);
        }

        .checklist-checkbox {
            width: 20px;
            height: 20px;
            margin-right: 1rem;
            cursor: pointer;
        }

        .checklist-content {
            flex: 1;
        }

        .checklist-title {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .checklist-notes {
            font-size: 0.875rem;
            color: var(--text-light);
        }

        /* Invoice */
        .invoice {
            background: white;
            max-width: 800px;
            margin: 0 auto;
            padding: 3rem;
        }

        .invoice-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid var(--border);
        }

        .invoice-logo {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .invoice-details {
            text-align: right;
        }

        .invoice-number {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .invoice-section {
            margin-bottom: 2rem;
        }

        .invoice-section-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text);
        }

        .invoice-table {
            width: 100%;
            margin: 2rem 0;
        }

        .invoice-table th {
            background: var(--bg);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }

        .invoice-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .invoice-total {
            text-align: right;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 2px solid var(--text);
        }

        .invoice-total-label {
            font-size: 1.25rem;
            font-weight: 600;
            margin-right: 2rem;
        }

        .invoice-total-amount {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* Supply Tracker */
        .supply-card {
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: box-shadow 0.2s;
        }

        .supply-card:hover {
            box-shadow: var(--shadow);
        }

        .supply-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .supply-name {
            font-weight: 600;
            font-size: 1rem;
        }

        .supply-level {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .supply-bar {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            flex: 1;
        }

        .supply-bar-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s;
        }

        .supply-bar-fill.low {
            background: var(--danger);
        }

        .supply-bar-fill.medium {
            background: var(--warning);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .schedule-grid {
                overflow-x: auto;
            }

            .page-title {
                font-size: 1.5rem;
            }

            .invoice {
                padding: 1.5rem;
            }
        }

        @media print {
            .sidebar, .btn, .card-header .btn, .modal {
                display: none !important;
            }

            .main-content {
                margin-left: 0;
            }

            .card {
                box-shadow: none;
                border: 1px solid var(--border);
            }
        }

        /* Hide inactive pages */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Loading state */
        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--text-light);
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }
    </style>

    <style>
    /* Kimi UI/UX Improvements */
    .fade-in-up { animation: fadeInUp 0.4s ease-out forwards; }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    .radio-option, [class*="option"], [class*="choice"] { 
        min-height: 52px; transition: all 0.15s ease !important; 
    }
    .radio-option:active, [class*="option"]:active { transform: scale(0.98); }
    .btn-primary:active, [class*="btn"]:active { transform: translateY(1px); }
    /* Better progress bar */
    [class*="progress"] { height: 6px !important; border-radius: 3px; }
    </style>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <h1>
                    <div class="logo-icon">🧹</div>
                    <span id="app-title">CleaningPro</span>
                </h1>
            </div>
            
            <div class="company-info">
                <div class="company-name" id="company-name">Your Business Name</div>
                <div class="company-tagline" id="company-tagline">Professional Cleaning Services</div>
            </div>

            <ul class="nav-menu">
                <li class="nav-item">
                    <a class="nav-link active" data-page="dashboard">
                        <span class="nav-icon">📊</span>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-page="scheduler">
                        <span class="nav-icon">📅</span>
                        <span>Job Scheduler</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-page="buildings">
                        <span class="nav-icon">🏢</span>
                        <span>Buildings</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-page="crews">
                        <span class="nav-icon">👥</span>
                        <span>Crew Management</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-page="quality">
                        <span class="nav-icon">✅</span>
                        <span>Quality Checks</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-page="invoices">
                        <span class="nav-icon">💰</span>
                        <span>Invoices</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-page="supplies">
                        <span class="nav-icon">🧴</span>
                        <span>Supply Tracker</span>
                    </a>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page active">
                <div class="page-header">
                    <h1 class="page-title">Dashboard</h1>
                    <p class="page-subtitle" id="dashboard-date">Today's Overview</p>
                </div>

                <div class="stats-grid" id="stats-grid"></div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Today's Schedule</h2>
                    </div>
                    <div class="table-container">
                        <table id="today-schedule"></table>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Upcoming Jobs (Next 7 Days)</h2>
                    </div>
                    <div class="table-container">
                        <table id="upcoming-jobs"></table>
                    </div>
                </div>
            </div>

            <!-- Job Scheduler Page -->
            <div id="scheduler" class="page">
                <div class="page-header">
                    <h1 class="page-title">Job Scheduler</h1>
                    <p class="page-subtitle">Drag and drop to assign crews</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Weekly Schedule</h2>
                        <button class="btn btn-primary" onclick="app.addScheduledJob()">➕ Add Job</button>
                    </div>
                    <div id="schedule-grid" class="schedule-grid"></div>
                </div>
            </div>

            <!-- Buildings Page -->
            <div id="buildings" class="page">
                <div class="page-header">
                    <h1 class="page-title">Building Database</h1>
                    <p class="page-subtitle">Manage your client facilities</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">All Buildings</h2>
                        <button class="btn btn-primary" onclick="app.showBuildingModal()">➕ Add Building</button>
                    </div>
                    <div class="table-container">
                        <table id="buildings-table"></table>
                    </div>
                </div>
            </div>

            <!-- Crews Page -->
            <div id="crews" class="page">
                <div class="page-header">
                    <h1 class="page-title">Crew Management</h1>
                    <p class="page-subtitle">Manage your cleaning teams</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">All Crews</h2>
                        <button class="btn btn-primary" onclick="app.showCrewModal()">➕ Add Crew</button>
                    </div>
                    <div class="table-container">
                        <table id="crews-table"></table>
                    </div>
                </div>
            </div>

            <!-- Quality Checks Page -->
            <div id="quality" class="page">
                <div class="page-header">
                    <h1 class="page-title">Quality Inspections</h1>
                    <p class="page-subtitle">Track cleaning standards</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Select Building for Inspection</h2>
                    </div>
                    <div class="form-group">
                        <select class="form-select" id="quality-building-select" onchange="app.loadQualityChecklist()">
                            <option value="">-- Select Building --</option>
                        </select>
                    </div>
                </div>

                <div class="card" id="quality-checklist-container" style="display: none;">
                    <div class="card-header">
                        <h2 class="card-title">Quality Checklist</h2>
                        <button class="btn btn-success" onclick="app.signOffChecklist()">✓ Sign Off</button>
                    </div>
                    <div id="quality-checklist"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Recent Inspections</h2>
                    </div>
                    <div class="table-container">
                        <table id="quality-history"></table>
                    </div>
                </div>
            </div>

            <!-- Invoices Page -->
            <div id="invoices" class="page">
                <div class="page-header">
                    <h1 class="page-title">Invoice Generator</h1>
                    <p class="page-subtitle">Create and manage invoices</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Generate Invoice</h2>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Building</label>
                            <select class="form-select" id="invoice-building">
                                <option value="">-- Select Building --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Month</label>
                            <input type="month" class="form-input" id="invoice-month">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="app.generateInvoice()">Generate Invoice</button>
                </div>

                <div class="card" id="invoice-preview" style="display: none;">
                    <div class="card-header">
                        <h2 class="card-title">Invoice Preview</h2>
                        <button class="btn btn-secondary" onclick="window.print()">🖨️ Print</button>
                    </div>
                    <div id="invoice-content"></div>
                </div>
            </div>

            <!-- Supplies Page -->
            <div id="supplies" class="page">
                <div class="page-header">
                    <h1 class="page-title">Supply Tracker</h1>
                    <p class="page-subtitle">Monitor inventory levels</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Inventory Status</h2>
                        <button class="btn btn-primary" onclick="app.showSupplyModal()">➕ Add Supply</button>
                    </div>
                    <div id="supplies-list"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Usage by Building</h2>
                    </div>
                    <div class="table-container">
                        <table id="supply-usage"></table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div id="building-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add/Edit Building</h3>
                <button class="modal-close" onclick="app.closeModal('building-modal')">×</button>
            </div>
            <div class="modal-body">
                <form id="building-form">
                    <div class="form-group">
                        <label class="form-label">Facility Name *</label>
                        <input type="text" class="form-input" name="name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Address *</label>
                        <input type="text" class="form-input" name="address" required>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Contact Name</label>
                            <input type="text" class="form-input" name="contact">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Contact Phone</label>
                            <input type="tel" class="form-input" name="phone">
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Square Footage</label>
                            <input type="number" class="form-input" name="sqft">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Service Frequency</label>
                            <select class="form-select" name="frequency">
                                <option value="Daily">Daily</option>
                                <option value="Mon/Wed/Fri">Mon/Wed/Fri</option>
                                <option value="Tue/Thu">Tue/Thu</option>
                                <option value="Weekly">Weekly</option>
                                <option value="Bi-Weekly">Bi-Weekly</option>
                                <option value="Monthly">Monthly</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Contract Value ($/month)</label>
                        <input type="number" class="form-input" name="contract" step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Special Requirements</label>
                        <textarea class="form-textarea" name="requirements" placeholder="Alarm codes, key locations, restricted areas, etc."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="app.closeModal('building-modal')">Cancel</button>
                <button class="btn btn-primary" onclick="app.saveBuilding()">Save Building</button>
            </div>
        </div>
    </div>

    <div id="crew-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add/Edit Crew</h3>
                <button class="modal-close" onclick="app.closeModal('crew-modal')">×</button>
            </div>
            <div class="modal-body">
                <form id="crew-form">
                    <div class="form-group">
                        <label class="form-label">Crew Name *</label>
                        <input type="text" class="form-input" name="name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Team Members</label>
                        <input type="text" class="form-input" name="members" placeholder="e.g., John, Maria, Carlos">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Availability</label>
                        <select class="form-select" name="availability">
                            <option value="Full-time">Full-time (Mon-Fri)</option>
                            <option value="Part-time">Part-time</option>
                            <option value="Weekdays">Weekdays Only</option>
                            <option value="Weekends">Weekends Only</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="app.closeModal('crew-modal')">Cancel</button>
                <button class="btn btn-primary" onclick="app.saveCrew()">Save Crew</button>
            </div>
        </div>
    </div>

    <div id="supply-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add Supply Item</h3>
                <button class="modal-close" onclick="app.closeModal('supply-modal')">×</button>
            </div>
            <div class="modal-body">
                <form id="supply-form">
                    <div class="form-group">
                        <label class="form-label">Item Name *</label>
                        <input type="text" class="form-input" name="name" required>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Current Stock</label>
                            <input type="number" class="form-input" name="current" value="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Reorder Level</label>
                            <input type="number" class="form-input" name="reorder" value="10">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Unit</label>
                        <select class="form-select" name="unit">
                            <option value="bottles">Bottles</option>
                            <option value="gallons">Gallons</option>
                            <option value="boxes">Boxes</option>
                            <option value="rolls">Rolls</option>
                            <option value="bags">Bags</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="app.closeModal('supply-modal')">Cancel</button>
                <button class="btn btn-primary" onclick="app.saveSupply()">Add Supply</button>
            </div>
        </div>
    </div>

    <script>
        // Application State
        const app = {
            data: {
                buildings: [],
                crews: [],
                schedule: [],
                supplies: [],
                qualityChecks: [],
                settings: {}
            },

            init() {
                this.loadURLParams();
                this.loadData();
                this.setupNavigation();
                this.renderDashboard();
                this.loadInitialData();
            },

            loadURLParams() {
                const params = new URLSearchParams(window.location.search);
                const business = params.get('business');
                const color1 = params.get('color1');
                const color2 = params.get('color2');
                const phone = params.get('phone');
                const city = params.get('city');
                const tagline = params.get('tagline');

                if (business) {
                    document.getElementById('company-name').textContent = business;
                    this.data.settings.businessName = business;
                }
                if (tagline) {
                    document.getElementById('company-tagline').textContent = tagline;
                    this.data.settings.tagline = tagline;
                }
                if (phone) this.data.settings.phone = phone;
                if (city) this.data.settings.city = city;

                if (color1) {
                    document.documentElement.style.setProperty('--primary', '#' + color1);
                }
                if (color2) {
                    document.documentElement.style.setProperty('--secondary', '#' + color2);
                }
            },

            loadInitialData() {
                // Check if we have data in localStorage
                if (this.data.buildings.length === 0) {
                    // Load sample data
                    this.data.buildings = [
                        {
                            id: 1,
                            name: 'Downtown Medical Center',
                            address: '450 Hospital Drive',
                            contact: 'Dr. Sarah Johnson',
                            phone: '(555) 234-5678',
                            sqft: 25000,
                            frequency: 'Daily',
                            contract: 2800,
                            requirements: 'Code: #4582, After hours only (7pm-6am), Restricted areas: Surgery Wing'
                        },
                        {
                            id: 2,
                            name: 'TechStart Office Complex',
                            address: '120 Innovation Blvd',
                            contact: 'Mike Chen',
                            phone: '(555) 345-6789',
                            sqft: 15000,
                            frequency: 'Mon/Wed/Fri',
                            contract: 1500,
                            requirements: 'Key in lockbox #203, Clean after 6pm, No entry to Server Room'
                        },
                        {
                            id: 3,
                            name: 'Riverside Retail Plaza',
                            address: '800 Commerce Street',
                            contact: 'Lisa Martinez',
                            phone: '(555) 456-7890',
                            sqft: 35000,
                            frequency: 'Daily',
                            contract: 3200,
                            requirements: 'Clean before 9am opening, Food court requires special attention'
                        },
                        {
                            id: 4,
                            name: 'Oakwood Elementary School',
                            address: '500 Education Way',
                            contact: 'Principal Anderson',
                            phone: '(555) 567-8901',
                            sqft: 40000,
                            frequency: 'Mon/Wed/Fri',
                            contract: 2200,
                            requirements: 'Green cleaning products only, Classrooms + bathrooms + cafeteria'
                        },
                        {
                            id: 5,
                            name: 'Summit Bank Headquarters',
                            address: '1200 Financial Plaza',
                            contact: 'Robert Williams',
                            phone: '(555) 678-9012',
                            sqft: 20000,
                            frequency: 'Tue/Thu',
                            contract: 1800,
                            requirements: 'Security clearance required, Vault area off-limits, Windows monthly'
                        }
                    ];

                    this.data.crews = [
                        { id: 1, name: 'Alpha Team', members: 'John, Maria, Carlos', availability: 'Full-time' },
                        { id: 2, name: 'Bravo Team', members: 'Sarah, Miguel, Jennifer', availability: 'Full-time' },
                        { id: 3, name: 'Charlie Team', members: 'David, Lisa, Ahmed', availability: 'Full-time' },
                        { id: 4, name: 'Delta Team', members: 'Emily, James', availability: 'Part-time' }
                    ];

                    this.data.schedule = this.generateSampleSchedule();
                    
                    this.data.supplies = [
                        { id: 1, name: 'Multi-Surface Cleaner', current: 45, reorder: 20, unit: 'bottles' },
                        { id: 2, name: 'Disinfectant Spray', current: 18, reorder: 25, unit: 'bottles' },
                        { id: 3, name: 'Glass Cleaner', current: 32, reorder: 15, unit: 'bottles' },
                        { id: 4, name: 'Floor Wax', current: 8, reorder: 10, unit: 'gallons' },
                        { id: 5, name: 'Paper Towels', current: 65, reorder: 50, unit: 'rolls' },
                        { id: 6, name: 'Trash Bags (55gal)', current: 120, reorder: 100, unit: 'boxes' },
                        { id: 7, name: 'Microfiber Cloths', current: 45, reorder: 30, unit: 'boxes' },
                        { id: 8, name: 'Toilet Bowl Cleaner', current: 12, reorder: 20, unit: 'bottles' },
                        { id: 9, name: 'Mop Heads', current: 15, reorder: 10, unit: 'boxes' }
                    ];

                    this.data.qualityChecks = [
                        {
                            id: 1,
                            buildingId: 1,
                            buildingName: 'Downtown Medical Center',
                            date: new Date().toISOString().split('T')[0],
                            inspector: 'Supervisor Kelly',
                            items: {
                                floors: true,
                                restrooms: true,
                                windows: true,
                                trash: true,
                                dusting: true
                            }
                        }
                    ];

                    this.saveData();
                }
            },

            generateSampleSchedule() {
                const schedule = [];
                const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
                const crews = ['Alpha Team', 'Bravo Team', 'Charlie Team'];
                const buildings = ['Downtown Medical Center', 'TechStart Office Complex', 'Riverside Retail Plaza'];
                
                let id = 1;
                days.forEach((day, dayIndex) => {
                    buildings.forEach((building, buildingIndex) => {
                        if (dayIndex % 2 === buildingIndex % 2) {
                            schedule.push({
                                id: id++,
                                day: day,
                                building: building,
                                crew: crews[buildingIndex % crews.length],
                                time: buildingIndex === 0 ? '19:00' : (buildingIndex === 1 ? '18:00' : '07:00'),
                                type: 'Regular Cleaning'
                            });
                        }
                    });
                });

                // Add monthly floor wax
                schedule.push({
                    id: id++,
                    day: 'Monday',
                    building: 'Summit Bank Headquarters',
                    crew: 'Delta Team',
                    time: '20:00',
                    type: 'Floor Waxing'
                });

                return schedule;
            },

            setupNavigation() {
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const page = link.dataset.page;
                        this.navigateTo(page);
                    });
                });
            },

            navigateTo(page) {
                // Update active nav
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.toggle('active', link.dataset.page === page);
                });

                // Update active page
                document.querySelectorAll('.page').forEach(p => {
                    p.classList.toggle('active', p.id === page);
                });

                // Render page content
                switch(page) {
                    case 'dashboard': this.renderDashboard(); break;
                    case 'scheduler': this.renderScheduler(); break;
                    case 'buildings': this.renderBuildings(); break;
                    case 'crews': this.renderCrews(); break;
                    case 'quality': this.renderQuality(); break;
                    case 'invoices': this.renderInvoices(); break;
                    case 'supplies': this.renderSupplies(); break;
                }
            },

            renderDashboard() {
                const today = new Date();
                document.getElementById('dashboard-date').textContent = 
                    today.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

                // Calculate stats
                const todayJobs = this.getTodayJobs();
                const weeklyRevenue = this.data.buildings.reduce((sum, b) => sum + (b.contract || 0), 0);
                const crewsActive = new Set(todayJobs.map(j => j.crew)).size;
                const buildingsThisWeek = this.data.schedule.length;

                const stats = [
                    { label: 'Today\'s Jobs', value: todayJobs.length, icon: '📋', color: 'primary', change: 'On schedule' },
                    { label: 'Crews Dispatched', value: crewsActive, icon: '👥', color: 'success', change: `${this.data.crews.length} total crews` },
                    { label: 'Weekly Services', value: buildingsThisWeek, icon: '🏢', color: 'info', change: `${this.data.buildings.length} total buildings` },
                    { label: 'Monthly Revenue', value: `$${weeklyRevenue.toLocaleString()}`, icon: '💰', color: 'warning', change: 'Active contracts' }
                ];

                const statsHTML = stats.map(stat => `
                    <div class="stat-card ${stat.color}">
                        <div class="stat-header">
                            <span class="stat-label">${stat.label}</span>
                            <div class="stat-icon" style="background: linear-gradient(135deg, var(--${stat.color}), var(--accent));">${stat.icon}</div>
                        </div>
                        <div class="stat-value">${stat.value}</div>
                        <div class="stat-change">${stat.change}</div>
                    </div>
                `).join('');

                document.getElementById('stats-grid').innerHTML = statsHTML;

                // Today's schedule
                const todayHTML = todayJobs.length > 0 ? `
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Building</th>
                            <th>Crew</th>
                            <th>Type</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${todayJobs.map(job => `
                            <tr>
                                <td>${job.time}</td>
                                <td>${job.building}</td>
                                <td>${job.crew}</td>
                                <td>${job.type}</td>
                                <td><span class="badge badge-success">Scheduled</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                ` : '<tbody><tr><td colspan="5" style="text-align: center; padding: 2rem; color: var(--text-light);">No jobs scheduled for today</td></tr></tbody>';

                document.getElementById('today-schedule').innerHTML = todayHTML;

                // Upcoming jobs
                const upcomingHTML = this.data.schedule.slice(0, 10).length > 0 ? `
                    <thead>
                        <tr>
                            <th>Day</th>
                            <th>Time</th>
                            <th>Building</th>
                            <th>Crew</th>
                            <th>Type</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${this.data.schedule.slice(0, 10).map(job => `
                            <tr>
                                <td>${job.day}</td>
                                <td>${job.time}</td>
                                <td>${job.building}</td>
                                <td>${job.crew}</td>
                                <td><span class="badge badge-info">${job.type}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                ` : '<tbody><tr><td colspan="5" style="text-align: center; padding: 2rem; color: var(--text-light);">No upcoming jobs</td></tr></tbody>';

                document.getElementById('upcoming-jobs').innerHTML = upcomingHTML;
            },

            getTodayJobs() {
                const today = new Date().toLocaleDateString('en-US', { weekday: 'long' });
                return this.data.schedule.filter(job => job.day === today);
            },

            renderScheduler() {
                const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
                const times = ['Morning', 'Afternoon', 'Evening'];

                let html = '<div class="schedule-header" style="grid-column: 1;">Time</div>';
                days.forEach(day => {
                    html += `<div class="schedule-header">${day}</div>`;
                });

                times.forEach(time => {
                    html += `<div class="schedule-time">${time}</div>`;
                    days.forEach(day => {
                        const jobs = this.data.schedule.filter(j => j.day === day);
                        const jobsHTML = jobs.map(job => `
                            <div class="schedule-job" draggable="true" data-id="${job.id}">
                                <div class="schedule-job-title">${job.building}</div>
                                <div class="schedule-job-crew">${job.crew} • ${job.time}</div>
                            </div>
                        `).join('');
                        html += `<div class="schedule-cell" data-day="${day}" data-time="${time}">${jobsHTML}</div>`;
                    });
                });

                document.getElementById('schedule-grid').innerHTML = html;
            },

            renderBuildings() {
                const html = `
                    <thead>
                        <tr>
                            <th>Facility Name</th>
                            <th>Address</th>
                            <th>Contact</th>
                            <th>Sq Ft</th>
                            <th>Frequency</th>
                            <th>Contract</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${this.data.buildings.map(building => `
                            <tr>
                                <td><strong>${building.name}</strong></td>
                                <td>${building.address}</td>
                                <td>${building.contact}<br><small style="color: var(--text-light);">${building.phone}</small></td>
                                <td>${building.sqft?.toLocaleString() || '-'} sq ft</td>
                                <td><span class="badge badge-info">${building.frequency}</span></td>
                                <td><strong>$${building.contract?.toLocaleString() || 0}/mo</strong></td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn btn-sm btn-secondary" onclick="app.viewBuilding(${building.id})">View</button>
                                        <button class="btn btn-sm btn-danger" onclick="app.deleteBuilding(${building.id})">Delete</button>
                                    </div>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                `;
                document.getElementById('buildings-table').innerHTML = html;
            },

            renderCrews() {
                const html = `
                    <thead>
                        <tr>
                            <th>Crew Name</th>
                            <th>Team Members</th>
                            <th>Availability</th>
                            <th>Assigned Jobs</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${this.data.crews.map(crew => {
                            const jobs = this.data.schedule.filter(j => j.crew === crew.name).length;
                            return `
                                <tr>
                                    <td><strong>${crew.name}</strong></td>
                                    <td>${crew.members}</td>
                                    <td><span class="badge badge-success">${crew.availability}</span></td>
                                    <td>${jobs} jobs this week</td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="btn btn-sm btn-secondary" onclick="app.editCrew(${crew.id})">Edit</button>
                                            <button class="btn btn-sm btn-danger" onclick="app.deleteCrew(${crew.id})">Delete</button>
                                        </div>
                                    </td>
                                </tr>
                            `;
                        }).join('')}
                    </tbody>
                `;
                document.getElementById('crews-table').innerHTML = html;
            },

            renderQuality() {
                // Populate building dropdown
                const select = document.getElementById('quality-building-select');
                select.innerHTML = '<option value="">-- Select Building --</option>' +
                    this.data.buildings.map(b => `<option value="${b.id}">${b.name}</option>`).join('');

                // Render recent inspections
                const html = this.data.qualityChecks.length > 0 ? `
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Building</th>
                            <th>Inspector</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${this.data.qualityChecks.map(check => `
                            <tr>
                                <td>${new Date(check.date).toLocaleDateString()}</td>
                                <td>${check.buildingName}</td>
                                <td>${check.inspector}</td>
                                <td><span class="badge badge-success">Completed</span></td>
                                <td><button class="btn btn-sm btn-secondary" onclick="app.viewQualityCheck(${check.id})">View</button></td>
                            </tr>
                        `).join('')}
                    </tbody>
                ` : '<tbody><tr><td colspan="5" style="text-align: center; padding: 2rem; color: var(--text-light);">No inspections recorded</td></tr></tbody>';

                document.getElementById('quality-history').innerHTML = html;
            },

            loadQualityChecklist() {
                const buildingId = parseInt(document.getElementById('quality-building-select').value);
                if (!buildingId) {
                    document.getElementById('quality-checklist-container').style.display = 'none';
                    return;
                }

                const building = this.data.buildings.find(b => b.id === buildingId);
                document.getElementById('quality-checklist-container').style.display = 'block';

                const items = [
                    { id: 'floors', title: 'Floors & Carpets', description: 'Vacuumed, mopped, no stains or debris' },
                    { id: 'restrooms', title: 'Restrooms', description: 'Toilets, sinks, mirrors cleaned and sanitized' },
                    { id: 'windows', title: 'Windows & Glass', description: 'Streak-free, no smudges or fingerprints' },
                    { id: 'trash', title: 'Trash Removal', description: 'All bins emptied and liners replaced' },
                    { id: 'dusting', title: 'Dusting & Surfaces', description: 'Desks, shelves, ledges dust-free' },
                    { id: 'kitchen', title: 'Kitchen/Break Room', description: 'Counters, appliances, sink cleaned' },
                    { id: 'entrance', title: 'Entrance & Lobby', description: 'Clean, welcoming, mats in place' }
                ];

                const html = items.map(item => `
                    <div class="checklist-item">
                        <input type="checkbox" class="checklist-checkbox" id="check-${item.id}" data-item="${item.id}">
                        <div class="checklist-content">
                            <div class="checklist-title">${item.title}</div>
                            <div class="checklist-notes">${item.description}</div>
                        </div>
                    </div>
                `).join('');

                document.getElementById('quality-checklist').innerHTML = html;
            },

            signOffChecklist() {
                const buildingId = parseInt(document.getElementById('quality-building-select').value);
                if (!buildingId) return;

                const building = this.data.buildings.find(b => b.id === buildingId);
                const items = {};
                
                document.querySelectorAll('.checklist-checkbox').forEach(checkbox => {
                    items[checkbox.dataset.item] = checkbox.checked;
                });

                const check = {
                    id: Date.now(),
                    buildingId: buildingId,
                    buildingName: building.name,
                    date: new Date().toISOString().split('T')[0],
                    inspector: 'Current User',
                    items: items
                };

                this.data.qualityChecks.push(check);
                this.saveData();
                
                alert('✅ Quality inspection signed off successfully!');
                document.getElementById('quality-building-select').value = '';
                this.loadQualityChecklist();
                this.renderQuality();
            },

            renderInvoices() {
                // Populate building dropdown
                const select = document.getElementById('invoice-building');
                select.innerHTML = '<option value="">-- Select Building --</option>' +
                    this.data.buildings.map(b => `<option value="${b.id}">${b.name}</option>`).join('');

                // Set default month to current
                const now = new Date();
                document.getElementById('invoice-month').value = 
                    `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
            },

            generateInvoice() {
                const buildingId = parseInt(document.getElementById('invoice-building').value);
                const month = document.getElementById('invoice-month').value;

                if (!buildingId || !month) {
                    alert('Please select a building and month');
                    return;
                }

                const building = this.data.buildings.find(b => b.id === buildingId);
                const [year, monthNum] = month.split('-');
                const monthName = new Date(year, monthNum - 1).toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

                const invoiceNumber = `INV-${year}${monthNum}-${String(buildingId).padStart(3, '0')}`;

                // Calculate services
                const services = [
                    { description: `${building.frequency} Cleaning Service`, quantity: 1, rate: building.contract, amount: building.contract }
                ];

                // Add floor waxing if applicable
                if (Math.random() > 0.7) {
                    services.push({ description: 'Monthly Floor Waxing', quantity: 1, rate: 200, amount: 200 });
                }

                const subtotal = services.reduce((sum, s) => sum + s.amount, 0);
                const tax = subtotal * 0.08;
                const total = subtotal + tax;

                const html = `
                    <div class="invoice">
                        <div class="invoice-header">
                            <div>
                                <div class="invoice-logo">${this.data.settings.businessName || 'CleaningPro'}</div>
                                <div>${this.data.settings.city || 'Your City'}</div>
                                <div>${this.data.settings.phone || '(555) 123-4567'}</div>
                            </div>
                            <div class="invoice-details">
                                <div class="invoice-number">Invoice #${invoiceNumber}</div>
                                <div>Date: ${new Date().toLocaleDateString()}</div>
                                <div>Period: ${monthName}</div>
                            </div>
                        </div>

                        <div class="invoice-section">
                            <div class="invoice-section-title">Bill To:</div>
                            <div><strong>${building.name}</strong></div>
                            <div>${building.address}</div>
                            <div>${building.contact}</div>
                            <div>${building.phone}</div>
                        </div>

                        <table class="invoice-table">
                            <thead>
                                <tr>
                                    <th>Description</th>
                                    <th style="text-align: right;">Quantity</th>
                                    <th style="text-align: right;">Rate</th>
                                    <th style="text-align: right;">Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${services.map(service => `
                                    <tr>
                                        <td>${service.description}</td>
                                        <td style="text-align: right;">${service.quantity}</td>
                                        <td style="text-align: right;">$${service.rate.toFixed(2)}</td>
                                        <td style="text-align: right;">$${service.amount.toFixed(2)}</td>
                                    </tr>
                                `).join('')}
                                <tr>
                                    <td colspan="3" style="text-align: right;"><strong>Subtotal:</strong></td>
                                    <td style="text-align: right;"><strong>$${subtotal.toFixed(2)}</strong></td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="text-align: right;">Tax (8%):</td>
                                    <td style="text-align: right;">$${tax.toFixed(2)}</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="invoice-total">
                            <span class="invoice-total-label">Total Due:</span>
                            <span class="invoice-total-amount">$${total.toFixed(2)}</span>
                        </div>

                        <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border); color: var(--text-light); font-size: 0.875rem;">
                            <p><strong>Payment Terms:</strong> Due within 30 days of invoice date</p>
                            <p><strong>Payment Methods:</strong> Check, ACH Transfer, Credit Card</p>
                            <p style="margin-top: 1rem;">Thank you for your business!</p>
                        </div>
                    </div>
                `;

                document.getElementById('invoice-content').innerHTML = html;
                document.getElementById('invoice-preview').style.display = 'block';
            },

            renderSupplies() {
                const html = this.data.supplies.map(supply => {
                    const percentage = (supply.current / (supply.reorder * 2)) * 100;
                    const level = percentage > 50 ? 'high' : (percentage > 25 ? 'medium' : 'low');
                    const levelText = percentage > 50 ? 'Good' : (percentage > 25 ? 'Low' : 'Critical');
                    const badgeClass = percentage > 50 ? 'badge-success' : (percentage > 25 ? 'badge-warning' : 'badge-danger');

                    return `
                        <div class="supply-card">
                            <div class="supply-header">
                                <div class="supply-name">${supply.name}</div>
                                <span class="badge ${badgeClass}">${levelText}</span>
                            </div>
                            <div class="supply-level">
                                <div class="supply-bar" style="flex: 1;">
                                    <div class="supply-bar-fill ${level}" style="width: ${Math.min(percentage, 100)}%"></div>
                                </div>
                                <span style="font-size: 0.875rem; color: var(--text-light); min-width: 80px; text-align: right;">
                                    ${supply.current} ${supply.unit}
                                </span>
                            </div>
                            <div style="font-size: 0.75rem; color: var(--text-light); margin-top: 0.5rem;">
                                Reorder at: ${supply.reorder} ${supply.unit}
                            </div>
                        </div>
                    `;
                }).join('');

                document.getElementById('supplies-list').innerHTML = html;

                // Render usage table
                const usageHTML = `
                    <thead>
                        <tr>
                            <th>Building</th>
                            <th>Last Restocked</th>
                            <th>Items Used</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${this.data.buildings.slice(0, 5).map(building => `
                            <tr>
                                <td><strong>${building.name}</strong></td>
                                <td>${new Date(Date.now() - Math.random() * 7 * 24 * 60 * 60 * 1000).toLocaleDateString()}</td>
                                <td>${Math.floor(Math.random() * 20 + 5)} items</td>
                                <td><span class="badge badge-success">Stocked</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                `;
                document.getElementById('supply-usage').innerHTML = usageHTML;
            },

            showBuildingModal(id = null) {
                if (id) {
                    const building = this.data.buildings.find(b => b.id === id);
                    if (building) {
                        Object.keys(building).forEach(key => {
                            const input = document.querySelector(`#building-form [name="${key}"]`);
                            if (input) input.value = building[key];
                        });
                    }
                } else {
                    document.getElementById('building-form').reset();
                }
                document.getElementById('building-modal').classList.add('active');
            },

            showCrewModal(id = null) {
                if (id) {
                    const crew = this.data.crews.find(c => c.id === id);
                    if (crew) {
                        Object.keys(crew).forEach(key => {
                            const input = document.querySelector(`#crew-form [name="${key}"]`);
                            if (input) input.value = crew[key];
                        });
                    }
                } else {
                    document.getElementById('crew-form').reset();
                }
                document.getElementById('crew-modal').classList.add('active');
            },

            showSupplyModal() {
                document.getElementById('supply-form').reset();
                document.getElementById('supply-modal').classList.add('active');
            },

            closeModal(id) {
                document.getElementById(id).classList.remove('active');
            },

            saveBuilding() {
                const form = document.getElementById('building-form');
                const formData = new FormData(form);
                const building = {
                    id: Date.now(),
                    name: formData.get('name'),
                    address: formData.get('address'),
                    contact: formData.get('contact'),
                    phone: formData.get('phone'),
                    sqft: parseInt(formData.get('sqft')) || 0,
                    frequency: formData.get('frequency'),
                    contract: parseFloat(formData.get('contract')) || 0,
                    requirements: formData.get('requirements')
                };

                this.data.buildings.push(building);
                this.saveData();
                this.closeModal('building-modal');
                this.renderBuildings();
                alert('✅ Building added successfully!');
            },

            saveCrew() {
                const form = document.getElementById('crew-form');
                const formData = new FormData(form);
                const crew = {
                    id: Date.now(),
                    name: formData.get('name'),
                    members: formData.get('members'),
                    availability: formData.get('availability')
                };

                this.data.crews.push(crew);
                this.saveData();
                this.closeModal('crew-modal');
                this.renderCrews();
                alert('✅ Crew added successfully!');
            },

            saveSupply() {
                const form = document.getElementById('supply-form');
                const formData = new FormData(form);
                const supply = {
                    id: Date.now(),
                    name: formData.get('name'),
                    current: parseInt(formData.get('current')) || 0,
                    reorder: parseInt(formData.get('reorder')) || 10,
                    unit: formData.get('unit')
                };

                this.data.supplies.push(supply);
                this.saveData();
                this.closeModal('supply-modal');
                this.renderSupplies();
                alert('✅ Supply item added successfully!');
            },

            deleteBuilding(id) {
                if (confirm('Are you sure you want to delete this building?')) {
                    this.data.buildings = this.data.buildings.filter(b => b.id !== id);
                    this.saveData();
                    this.renderBuildings();
                }
            },

            deleteCrew(id) {
                if (confirm('Are you sure you want to delete this crew?')) {
                    this.data.crews = this.data.crews.filter(c => c.id !== id);
                    this.saveData();
                    this.renderCrews();
                }
            },

            viewBuilding(id) {
                const building = this.data.buildings.find(b => b.id === id);
                if (building) {
                    alert(`Building Details:\n\n${building.name}\n${building.address}\n\nContact: ${building.contact} (${building.phone})\nSq Ft: ${building.sqft?.toLocaleString()}\nFrequency: ${building.frequency}\nContract: $${building.contract?.toLocaleString()}/mo\n\nSpecial Requirements:\n${building.requirements || 'None'}`);
                }
            },

            saveData() {
                localStorage.setItem('cleaningProData', JSON.stringify(this.data));
            },

            loadData() {
                const saved = localStorage.getItem('cleaningProData');
                if (saved) {
                    this.data = JSON.parse(saved);
                }
            }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });

        // Close modals on outside click
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });
    </script>
<script>// Anti-scrape protection — injected into all tool pages
(function(){
  // Disable right-click context menu

  
  
  // Disable text selection on body (forms still selectable)
  
  
  // Re-enable for inputs/textareas
  document.querySelectorAll('input,textarea,select').forEach(function(el){
    el.style.userSelect = 'auto'; el.style.webkitUserSelect = 'auto';
  });
  
  // Disable drag
  document.addEventListener('dragstart', function(e){ e.preventDefault(); });
  
  // Disable print
  var style = document.createElement('style');
  style.textContent = '@media print { body { display: none !important; } }';
  document.head.appendChild(style);
  
  // Add invisible watermark
  var wm = document.createElement('div');
  wm.style.cssText = 'position:fixed;bottom:0;right:0;opacity:0.03;font-size:10px;pointer-events:none;z-index:99999;color:#000;';
  wm.textContent = 'Licensed demo — bennycutools.com — ' + new Date().toISOString().slice(0,10);
  document.body.appendChild(wm);
  
  // Detect devtools (basic)
  var threshold = 160;
  setInterval(function(){
    if (window.outerWidth - window.innerWidth > threshold || window.outerHeight - window.innerHeight > threshold) {
      document.body.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100vh;font-family:sans-serif;"><h1>This demo is proprietary. Please contact ben@bennycutools.com for licensing.</h1></div>';
    }
  }, 1000);
})();
</script>

<!-- BennyCuTools Purchase CTA — injected by inject-cta.py -->
<style>
#bct-cta-bar {
  position: fixed;
  bottom: 48px;
  left: 0;
  right: 0;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  border-top: 2px solid #6366f1;
  padding: 10px 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  z-index: 99998;
  flex-wrap: wrap;
  box-shadow: 0 -4px 20px rgba(0,0,0,0.3);
}
#bct-cta-bar .bct-cta-text {
  color: #e4e4e7;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 14px;
  font-weight: 500;
}
#bct-cta-bar .bct-cta-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 20px;
  background: #6366f1;
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 14px;
  font-weight: 600;
  border: none;
  border-radius: 6px;
  text-decoration: none;
  cursor: pointer;
  transition: background 0.2s, transform 0.1s;
}
#bct-cta-bar .bct-cta-btn:hover {
  background: #4f46e5;
  transform: translateY(-1px);
}
#bct-cta-bar .bct-cta-btn-secondary {
  background: transparent;
  border: 1px solid #6366f1;
  color: #a5b4fc;
}
#bct-cta-bar .bct-cta-btn-secondary:hover {
  background: rgba(99,102,241,0.15);
}
@media (max-width: 600px) {
  #bct-cta-bar {
    flex-direction: column;
    gap: 8px;
    padding: 8px 12px;
    bottom: 44px;
  }
  #bct-cta-bar .bct-cta-text { font-size: 12px; }
  #bct-cta-bar .bct-cta-btn { font-size: 13px; padding: 7px 16px; width: 100%; justify-content: center; }
}
</style>
<div id="bct-cta-bar" role="banner" aria-label="Purchase this tool">
  <span class="bct-cta-text">Like this tool? Make it yours.</span>
  <a class="bct-cta-btn" id="bct-buy-btn" href="https://bennycutools.com/buy.html">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
    Get It — $200 One-Time
  </a>
  <a class="bct-cta-btn bct-cta-btn-secondary" href="mailto:cuuper225@gmail.com?subject=Question%20about%20my%20custom%20tool">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
    Questions? Email Ben
  </a>
</div>
<script>
// Auto-fill the buy link with the current tool's page name
(function(){
  try {
    var pg = location.pathname.replace(/.*\//, '').replace('.html','');
    var buyBtn = document.getElementById('bct-buy-btn');
    if (buyBtn && pg) {
      buyBtn.href = 'https://bennycutools.com/buy.html?tool=' + encodeURIComponent(pg);
    }
  } catch(e){}
})();
</script>
<!-- End BennyCuTools Purchase CTA -->

</body>
</html>
