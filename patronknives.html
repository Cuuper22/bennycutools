<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>BladeBoard - Patron Saint of Knives</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Bitter:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
--charcoal:#2B2B2B;--charcoal-light:#3D3D3D;--brass:#C2922E;--brass-light:#D4A94A;--brass-dark:#A67B1F;
--forest:#4A6741;--forest-light:#5E8354;--parchment:#F7F5F0;--card:#FFFFFF;--border:#E2DFD8;
--muted:#7A766E;--text:#1C1C1C;--success:#3A7D44;--error:#B83A3A;--info:#3A6B9F;
--shadow-sm:0 1px 3px rgba(28,28,28,0.06),0 1px 2px rgba(28,28,28,0.04);
--shadow-md:0 4px 14px rgba(28,28,28,0.08),0 2px 6px rgba(28,28,28,0.04);
--shadow-lg:0 12px 36px rgba(28,28,28,0.12),0 4px 12px rgba(28,28,28,0.06);
--radius:10px;--radius-sm:6px;
--font-head:'Bitter',serif;--font-body:'Inter',sans-serif;
}
html{font-size:16px;-webkit-text-size-adjust:100%}
body{padding-bottom:80px;font-family:var(--font-body);background:var(--parchment);color:var(--text);line-height:1.5;padding-bottom:120px!important;min-height:100vh;overflow-x:hidden}
h1,h2,h3{font-family:var(--font-head);font-weight:600;line-height:1.2}
h1{font-size:1.5rem}h2{font-size:1.2rem}h3{font-size:1rem}
button,input,select,textarea{font-family:var(--font-body);font-size:16px}
*:focus-visible{outline:3px solid var(--brass);outline-offset:3px}
@media(prefers-reduced-motion:reduce){*,*::before,*::after{animation-duration:0.01ms!important;transition-duration:0.01ms!important}}
.skip-link{position:absolute;top:-100px;left:16px;background:var(--charcoal);color:#fff;padding:10px 18px;border-radius:var(--radius-sm);z-index:100000;font-size:14px;font-weight:500;text-decoration:none}
.skip-link:focus{top:12px}

#app{display:none;max-width:480px;margin:0 auto}
@media(min-width:1024px){#app{max-width:720px}}

.app-header{background:var(--charcoal);color:#fff;padding:14px 20px;display:flex;align-items:center;gap:10px;position:sticky;top:0;z-index:100}
.app-header h1{color:#fff;font-size:1.15rem;flex:1}
.header-stats{display:flex;gap:12px;font-size:12px;color:rgba(255,255,255,0.7)}
.header-stats strong{color:var(--brass);font-weight:700}

.demo-banner{background:#FDF6E3;border-bottom:1px solid #EDE0B8;padding:10px 16px;display:flex;align-items:center;gap:8px;font-size:13px;color:#6B5B1F}
.demo-banner button{background:none;border:none;color:var(--brass-dark);cursor:pointer;font-weight:600;padding:6px 10px;margin-left:auto;border-radius:var(--radius-sm);transition:background 0.15s}
.demo-banner button:hover{background:rgba(194,146,46,0.15)}
.demo-banner button:focus-visible{outline:2px solid var(--brass-dark);outline-offset:2px}

.tab-content{padding:16px;display:none;animation:fadeUp 0.35s ease-out}
.tab-content.active{display:block}
@keyframes fadeUp{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}

.bottom-nav{position:fixed;bottom:48px;left:0;right:0;background:var(--card);border-top:1px solid var(--border);display:flex;z-index:90;padding:6px 0 10px}
.bottom-nav button{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;padding:8px 4px;background:none;border:none;color:var(--muted);cursor:pointer;font-size:11px;font-weight:500;font-family:var(--font-body);transition:color 0.15s,transform 0.12s;border-radius:var(--radius-sm)}
.bottom-nav button.active{color:var(--brass-dark)}
.bottom-nav button svg{width:22px;height:22px}
.bottom-nav button:hover{color:var(--brass-dark)}
.bottom-nav button:active{transform:scale(0.95)}
.bottom-nav button:focus-visible{outline:2px solid var(--brass);outline-offset:-2px}

.card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow-sm);border:1px solid var(--border);margin-bottom:12px;overflow:hidden;transition:box-shadow 0.2s,transform 0.15s}
.card:hover{box-shadow:var(--shadow-md)}

.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 20px;border:none;border-radius:var(--radius-sm);font-weight:600;font-size:14px;cursor:pointer;transition:transform 0.12s,box-shadow 0.15s,background 0.15s;min-height:44px}
.btn:active{transform:scale(0.97)}
.btn-brass{background:var(--brass);color:#fff}
.btn-brass:hover{background:var(--brass-light);box-shadow:0 2px 8px rgba(194,146,46,0.3)}
.btn-dark{background:var(--charcoal);color:#fff}
.btn-dark:hover{background:var(--charcoal-light)}
.btn-outline{background:transparent;border:1.5px solid var(--border);color:var(--text)}
.btn-outline:hover{border-color:var(--brass);color:var(--brass-dark);background:rgba(194,146,46,0.05)}
.btn-sm{padding:8px 14px;font-size:13px}
.btn-block{width:100%}
.btn svg{width:16px;height:16px;flex-shrink:0}

.fab{position:fixed;bottom:118px;right:20px;width:56px;height:56px;border-radius:50%;background:var(--brass);color:#fff;border:none;box-shadow:var(--shadow-lg);cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:80;transition:transform 0.2s,box-shadow 0.2s,background 0.15s}
.fab:hover{transform:scale(1.08);box-shadow:0 8px 24px rgba(194,146,46,0.4)}
.fab:active{transform:scale(0.95)}
.fab:focus-visible{outline:3px solid var(--brass);outline-offset:3px}
.fab svg{width:28px;height:28px}

.form-group{margin-bottom:16px}
.form-group label{display:block;font-size:12px;font-weight:600;color:var(--muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:0.04em}
.form-group input,.form-group select,.form-group textarea{width:100%;padding:12px 14px;border:1.5px solid var(--border);border-radius:var(--radius-sm);background:var(--card);color:var(--text);font-size:16px;transition:border-color 0.15s,box-shadow 0.15s;min-height:44px}
.form-group input:focus,.form-group select:focus,.form-group textarea:focus{border-color:var(--brass);box-shadow:0 0 0 3px rgba(194,146,46,0.15)}
.form-group input::placeholder,.form-group textarea::placeholder{color:var(--muted);opacity:0.7}

/* Order Card */
.order-card{padding:16px;border-bottom:1px solid var(--border);display:flex;gap:14px;align-items:flex-start;transition:background 0.15s;cursor:pointer;min-height:44px}
.order-card:last-child{border-bottom:none}
.order-card:hover{background:rgba(194,146,46,0.03)}
.order-card:active{background:rgba(194,146,46,0.06)}
.order-photo{width:52px;height:52px;border-radius:var(--radius-sm);background:var(--parchment);display:flex;align-items:center;justify-content:center;overflow:hidden;flex-shrink:0;border:1px solid var(--border)}
.order-photo img{width:100%;height:100%;object-fit:cover}
.order-photo svg{width:22px;height:22px;color:var(--muted)}
.order-info{flex:1;min-width:0}
.order-info h3{font-size:14px;margin-bottom:4px;color:var(--text)}
.order-info p{font-size:12px;color:var(--muted);line-height:1.4}
.order-right{text-align:right;flex-shrink:0}
.order-price{font-weight:700;color:var(--brass-dark);font-size:15px}
.order-time{font-size:11px;color:var(--muted);margin-top:4px}

.status-badge{display:inline-block;padding:4px 10px;border-radius:12px;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:0.04em}
.status-received{background:rgba(58,107,159,0.12);color:var(--info)}
.status-progress{background:rgba(194,146,46,0.18);color:var(--brass-dark)}
.status-ready{background:rgba(58,125,68,0.12);color:var(--success)}
.status-notified{background:rgba(74,103,65,0.15);color:var(--forest)}
.status-picked{background:rgba(122,118,110,0.1);color:var(--muted)}

/* Item Counter */
.item-counter{display:flex;align-items:center;gap:10px;padding:10px 0}
.item-counter label{font-size:14px;min-width:90px;color:var(--text);font-weight:500}
.counter-btn{width:40px;height:40px;border-radius:50%;border:1.5px solid var(--border);background:var(--card);color:var(--text);font-size:20px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.12s;min-height:44px;min-width:44px}
.counter-btn:hover{background:var(--parchment);border-color:var(--brass)}
.counter-btn:active{transform:scale(0.9);background:var(--brass);color:#fff;border-color:var(--brass)}
.counter-btn:focus-visible{outline:2px solid var(--brass);outline-offset:2px}
.counter-val{font-size:20px;font-weight:700;min-width:32px;text-align:center;color:var(--text)}

/* Summary Strip */
.summary-strip{display:flex;gap:0;background:var(--charcoal);border-radius:var(--radius);overflow:hidden;margin-bottom:16px}
.summary-item{flex:1;padding:16px 10px;text-align:center;border-right:1px solid rgba(255,255,255,0.08)}
.summary-item:last-child{border-right:none}
.summary-item .val{font-size:1.5rem;font-weight:700;color:var(--brass);font-family:var(--font-head)}
.summary-item .lbl{font-size:11px;color:rgba(255,255,255,0.55);text-transform:uppercase;letter-spacing:0.06em;margin-top:4px;font-weight:500}

/* Filter pills */
.filter-row{display:flex;gap:8px;margin-bottom:14px;overflow-x:auto;padding-bottom:6px;scrollbar-width:none}
.filter-row::-webkit-scrollbar{display:none}
.filter-pill{padding:8px 14px;border-radius:18px;font-size:13px;font-weight:500;border:1.5px solid var(--border);background:var(--card);color:var(--muted);cursor:pointer;white-space:nowrap;transition:all 0.15s;min-height:36px}
.filter-pill.active{background:var(--charcoal);color:#fff;border-color:var(--charcoal)}
.filter-pill:hover:not(.active){border-color:var(--brass);color:var(--brass-dark)}
.filter-pill:active{transform:scale(0.95)}
.filter-pill:focus-visible{outline:2px solid var(--brass);outline-offset:2px}

.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(28,28,28,0.65);backdrop-filter:blur(4px);z-index:200;display:none;align-items:flex-end;justify-content:center;opacity:0;transition:opacity 0.2s}
.modal-overlay.show{display:flex;opacity:1}
.modal{background:var(--card);border-radius:var(--radius) var(--radius) 0 0;width:100%;max-width:480px;max-height:90vh;overflow-y:auto;padding:24px 20px;animation:slideUp 0.3s cubic-bezier(0.34,1.56,0.64,1);position:relative}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.modal h2{margin-bottom:18px;font-size:1.3rem}
.modal-close{position:absolute;top:16px;right:16px;background:none;border:none;cursor:pointer;padding:10px;color:var(--muted);border-radius:var(--radius-sm);transition:color 0.15s,background 0.15s;min-height:44px;min-width:44px;display:flex;align-items:center;justify-content:center}
.modal-close:hover{color:var(--text);background:var(--parchment)}
.modal-close:focus-visible{outline:2px solid var(--brass);outline-offset:2px}

.camera-container{position:relative;width:100%;aspect-ratio:4/3;background:#000;border-radius:var(--radius);overflow:hidden;margin-bottom:14px}
.camera-container video{width:100%;height:100%;object-fit:cover}
.camera-container canvas{display:none}
.camera-shutter{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);width:64px;height:64px;border-radius:50%;background:rgba(255,255,255,0.95);border:4px solid var(--brass);cursor:pointer;transition:transform 0.12s,background 0.15s}
.camera-shutter:hover{background:#fff;transform:translateX(-50%) scale(1.05)}
.camera-shutter:active{transform:translateX(-50%) scale(0.9)}
.camera-shutter:focus-visible{outline:3px solid var(--brass-light);outline-offset:4px}

.toast-container{position:fixed;top:16px;left:50%;transform:translateX(-50%);z-index:10000;pointer-events:none}
.toast{background:var(--charcoal);color:#fff;padding:12px 24px;border-radius:var(--radius);font-size:14px;font-weight:500;box-shadow:var(--shadow-lg);animation:toastIn 0.3s ease-out;margin-bottom:8px;min-width:200px;text-align:center}
@keyframes toastIn{from{opacity:0;transform:translateY(-12px)}to{opacity:1;transform:translateY(0)}}

/* Upsell */
.upsell-box{background:linear-gradient(135deg,var(--parchment) 0%,#fff 100%);border:2px dashed var(--border);border-radius:var(--radius);padding:28px 24px;text-align:center}
.upsell-tag{background:var(--charcoal);color:var(--brass);font-size:11px;font-weight:700;padding:5px 12px;border-radius:10px;text-transform:uppercase;letter-spacing:0.06em;display:inline-block;margin-bottom:14px}
.upsell-box h3{margin-bottom:10px;font-size:1.1rem}
.upsell-box p{font-size:14px;color:var(--muted);margin-bottom:16px;line-height:1.5}
.upsell-box a{color:var(--brass-dark);font-weight:600;font-size:14px;text-decoration:none;padding:10px 20px;border:1.5px solid var(--brass);border-radius:var(--radius-sm);display:inline-block;transition:background 0.15s,color 0.15s}
.upsell-box a:hover{background:var(--brass);color:#fff}
.upsell-box a:focus-visible{outline:2px solid var(--brass);outline-offset:2px}

/* Empty States */
.empty-state{text-align:center;padding:48px 24px}
.empty-state svg{width:64px;height:64px;color:var(--border);margin-bottom:16px}
.empty-state h2{font-size:1.1rem;margin-bottom:8px;color:var(--text)}
.empty-state p{color:var(--muted);font-size:14px;line-height:1.5;max-width:280px;margin:0 auto}

/* Loading State */
.skeleton{animation:skeleton-pulse 1.5s ease-in-out infinite;background:linear-gradient(90deg,var(--parchment) 25%,#f0ede6 50%,var(--parchment) 75%);background-size:200% 100%;border-radius:var(--radius-sm)}
@keyframes skeleton-pulse{0%{background-position:200% 0}100%{background-position:-200% 0}}

@media print{
.bottom-nav,.fab,.demo-banner,.app-header,.toast-container,.modal-overlay,#bct-demo-disclaimer{display:none!important}
body{padding-bottom:80px;background:#fff;padding:0}
.card{box-shadow:none;border:1px solid #ddd}
}

/* High contrast mode support */
@media(prefers-contrast:high){
:root{--border:#999;--muted:#444}
.btn-brass{outline:2px solid transparent}
.btn-brass:hover{outline-color:var(--brass-light)}
}
</style>
</head>
<body>
<a href="#main-content" class="skip-link">Skip to main content</a>

<div id="gate" style="display:flex;align-items:center;justify-content:center;height:100vh;font-family:var(--font-body);background:var(--charcoal);color:#fff;text-align:center;padding:20px">
<div>
<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="#C2922E" stroke-width="1.5" aria-hidden="true"><path d="M14.5 3L3 14.5V21h6.5L21 9.5"/><path d="M14 4l6 6"/><line x1="7" y1="17" x2="3" y2="21"/></svg>
<h1 style="font-family:var(--font-head);font-size:1.8rem;margin:20px 0 10px">BladeBoard</h1>
<p style="color:rgba(255,255,255,0.65);margin-bottom:28px;font-size:15px">Enter your access key to open your board</p>
<form id="gate-form" style="max-width:300px;margin:0 auto">
<label for="gate-key" class="visually-hidden" style="position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0">Access key</label>
<input type="text" id="gate-key" placeholder="Your access key" autocomplete="off" style="width:100%;padding:14px;border:1.5px solid rgba(255,255,255,0.2);border-radius:var(--radius-sm);background:rgba(255,255,255,0.08);color:#fff;font-size:16px;text-align:center;margin-bottom:14px;transition:border-color 0.15s">
<button type="submit" style="width:100%;padding:14px;background:var(--brass);color:#fff;border:none;border-radius:var(--radius-sm);font-weight:700;font-size:16px;cursor:pointer;font-family:var(--font-head);transition:background 0.15s,transform 0.12s;min-height:48px">Open Board</button>
</form>
<p style="margin-top:28px;font-size:13px;color:rgba(255,255,255,0.4)">Need help? <a href="mailto:ben@bennycutools.com" style="color:rgba(255,255,255,0.6);text-decoration:underline">ben@bennycutools.com</a></p>
</div>
</div>

<div id="app">
<header class="app-header" role="banner">
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M14.5 3L3 14.5V21h6.5L21 9.5"/><path d="M14 4l6 6"/></svg>
<h1>BladeBoard</h1>
<div class="header-stats" id="headerStats"></div>
</header>

<div id="demoBanner" class="demo-banner" role="status" aria-live="polite">
<span>Sample orders loaded. Tap Clear to start fresh.</span>
<button onclick="clearDemo()" aria-label="Clear all sample orders">Clear</button>
</div>

<main id="main-content">
<!-- Tab: Board -->
<section id="tab-board" class="tab-content active" role="tabpanel" aria-label="Order board">
<div id="todaySummary" class="summary-strip" role="region" aria-label="Today's summary"></div>
<div class="filter-row" id="filterRow" role="tablist" aria-label="Filter orders by status"></div>
<div id="ordersList"></div>
<div id="boardEmpty" class="empty-state" style="display:none">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true"><path d="M14.5 3L3 14.5V21h6.5L21 9.5"/><path d="M14 4l6 6"/></svg>
<h2>No orders on your board</h2>
<p>Tap the + button to log your first sharpening order.</p>
</div>
</section>

<!-- Tab: History -->
<section id="tab-history" class="tab-content" role="tabpanel" aria-label="Order history">
<h2 style="margin-bottom:14px;font-size:1.15rem">Completed Orders</h2>
<div id="historyList"></div>
<div id="historyEmpty" class="empty-state" style="display:none">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
<h2>No completed orders yet</h2>
<p>Orders marked as picked up will show up here.</p>
</div>
</section>

<!-- Tab: Stats -->
<section id="tab-stats" class="tab-content" role="tabpanel" aria-label="Statistics">
<h2 style="margin-bottom:14px;font-size:1.15rem">This Week</h2>
<div id="weekStats" class="summary-strip" style="margin-bottom:20px" role="region" aria-label="Weekly statistics"></div>
<h2 style="margin-bottom:14px;font-size:1.15rem">All Time</h2>
<div id="allStats" class="summary-strip" role="region" aria-label="All time statistics"></div>
<div class="upsell-box" style="margin-top:28px">
<span class="upsell-tag">Full Version</span>
<h3>Track Your Growth</h3>
<p>See monthly revenue trends, spot your busiest days, and track repeat customers. Know exactly how your sharpening business is performing.</p>
<a href="mailto:ben@bennycutools.com?subject=BladeBoard%20Full%20Version" role="button">Get the full version — $200</a>
</div>
</section>
</main>

<button id="addFab" class="fab" onclick="showNewOrder()" aria-label="Add new order">
<svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
</button>

<nav class="bottom-nav" role="navigation" aria-label="Main navigation">
<button class="active" onclick="switchTab('board')" data-tab="board" aria-label="Order board" aria-current="page">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
Board
</button>
<button onclick="switchTab('history')" data-tab="history" aria-label="Order history">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
History
</button>
<button onclick="switchTab('stats')" data-tab="stats" aria-label="Statistics">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
Stats
</button>
</nav>

<!-- New Order Modal -->
<div id="orderModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="orderModalTitle">
<div class="modal" style="position:relative">
<button class="modal-close" onclick="closeModal('orderModal')" aria-label="Close new order form">
<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
</button>
<h2 id="orderModalTitle">New Order</h2>
<div class="form-group">
<label for="custName">Customer Name</label>
<input type="text" id="custName" placeholder="Last name or business" list="custSuggestions" autocomplete="name">
<datalist id="custSuggestions"></datalist>
</div>
<div class="form-group">
<label for="custPhone">Phone Number</label>
<input type="tel" id="custPhone" placeholder="(503) 555-1234" autocomplete="tel">
</div>
<div style="margin-bottom:18px">
<label style="display:block;font-size:12px;font-weight:600;color:var(--muted);margin-bottom:10px;text-transform:uppercase;letter-spacing:0.04em">Items to Sharpen</label>
<div class="item-counter"><label>Knives ($9)</label><button class="counter-btn" onclick="adj('knives',-1)" aria-label="Decrease knife count" type="button">-</button><span class="counter-val" id="cnt-knives">0</span><button class="counter-btn" onclick="adj('knives',1)" aria-label="Increase knife count" type="button">+</button></div>
<div class="item-counter"><label>Scissors ($9)</label><button class="counter-btn" onclick="adj('scissors',-1)" aria-label="Decrease scissors count" type="button">-</button><span class="counter-val" id="cnt-scissors">0</span><button class="counter-btn" onclick="adj('scissors',1)" aria-label="Increase scissors count" type="button">+</button></div>
<div class="item-counter"><label>Hatchets ($10)</label><button class="counter-btn" onclick="adj('hatchets',-1)" aria-label="Decrease hatchet count" type="button">-</button><span class="counter-val" id="cnt-hatchets">0</span><button class="counter-btn" onclick="adj('hatchets',1)" aria-label="Increase hatchet count" type="button">+</button></div>
<div class="item-counter"><label>Axes ($11)</label><button class="counter-btn" onclick="adj('axes',-1)" aria-label="Decrease axe count" type="button">-</button><span class="counter-val" id="cnt-axes">0</span><button class="counter-btn" onclick="adj('axes',1)" aria-label="Increase axe count" type="button">+</button></div>
<div class="item-counter"><label>Mauls ($15)</label><button class="counter-btn" onclick="adj('mauls',-1)" aria-label="Decrease maul count" type="button">-</button><span class="counter-val" id="cnt-mauls">0</span><button class="counter-btn" onclick="adj('mauls',1)" aria-label="Increase maul count" type="button">+</button></div>
<div class="item-counter"><label>Pruners ($9)</label><button class="counter-btn" onclick="adj('pruners',-1)" aria-label="Decrease pruner count" type="button">-</button><span class="counter-val" id="cnt-pruners">0</span><button class="counter-btn" onclick="adj('pruners',1)" aria-label="Increase pruner count" type="button">+</button></div>
</div>
<div style="background:var(--parchment);padding:14px;border-radius:var(--radius-sm);margin-bottom:18px;display:flex;justify-content:space-between;align-items:center">
<span style="font-size:14px;color:var(--muted);font-weight:500">Order Total</span>
<span style="font-size:1.4rem;font-weight:700;color:var(--brass-dark);font-family:var(--font-head)" id="orderTotal">$0</span>
</div>
<div class="form-group">
<label for="orderNotes">Notes (optional)</label>
<textarea id="orderNotes" placeholder="Blade condition, special requests, etc." rows="2"></textarea>
</div>
<div id="orderPhotoArea" style="margin-bottom:18px">
<label style="display:block;font-size:12px;font-weight:600;color:var(--muted);margin-bottom:8px;text-transform:uppercase;letter-spacing:0.04em">Photo (optional)</label>
<div id="orderPhotoPreview" style="display:none;margin-bottom:10px"><img id="orderPhotoImg" style="width:100%;border-radius:var(--radius);max-height:180px;object-fit:cover" alt="Photo of items to sharpen"></div>
<button type="button" class="btn btn-outline btn-block btn-sm" onclick="takeOrderPhoto()">
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"/><circle cx="12" cy="13" r="4"/></svg>
Take a Photo
</button>
<input type="file" id="orderFileInput" accept="image/*" capture="environment" style="display:none" onchange="handleOrderFile(event)" aria-label="Upload photo from device">
</div>
<button class="btn btn-brass btn-block" style="margin-top:10px" onclick="saveOrder()">
<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><polyline points="20 6 9 17 4 12"/></svg>
<span id="saveOrderBtn">Log Order</span>
</button>
</div>
</div>

<!-- Camera Modal -->
<div id="cameraModal" class="modal-overlay" role="dialog" aria-modal="true" aria-label="Take photo">
<div class="modal" style="position:relative;padding:16px">
<button class="modal-close" onclick="stopCam()" aria-label="Close camera" style="z-index:10;background:rgba(0,0,0,0.5);border-radius:50%">
<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" aria-hidden="true"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
</button>
<div class="camera-container">
<video id="camVid" autoplay playsinline aria-label="Camera preview"></video>
<canvas id="camCan" aria-hidden="true"></canvas>
<button class="camera-shutter" onclick="snapPhoto()" aria-label="Take photo"></button>
</div>
<p style="text-align:center;color:var(--muted);font-size:13px;margin-top:10px">Position your items in frame, then tap the button</p>
</div>
</div>

<!-- Order Detail Modal -->
<div id="detailModal" class="modal-overlay" role="dialog" aria-modal="true" aria-label="Order details">
<div class="modal" style="position:relative">
<button class="modal-close" onclick="closeModal('detailModal')" aria-label="Close order details">
<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
</button>
<div id="detailContent"></div>
</div>
</div>

<div class="toast-container" role="status" aria-live="polite" id="toastBox"></div>
</div>

<!-- DEMO DISCLAIMER -->
<div id="bct-demo-disclaimer" role="contentinfo" aria-label="Demo disclaimer" style="position:fixed;bottom:0;left:0;right:0;background:#f8f8f8;border-top:1px solid #ddd;padding:12px 16px;font-size:12px;line-height:1.5;color:#555;z-index:99999;display:flex;flex-wrap:wrap;align-items:center;justify-content:center;gap:10px 20px;text-align:center;">
<p style="margin:0;max-width:700px;"><strong style="color:#333;">DEMO:</strong> This tool was created by BennyCuTools as a demonstration. Not affiliated with Patron Saint of Knives.</p>
<a href="mailto:cuuper225@gmail.com?subject=Delete%20Demo%3A%20Patron%20Saint%20of%20Knives&body=I%20am%20the%20owner%20and%20I%20request%20permanent%20deletion%20of%20this%20demo." style="display:inline-flex;align-items:center;gap:4px;background:#dc3545;color:#fff;padding:6px 14px;border-radius:4px;text-decoration:none;font-size:11px;font-weight:500;white-space:nowrap;transition:background 0.15s">
<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>
Request Removal
</a>
</div>

<script>
function _h(s){let h=0;for(let i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i);h|=0;}return h;}
const _V=460473678;
(function(){
const k=new URLSearchParams(window.location.search).get('key');
if(k&&_h(k)===_V){auth();return;}
document.getElementById('gate').style.display='flex';
document.getElementById('app').style.display='none';
document.getElementById('gate-form').addEventListener('submit',function(e){
e.preventDefault();
const v=document.getElementById('gate-key').value.trim();
if(_h(v)===_V){auth();}else{document.getElementById('gate-key').style.borderColor='#B83A3A';document.getElementById('gate-key').setAttribute('aria-invalid','true');toast('Key does not match. Try again.');}
});
})();
function auth(){document.getElementById('gate').style.display='none';document.getElementById('app').style.display='block';document.addEventListener('contextmenu',e=>e.preventDefault());initApp().catch(e => {console.error('initApp failed:', e); const t=document.createElement('div');t.style.cssText='position:fixed;top:80px;left:50%;transform:translateX(-50%);background:#b91c1c;color:#fff;padding:12px 20px;border-radius:8px;z-index:9999';t.textContent='Error loading data. Please refresh.';document.body.appendChild(t);setTimeout(()=>t.remove(),3000);});}

let db;const DB='bladeboard_db';
function openDB(){return new Promise((res,rej)=>{const r=indexedDB.open(DB,1);r.onupgradeneeded=e=>{const d=e.target.result;if(!d.objectStoreNames.contains('orders'))d.createObjectStore('orders',{keyPath:'id'});};r.onsuccess=e=>{db=e.target.result;res();};r.onerror=rej;});}
function put(d){return new Promise((r,j)=>{const t=db.transaction('orders','readwrite');t.objectStore('orders').put(d);t.oncomplete=()=>r();t.onerror=j;});}
function getAll(){return new Promise((r,j)=>{const t=db.transaction('orders','readonly');const q=t.objectStore('orders').getAll();q.onsuccess=()=>r(q.result);q.onerror=j;});}
function del(id){return new Promise((r,j)=>{const t=db.transaction('orders','readwrite');t.objectStore('orders').delete(id);t.oncomplete=()=>r();t.onerror=j;});}

let orders=[];let currentFilter='all';let editId=null;let orderPhoto=null;let camStream=null;
const PRICES={knives:9,scissors:9,hatchets:10,axes:11,mauls:15,pruners:9};
const TYPES=['knives','scissors','hatchets','axes','mauls','pruners'];
const STATUSES=['received','progress','ready','notified','picked'];
const STATUS_LABELS={received:'Received',progress:'In Progress',ready:'Ready',notified:'Notified',picked:'Picked Up'};
let counts={knives:0,scissors:0,hatchets:0,axes:0,mauls:0,pruners:0};

async function initApp(){
await openDB();
if(!localStorage.getItem('bb_init')){await loadDemo();localStorage.setItem('bb_init','1');}
await refresh();
}

async function loadDemo(){
const now=Date.now();
const demos=[
{id:'d1',name:'Johnson',phone:'(702) 555-0142',items:{knives:8,scissors:1,hatchets:0,axes:0,mauls:0,pruners:0},total:81,notes:'Wusthof classics. Handle with care.',status:'progress',photo:null,createdAt:new Date(now-7200000).toISOString(),isDemo:true},
{id:'d2',name:'Sakana Sushi',phone:'(702) 555-0198',items:{knives:12,scissors:0,hatchets:0,axes:0,mauls:0,pruners:0},total:108,notes:'Chef knives for the line. Regular monthly pickup.',status:'ready',photo:null,createdAt:new Date(now-14400000).toISOString(),isDemo:true},
{id:'d3',name:'Chen',phone:'(702) 555-0276',items:{knives:0,scissors:0,hatchets:1,axes:2,mauls:0,pruners:0},total:32,notes:'Camping gear. Small chips on the axe.',status:'received',photo:null,createdAt:new Date(now-3600000).toISOString(),isDemo:true},
{id:'d4',name:'Wilkins',phone:'(702) 555-0334',items:{knives:4,scissors:2,hatchets:0,axes:0,mauls:0,pruners:3},total:81,notes:'Kitchen set plus garden tools.',status:'notified',photo:null,createdAt:new Date(now-28800000).toISOString(),isDemo:true},
{id:'d5',name:'Vegas Butcher Co',phone:'(702) 555-0411',items:{knives:6,scissors:0,hatchets:0,axes:0,mauls:0,pruners:0},total:54,notes:'Butcher knives. Convex edge requested.',status:'picked',photo:null,createdAt:new Date(now-86400000).toISOString(),isDemo:true},
];
for(const d of demos)await put(d);
}

async function clearDemo(){
const all=await getAll();
for(const o of all){if(o.isDemo)await del(o.id);}
document.getElementById('demoBanner').style.display='none';
toast('Sample orders cleared');
await refresh();
}

async function refresh(){
orders=await getAll();
renderBoard();renderHistory();renderStats();
const hasDemo=orders.some(o=>o.isDemo);
document.getElementById('demoBanner').style.display=hasDemo?'flex':'none';
const active=orders.filter(o=>o.status!=='picked');
document.getElementById('headerStats').innerHTML=`<span><strong>${active.length}</strong> active</span>`;
}

function renderBoard(){
const active=orders.filter(o=>o.status!=='picked');
const filtered=currentFilter==='all'?active:active.filter(o=>o.status===currentFilter);
const el=document.getElementById('ordersList');
const empty=document.getElementById('boardEmpty');

// Summary
const received=active.filter(o=>o.status==='received').length;
const progress=active.filter(o=>o.status==='progress').length;
const ready=active.filter(o=>o.status==='ready'||o.status==='notified').length;
const totalBlades=active.reduce((s,o)=>s+countBlades(o),0);
document.getElementById('todaySummary').innerHTML=`
<div class="summary-item"><div class="val">${active.length}</div><div class="lbl">Orders</div></div>
<div class="summary-item"><div class="val">${totalBlades}</div><div class="lbl">Blades</div></div>
<div class="summary-item"><div class="val">$${active.reduce((s,o)=>s+o.total,0)}</div><div class="lbl">Value</div></div>
<div class="summary-item"><div class="val">${ready}</div><div class="lbl">Ready</div></div>`;

// Filters
const counts_f={all:active.length,received,progress,ready:active.filter(o=>o.status==='ready').length,notified:active.filter(o=>o.status==='notified').length};
document.getElementById('filterRow').innerHTML=['all','received','progress','ready','notified'].map(f=>`<button class="filter-pill${currentFilter===f?' active':''}" onclick="setFilter('${f}')" role="tab" aria-selected="${currentFilter===f}" aria-label="Show ${f==='all'?'all orders':STATUS_LABELS[f]+' orders'}">${f==='all'?'All':STATUS_LABELS[f]} (${counts_f[f]||0})</button>`).join('');

if(filtered.length===0){empty.style.display='block';el.innerHTML='';return;}
empty.style.display='none';
const sorted=[...filtered].sort((a,b)=>STATUSES.indexOf(a.status)-STATUSES.indexOf(b.status)||new Date(b.createdAt)-new Date(a.createdAt));
el.innerHTML='<div class="card">'+sorted.map(o=>{
const blades=countBlades(o);
const ago=timeAgo(new Date(o.createdAt));
const sc='status-'+o.status;
return `<div class="order-card" onclick="showDetail('${o.id}')" role="button" tabindex="0" onkeydown="if(event.key==='Enter')showDetail('${o.id}')" aria-label="${esc(o.name)}: ${blades} blades, ${STATUS_LABELS[o.status]}">
<div class="order-photo">${o.photo?`<img src="${o.photo}" alt="" loading="lazy">`:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true"><path d="M14.5 3L3 14.5V21h6.5L21 9.5"/><path d="M14 4l6 6"/></svg>`}</div>
<div class="order-info">
<h3>${esc(o.name)}</h3>
<p>${blades} blade${blades!==1?'s':''}${o.notes?' — '+esc(o.notes.slice(0,38))+(o.notes.length>38?'...':'):''}</p>
<span class="status-badge ${sc}">${STATUS_LABELS[o.status]}</span>
</div>
<div class="order-right">
<div class="order-price">$${o.total}</div>
<div class="order-time">${ago}</div>
</div>
</div>`;}).join('')+'</div>';
}

function renderHistory(){
const picked=orders.filter(o=>o.status==='picked');
const el=document.getElementById('historyList');
const empty=document.getElementById('historyEmpty');
if(picked.length===0){empty.style.display='block';el.innerHTML='';return;}
empty.style.display='none';
const sorted=[...picked].sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt));
el.innerHTML='<div class="card">'+sorted.map(o=>{
const blades=countBlades(o);
return `<div class="order-card" style="opacity:0.75" onclick="showDetail('${o.id}')" role="button" tabindex="0" onkeydown="if(event.key==='Enter')showDetail('${o.id}')" aria-label="${esc(o.name)}: ${blades} blades, picked up">
<div class="order-photo"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true" style="color:var(--muted)"><polyline points="20 6 9 17 4 12"/></svg></div>
<div class="order-info"><h3>${esc(o.name)}</h3><p>${blades} blades · Picked up</p></div>
<div class="order-right"><div class="order-price">$${o.total}</div><div class="order-time">${timeAgo(new Date(o.createdAt))}</div></div>
</div>`;}).join('')+'</div>';
}

function renderStats(){
const now=new Date();const weekStart=new Date(now);weekStart.setDate(now.getDate()-now.getDay());weekStart.setHours(0,0,0,0);
const weekOrders=orders.filter(o=>new Date(o.createdAt)>=weekStart);
const weekBlades=weekOrders.reduce((s,o)=>s+countBlades(o),0);
const weekRev=weekOrders.reduce((s,o)=>s+o.total,0);
document.getElementById('weekStats').innerHTML=`
<div class="summary-item"><div class="val">${weekOrders.length}</div><div class="lbl">Orders</div></div>
<div class="summary-item"><div class="val">${weekBlades}</div><div class="lbl">Blades</div></div>
<div class="summary-item"><div class="val">$${weekRev}</div><div class="lbl">Revenue</div></div>`;
const allBlades=orders.reduce((s,o)=>s+countBlades(o),0);
const allRev=orders.reduce((s,o)=>s+o.total,0);
document.getElementById('allStats').innerHTML=`
<div class="summary-item"><div class="val">${orders.length}</div><div class="lbl">Orders</div></div>
<div class="summary-item"><div class="val">${allBlades}</div><div class="lbl">Blades</div></div>
<div class="summary-item"><div class="val">$${allRev}</div><div class="lbl">Revenue</div></div>`;
}

function countBlades(o){return TYPES.reduce((s,t)=>s+(o.items[t]||0),0);}

function setFilter(f){currentFilter=f;renderBoard();}

// New/Edit Order
function showNewOrder(){
editId=null;orderPhoto=null;
document.getElementById('orderModalTitle').textContent='New Order';
document.getElementById('saveOrderBtn').textContent='Log Order';
document.getElementById('custName').value='';
document.getElementById('custPhone').value='';
document.getElementById('orderNotes').value='';
document.getElementById('orderPhotoPreview').style.display='none';
TYPES.forEach(t=>{counts[t]=0;document.getElementById('cnt-'+t).textContent='0';});
updateTotal();
// Customer suggestions
const names=[...new Set(orders.map(o=>o.name))];
const dl=document.getElementById('custSuggestions');
dl.innerHTML=names.map(n=>`<option value="${esc(n)}">`).join('');
document.getElementById('orderModal').classList.add('show');
document.getElementById('custName').focus();
}

function adj(type,d){
counts[type]=Math.max(0,counts[type]+d);
document.getElementById('cnt-'+type).textContent=counts[type];
updateTotal();
}

function updateTotal(){
const total=TYPES.reduce((s,t)=>s+counts[t]*PRICES[t],0);
document.getElementById('orderTotal').textContent='$'+total;
}

async function saveOrder(){
const name=document.getElementById('custName').value.trim();
const phone=document.getElementById('custPhone').value.trim();
const notes=document.getElementById('orderNotes').value.trim();
if(!name){toast('Add a customer name');document.getElementById('custName').focus();return;}
const total=TYPES.reduce((s,t)=>s+counts[t]*PRICES[t],0);
if(total===0){toast('Add at least one item');return;}

if(editId){
const o=orders.find(o=>o.id===editId);
if(o){o.name=name;o.phone=phone;o.items={...counts};o.total=total;o.notes=notes;if(orderPhoto)o.photo=orderPhoto;await put(o);}
}else{
const order={id:'o'+Date.now(),name,phone,items:{...counts},total,notes,photo:orderPhoto,status:'received',createdAt:new Date().toISOString(),isDemo:false};
await put(order);
}
closeModal('orderModal');
toast(editId?'Order updated':'Order logged: $'+total);
editId=null;orderPhoto=null;
await refresh();
}

function showDetail(id){
const o=orders.find(o=>o.id===id);if(!o)return;
const blades=countBlades(o);
const items=TYPES.filter(t=>o.items[t]>0).map(t=>`${o.items[t]} ${t}`).join(', ');
const si=STATUSES.indexOf(o.status);
const nextStatus=si<STATUSES.length-1?STATUSES[si+1]:null;

let html=`<h2 style="padding-right:40px">${esc(o.name)}</h2>`;
if(o.photo)html+=`<img src="${o.photo}" style="width:100%;border-radius:var(--radius);margin:14px 0;max-height:220px;object-fit:cover" alt="Photo of ${esc(o.name)}'s items" loading="lazy">`;
html+=`<p style="color:var(--muted);font-size:14px;margin-bottom:6px">${o.phone||'No phone on file'}</p>`;
html+=`<p style="margin-bottom:6px;font-size:15px"><strong>${blades} blades:</strong> ${items}</p>`;
if(o.notes)html+=`<p style="font-size:14px;color:var(--muted);margin-bottom:12px;line-height:1.5">${esc(o.notes)}</p>`;
html+=`<div style="display:flex;justify-content:space-between;align-items:center;margin:14px 0">`;
html+=`<span class="status-badge status-${o.status}" style="font-size:12px;padding:5px 12px">${STATUS_LABELS[o.status]}</span>`;
html+=`<span style="font-size:1.4rem;font-weight:700;color:var(--brass-dark);font-family:var(--font-head)">$${o.total}</span>`;
html+=`</div>`;
html+=`<div style="display:flex;flex-direction:column;gap:10px;margin-top:18px">`;
if(nextStatus){
html+=`<button class="btn btn-brass btn-block" onclick="advanceStatus('${o.id}')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><polyline points="20 6 9 17 4 12"/></svg> Mark as ${STATUS_LABELS[nextStatus]}</button>`;
}
if(o.status==='ready'||o.status==='notified'){
html+=`<button class="btn btn-dark btn-block" onclick="notifyCustomer('${o.id}')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M22 2L11 13"/><path d="M22 2L15 22l-4-9-9-4z"/></svg> Copy Pickup Message</button>`;
}
html+=`<button class="btn btn-outline btn-block" onclick="editOrder('${o.id}')">Edit Order</button>`;
html+=`<button class="btn btn-outline btn-block" style="color:var(--error);border-color:var(--error)" onclick="deleteOrder('${o.id}')">Delete Order</button>`;
html+=`</div>`;
document.getElementById('detailContent').innerHTML=html;
document.getElementById('detailModal').classList.add('show');
}

async function advanceStatus(id){
const o=orders.find(o=>o.id===id);if(!o)return;
const si=STATUSES.indexOf(o.status);
if(si<STATUSES.length-1){o.status=STATUSES[si+1];await put(o);toast('Status: '+STATUS_LABELS[o.status]);closeModal('detailModal');await refresh();}
}

function notifyCustomer(id){
const o=orders.find(o=>o.id===id);if(!o)return;
const blades=countBlades(o);
const text=`Hi ${o.name}, your ${blades} blade${blades!==1?'s':''} ${blades===1?'is':'are'} sharpened and ready for pickup at the locker. Total: $${o.total}. — Patron Saint of Knives`;
if(navigator.share){
navigator.share({text}).catch(()=>copyText(text));
}else{copyText(text);}
}

function copyText(t){navigator.clipboard.writeText(t).then(()=>toast('Message copied — paste into your texts')).catch(()=>toast('Could not copy to clipboard'));}

function editOrder(id){
const o=orders.find(o=>o.id===id);if(!o)return;
editId=id;
closeModal('detailModal');
document.getElementById('orderModalTitle').textContent='Edit Order';
document.getElementById('saveOrderBtn').textContent='Save Changes';
document.getElementById('custName').value=o.name;
document.getElementById('custPhone').value=o.phone||'';
document.getElementById('orderNotes').value=o.notes||'';
TYPES.forEach(t=>{counts[t]=o.items[t]||0;document.getElementById('cnt-'+t).textContent=counts[t];});
updateTotal();
if(o.photo){orderPhoto=o.photo;document.getElementById('orderPhotoImg').src=o.photo;document.getElementById('orderPhotoPreview').style.display='block';}
else{orderPhoto=null;document.getElementById('orderPhotoPreview').style.display='none';}
document.getElementById('orderModal').classList.add('show');
setTimeout(()=>document.getElementById('custName').focus(),100);
}

async function deleteOrder(id){
if(!confirm('Delete this order? This cannot be undone.'))return;
await del(id);toast('Order deleted');closeModal('detailModal');await refresh();
}

// Camera
function takeOrderPhoto(){
if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){
navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'}}).then(s=>{
camStream=s;document.getElementById('camVid').srcObject=s;document.getElementById('cameraModal').classList.add('show');
}).catch(()=>document.getElementById('orderFileInput').click());
}else{document.getElementById('orderFileInput').click();}
}

function snapPhoto(){
const v=document.getElementById('camVid');const c=document.getElementById('camCan');
c.width=v.videoWidth;c.height=v.videoHeight;c.getContext('2d').drawImage(v,0,0);
orderPhoto=c.toDataURL('image/jpeg',0.7);
document.getElementById('orderPhotoImg').src=orderPhoto;document.getElementById('orderPhotoPreview').style.display='block';
stopCam();toast('Photo added');
}

function stopCam(){if(camStream){camStream.getTracks().forEach(t=>t.stop());camStream=null;}closeModal('cameraModal');}

function handleOrderFile(e){
const f=e.target.files[0];if(!f)return;
const r=new FileReader();r.onload=ev=>{orderPhoto=ev.target.result;document.getElementById('orderPhotoImg').src=orderPhoto;document.getElementById('orderPhotoPreview').style.display='block';toast('Photo added');};
r.readAsDataURL(f);e.target.value='';
}

// Tabs
function switchTab(t){
document.querySelectorAll('.tab-content').forEach(el=>el.classList.remove('active'));
document.getElementById('tab-'+t).classList.add('active');
document.querySelectorAll('.bottom-nav button').forEach(b=>{b.classList.toggle('active',b.dataset.tab===t);b.setAttribute('aria-current',b.dataset.tab===t?'page':'false');});
document.getElementById('addFab').style.display=t==='board'?'flex':'none';
}

function closeModal(id){document.getElementById(id).classList.remove('show');}
function toast(m){const c=document.getElementById('toastBox');const t=document.createElement('div');t.className='toast';t.textContent=m;c.appendChild(t);setTimeout(()=>{t.style.opacity='0';t.style.transition='opacity 0.3s';setTimeout(()=>t.remove(),300);},2800);}
function esc(s){const d=document.createElement('div');d.textContent=s;return d.innerHTML;}
function timeAgo(d){const s=Math.floor((Date.now()-d)/1000);if(s<60)return 'just now';if(s<3600)return Math.floor(s/60)+'m ago';if(s<86400)return Math.floor(s/3600)+'h ago';if(s<604800)return Math.floor(s/86400)+'d ago';return Math.floor(s/604800)+'w ago';}
</script>
</body>
</html>