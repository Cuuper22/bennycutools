<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>WellLog - Magill Drilling</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Archivo:wght@500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
/* ===== Design Tokens ===== */
:root{
  /* Colors */
  --primary: #2B6CB0;
  --primary-light: #4299E1;
  --primary-dark: #1A4A7A;
  --primary-50: #EBF4FF;
  --secondary: #4A3728;
  --surface: #F5F1E8;
  --surface-elevated: #FFFFFF;
  --white: #FFFFFF;
  --success: #38A169;
  --success-50: #F0FFF4;
  --error: #C53030;
  --error-50: #FFF5F5;
  --warning: #D69E2E;
  --warning-50: #FFFAF0;
  --text: #2D2D2D;
  --text-secondary: #4A5568;
  --text-muted: #718096;
  --text-placeholder: #A0AEC0;
  --border: #DDD6C8;
  --border-light: #E8E4DA;
  
  /* Spacing Scale (8px base) */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;
  --space-8: 32px;
  --space-10: 40px;
  --space-12: 48px;
  
  /* Typography */
  --font-heading: 'Archivo', system-ui, sans-serif;
  --font-body: 'Inter', system-ui, sans-serif;
  --text-xs: 0.75rem;
  --text-sm: 0.8125rem;
  --text-base: 0.9375rem;
  --text-lg: 1.0625rem;
  --text-xl: 1.25rem;
  --text-2xl: 1.5rem;
  
  /* Effects */
  --shadow-sm: 0 1px 2px rgba(42, 55, 40, 0.05);
  --shadow: 0 4px 6px -1px rgba(42, 55, 40, 0.08), 0 2px 4px -1px rgba(42, 55, 40, 0.04);
  --shadow-md: 0 8px 16px -4px rgba(42, 55, 40, 0.1), 0 4px 8px -2px rgba(42, 55, 40, 0.06);
  --shadow-lg: 0 12px 24px -6px rgba(42, 55, 40, 0.12), 0 6px 12px -3px rgba(42, 55, 40, 0.08);
  --radius-sm: 6px;
  --radius: 10px;
  --radius-lg: 14px;
  
  /* Motion */
  --duration-fast: 120ms;
  --duration-normal: 200ms;
  --duration-slow: 300ms;
  --easing: cubic-bezier(0.4, 0, 0.2, 1);
  --easing-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* ===== Reset ===== */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: 16px;
  -webkit-tap-highlight-color: transparent;
  scroll-behavior: smooth;
}

body { padding-bottom: 80px;
  font-family: var(--font-body);
  font-size: var(--text-base);
  line-height: 1.5;
  background: var(--surface);
  color: var(--text);
  min-height: 100dvh;
  padding-bottom: calc(80px + env(safe-area-inset-bottom, 0));
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ===== Typography ===== */
h1, h2, h3 {
  font-family: var(--font-heading);
  font-weight: 600;
  line-height: 1.25;
  letter-spacing: -0.01em;
}

/* ===== Accessibility ===== */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.skip-link {
  position: absolute;
  top: -100%;
  left: var(--space-4);
  background: var(--primary);
  color: var(--white);
  padding: var(--space-2) var(--space-4);
  border-radius: var(--radius);
  z-index: 10000;
  font-size: var(--text-sm);
  font-weight: 500;
  text-decoration: none;
  transition: top var(--duration-fast) var(--easing);
}

.skip-link:focus {
  top: var(--space-3);
}

/* ===== Focus Management ===== */
:focus-visible {
  outline: 2.5px solid var(--primary);
  outline-offset: 2px;
}

button:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible,
[tabindex]:focus-visible {
  outline: 2.5px solid var(--primary);
  outline-offset: 2px;
}

/* ===== Gate Screen ===== */
#gate {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100dvh;
  background: linear-gradient(160deg, #1A2332 0%, #2D3748 100%);
  color: var(--white);
  text-align: center;
  padding: var(--space-6);
}

#gate-content {
  max-width: 320px;
}

#gate h1 {
  font-size: var(--text-2xl);
  margin-bottom: var(--space-3);
  font-weight: 700;
}

#gate p {
  color: rgba(255, 255, 255, 0.65);
  font-size: var(--text-base);
  margin-bottom: var(--space-5);
  line-height: 1.6;
}

#gate a {
  color: var(--primary-light);
  text-decoration: none;
  font-weight: 500;
}

#gate a:hover,
#gate a:focus {
  text-decoration: underline;
}

/* ===== App Container ===== */
#app {
  display: none;
}

/* ===== Header ===== */
.app-header {
  background: linear-gradient(135deg, #1A2332, var(--primary-dark));
  color: var(--white);
  padding: var(--space-4) var(--space-5);
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: var(--shadow);
}

.app-header h1 {
  font-size: 1.1rem;
  font-weight: 700;
  letter-spacing: 0.02em;
}

.app-header p {
  font-size: var(--text-xs);
  color: rgba(255, 255, 255, 0.6);
  margin-top: var(--space-1);
  font-weight: 400;
}

/* ===== Demo Banner ===== */
.demo-banner {
  background: linear-gradient(90deg, var(--primary), var(--primary-dark));
  color: var(--white);
  padding: var(--space-3) var(--space-4);
  font-size: var(--text-sm);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
  animation: slideDown var(--duration-slow) var(--easing);
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-100%);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.demo-banner button {
  background: rgba(255, 255, 255, 0.2);
  color: var(--white);
  padding: var(--space-1) var(--space-3);
  border-radius: var(--radius-sm);
  font-size: var(--text-xs);
  font-weight: 500;
  border: none;
  cursor: pointer;
  transition: background var(--duration-fast) var(--easing);
  flex-shrink: 0;
}

.demo-banner button:hover {
  background: rgba(255, 255, 255, 0.3);
}

.demo-banner button:active {
  transform: scale(0.96);
}

/* ===== Main Content ===== */
.content {
  padding: var(--space-4);
  max-width: 640px;
  margin: 0 auto;
}

/* ===== Cards ===== */
.card {
  background: var(--surface-elevated);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  padding: var(--space-4);
  margin-bottom: var(--space-3);
  animation: fadeUp var(--duration-slow) var(--easing) both;
  transition: transform var(--duration-normal) var(--easing),
              box-shadow var(--duration-normal) var(--easing);
}

.card:hover {
  box-shadow: var(--shadow-md);
}

@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.card h3 {
  font-size: var(--text-base);
  font-weight: 600;
  margin-bottom: var(--space-3);
  color: var(--text);
}

/* ===== Views ===== */
.view {
  display: none;
}

.view.active {
  display: block;
  animation: fadeIn var(--duration-normal) var(--easing);
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ===== Form Elements ===== */
.form-group {
  margin-bottom: var(--space-4);
}

.form-group label {
  display: block;
  font-size: var(--text-xs);
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: var(--space-2);
  text-transform: uppercase;
  letter-spacing: 0.03em;
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: var(--space-3) var(--space-4);
  border: 1.5px solid var(--border);
  border-radius: var(--radius);
  background: var(--white);
  font-size: var(--text-base);
  color: var(--text);
  transition: border-color var(--duration-fast) var(--easing),
              box-shadow var(--duration-fast) var(--easing);
}

.form-group input::placeholder,
.form-group textarea::placeholder {
  color: var(--text-placeholder);
}

.form-group input:hover,
.form-group select:hover,
.form-group textarea:hover {
  border-color: var(--border-light);
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px var(--primary-50);
}

.form-group input[aria-invalid="true"],
.form-group select[aria-invalid="true"] {
  border-color: var(--error);
  background: var(--error-50);
}

.form-group input[aria-invalid="true"]:focus,
.form-group select[aria-invalid="true"]:focus {
  box-shadow: 0 0 0 3px rgba(197, 48, 48, 0.15);
}

.form-group textarea {
  resize: vertical;
  min-height: 80px;
}

/* Helper text */
.form-help {
  font-size: var(--text-xs);
  color: var(--text-muted);
  margin-top: var(--space-2);
}

.form-error {
  font-size: var(--text-xs);
  color: var(--error);
  margin-top: var(--space-2);
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

/* ===== Buttons ===== */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  padding: var(--space-3) var(--space-5);
  border-radius: var(--radius);
  font-size: var(--text-sm);
  font-weight: 600;
  border: none;
  cursor: pointer;
  transition: transform var(--duration-fast) var(--easing),
              background var(--duration-fast) var(--easing),
              box-shadow var(--duration-fast) var(--easing);
  position: relative;
  overflow: hidden;
}

.btn::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(255,255,255,0.15) 0%, transparent 100%);
  pointer-events: none;
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: scale(0.97);
}

.btn-primary {
  background: var(--primary);
  color: var(--white);
  box-shadow: var(--shadow);
}

.btn-primary:hover {
  background: var(--primary-dark);
  box-shadow: var(--shadow-md);
}

.btn-outline {
  background: var(--white);
  color: var(--text);
  border: 1.5px solid var(--border);
}

.btn-outline:hover {
  background: var(--surface);
  border-color: var(--border-light);
}

.btn-danger {
  background: var(--error);
  color: var(--white);
}

.btn-danger:hover {
  background: #9B2C2C;
}

.btn-success {
  background: var(--success);
  color: var(--white);
}

.btn-success:hover {
  background: #276749;
}

.btn-block {
  width: 100%;
}

.btn-sm {
  padding: var(--space-2) var(--space-3);
  font-size: var(--text-xs);
}

/* Loading state */
.btn-loading {
  position: relative;
  color: transparent !important;
}

.btn-loading::before {
  content: '';
  position: absolute;
  width: 18px;
  height: 18px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-top-color: var(--white);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Text button */
.btn-text {
  background: transparent;
  color: var(--primary);
  padding: var(--space-2) var(--space-3);
  font-weight: 500;
}

.btn-text:hover {
  background: var(--primary-50);
  transform: none;
}

/* ===== FAB ===== */
.fab {
  position: fixed;
  bottom: calc(72px + env(safe-area-inset-bottom, 0));
  right: var(--space-4);
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: var(--primary);
  color: var(--white);
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: var(--shadow-lg);
  z-index: 90;
  transition: transform var(--duration-normal) var(--easing-bounce),
              box-shadow var(--duration-normal) var(--easing);
  border: none;
  cursor: pointer;
}

.fab:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 24px rgba(43, 108, 176, 0.4);
}

.fab:active {
  transform: scale(0.92);
}

.fab svg {
  transition: transform var(--duration-normal) var(--easing);
}

.fab:hover svg {
  transform: rotate(90deg);
}

/* ===== Bottom Navigation ===== */
.bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--surface-elevated);
  border-top: 1px solid var(--border);
  display: flex;
  z-index: 99;
  padding-bottom: env(safe-area-inset-bottom, 0);
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
}

.bottom-nav button {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--space-2) 0 var(--space-2);
  font-size: 11px;
  color: var(--text-muted);
  transition: color var(--duration-fast) var(--easing);
  border: none;
  background: transparent;
  cursor: pointer;
  position: relative;
}

.bottom-nav button::before {
  content: '';
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%) scaleX(0);
  width: 40px;
  height: 3px;
  background: var(--primary);
  border-radius: 0 0 3px 3px;
  transition: transform var(--duration-normal) var(--easing);
}

.bottom-nav button.active {
  color: var(--primary);
}

.bottom-nav button.active::before {
  transform: translateX(-50%) scaleX(1);
}

.bottom-nav button svg {
  width: 22px;
  height: 22px;
  margin-bottom: 2px;
  stroke-width: 1.8;
  transition: transform var(--duration-fast) var(--easing);
}

.bottom-nav button.active svg {
  transform: translateY(-2px);
}

/* ===== Well Cards ===== */
.well-card {
  cursor: pointer;
  border-left: 4px solid var(--primary);
  transition: transform var(--duration-normal) var(--easing),
              box-shadow var(--duration-normal) var(--easing);
}

.well-card:hover {
  transform: translateX(4px);
  border-left-color: var(--primary-light);
}

.well-card h3 {
  font-size: var(--text-base);
  margin: var(--space-1) 0;
  color: var(--text);
}

.well-card .well-stats {
  display: flex;
  gap: var(--space-5);
  flex-wrap: wrap;
  margin-top: var(--space-3);
}

.well-card .stat {
  text-align: center;
}

.well-card .stat-value {
  font-family: var(--font-heading);
  font-size: 1.125rem;
  font-weight: 700;
  color: var(--primary);
  line-height: 1.2;
}

.well-card .stat-label {
  font-size: 10px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.04em;
  margin-top: 2px;
}

.well-meta {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-xs);
  color: var(--text-muted);
}

.well-meta .well-layers {
  color: var(--primary);
  font-weight: 600;
}

/* ===== Geology Column ===== */
.geo-column {
  margin: var(--space-3) 0;
  border-left: 3px solid var(--border);
  padding-left: var(--space-3);
}

.geo-layer {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-2) 0;
  border-bottom: 1px solid var(--border-light);
  font-size: var(--text-sm);
}

.geo-layer:last-child {
  border-bottom: none;
}

.geo-layer .depth {
  font-weight: 600;
  min-width: 70px;
  color: var(--primary);
  font-family: var(--font-heading);
  font-size: var(--text-sm);
}

.geo-layer .formation {
  flex: 1;
  color: var(--text);
}

.geo-layer button {
  color: var(--text-muted);
  padding: var(--space-2);
  background: transparent;
  border: none;
  cursor: pointer;
  border-radius: var(--radius-sm);
  transition: color var(--duration-fast) var(--easing),
              background var(--duration-fast) var(--easing);
}

.geo-layer button:hover {
  color: var(--error);
  background: var(--error-50);
}

/* ===== Voice Input ===== */
.voice-btn {
  width: 100%;
  padding: var(--space-4);
  border-radius: var(--radius);
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: var(--white);
  font-size: var(--text-base);
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-3);
  transition: transform var(--duration-fast) var(--easing),
              box-shadow var(--duration-normal) var(--easing);
  border: none;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.voice-btn::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(255,255,255,0.15) 0%, transparent 100%);
  pointer-events: none;
}

.voice-btn:hover {
  transform: translateY(-1px);
  box-shadow: var(--shadow-md);
}

.voice-btn:active {
  transform: scale(0.98);
}

.voice-btn.recording {
  background: linear-gradient(135deg, var(--error), #9B2C2C);
  animation: pulse-record 1.5s ease-in-out infinite;
}

@keyframes pulse-record {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(197, 48, 48, 0.5);
  }
  50% {
    box-shadow: 0 0 0 12px rgba(197, 48, 48, 0);
  }
}

.voice-result {
  background: var(--surface);
  border-radius: var(--radius);
  padding: var(--space-3);
  margin-top: var(--space-3);
  font-size: var(--text-sm);
  color: var(--text-secondary);
  min-height: 48px;
  border: 1px dashed var(--border);
  transition: border-color var(--duration-fast) var(--easing);
}

.voice-result:empty::before {
  content: 'Speak to fill in well data...';
  color: var(--text-placeholder);
}

.voice-result.has-content {
  border-style: solid;
  border-color: var(--success);
  background: var(--success-50);
}

/* ===== Photo Grid ===== */
.photo-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-2);
  margin: var(--space-3) 0;
}

.photo-grid .photo-cell {
  aspect-ratio: 1;
  border-radius: var(--radius);
  overflow: hidden;
  position: relative;
  background: var(--surface);
  transition: transform var(--duration-fast) var(--easing);
}

.photo-grid .photo-cell:hover {
  transform: scale(1.02);
}

.photo-grid .photo-cell img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform var(--duration-slow) var(--easing);
}

.photo-grid .photo-cell:hover img {
  transform: scale(1.05);
}

.photo-grid .add-photo {
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px dashed var(--border);
  cursor: pointer;
  background: var(--surface);
  transition: border-color var(--duration-fast) var(--easing),
              background var(--duration-fast) var(--easing);
}

.photo-grid .add-photo:hover,
.photo-grid .add-photo:focus {
  border-color: var(--primary);
  background: var(--primary-50);
}

.photo-grid .add-photo:active {
  transform: scale(0.95);
}

.photo-remove {
  position: absolute;
  top: var(--space-1);
  right: var(--space-1);
  background: rgba(0, 0, 0, 0.6);
  color: var(--white);
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  cursor: pointer;
  transition: background var(--duration-fast) var(--easing),
              transform var(--duration-fast) var(--easing);
}

.photo-remove:hover {
  background: var(--error);
  transform: scale(1.1);
}

/* ===== Upsell Card ===== */
.upsell-card {
  background: linear-gradient(135deg, var(--surface), #E8E0D4);
  border: 1.5px dashed var(--border);
  opacity: 0.85;
  text-align: center;
  padding: var(--space-6);
}

.upsell-card h3 {
  color: var(--text-secondary);
  font-size: var(--text-base);
  margin-bottom: var(--space-3);
}

.upsell-badge {
  display: inline-block;
  background: var(--primary);
  color: var(--white);
  font-size: 10px;
  padding: 3px 10px;
  border-radius: 10px;
  font-weight: 600;
  margin-left: var(--space-2);
  letter-spacing: 0.02em;
}

.upsell-card p {
  font-size: var(--text-sm);
  color: var(--text-muted);
  line-height: 1.5;
}

/* ===== Back Button ===== */
.back-btn {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  color: var(--text-muted);
  font-size: var(--text-sm);
  margin-bottom: var(--space-3);
  cursor: pointer;
  background: transparent;
  border: none;
  padding: var(--space-2) 0;
  font-weight: 500;
  transition: color var(--duration-fast) var(--easing);
}

.back-btn:hover,
.back-btn:focus {
  color: var(--primary);
}

.back-btn svg {
  transition: transform var(--duration-fast) var(--easing);
}

.back-btn:hover svg {
  transform: translateX(-3px);
}

/* ===== Camera Overlay ===== */
.camera-overlay {
  position: fixed;
  inset: 0;
  background: #000;
  z-index: 10001;
  display: none;
}

.camera-overlay.active {
  display: flex;
  flex-direction: column;
}

.camera-overlay video {
  flex: 1;
  width: 100%;
  object-fit: cover;
}

.camera-overlay .controls {
  padding: var(--space-6);
  display: flex;
  justify-content: center;
  align-items: center;
  gap: var(--space-6);
  background: linear-gradient(transparent, rgba(0,0,0,0.5));
}

.camera-overlay .shutter {
  width: 72px;
  height: 72px;
  border-radius: 50%;
  background: var(--white);
  border: 4px solid rgba(255, 255, 255, 0.4);
  cursor: pointer;
  transition: transform var(--duration-fast) var(--easing),
              background var(--duration-fast) var(--easing);
}

.camera-overlay .shutter:hover {
  transform: scale(1.05);
  background: #f0f0f0;
}

.camera-overlay .shutter:active {
  transform: scale(0.95);
  background: #e0e0e0;
}

.camera-overlay .close-cam {
  position: absolute;
  top: var(--space-4);
  right: var(--space-4);
  color: var(--white);
  background: rgba(0, 0, 0, 0.5);
  width: 44px;
  height: 44px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  cursor: pointer;
  backdrop-filter: blur(4px);
  transition: background var(--duration-fast) var(--easing);
}

.camera-overlay .close-cam:hover {
  background: rgba(0, 0, 0, 0.7);
}

/* ===== Toast Notifications ===== */
.toast-container {
  position: fixed;
  top: var(--space-4);
  left: 50%;
  transform: translateX(-50%);
  z-index: 10000;
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  pointer-events: none;
}

.toast {
  background: #1A2332;
  color: var(--white);
  padding: var(--space-3) var(--space-5);
  border-radius: var(--radius-lg);
  font-size: var(--text-sm);
  box-shadow: var(--shadow-lg);
  animation: toastIn var(--duration-normal) var(--easing-bounce);
  pointer-events: auto;
  max-width: 90vw;
  text-align: center;
}

@keyframes toastIn {
  from {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.toast.toast-out {
  animation: toastOut var(--duration-fast) var(--easing) forwards;
}

@keyframes toastOut {
  to {
    opacity: 0;
    transform: translateY(-10px);
  }
}

.toast-success {
  background: var(--success);
}

.toast-error {
  background: var(--error);
}

/* ===== Empty State ===== */
.empty-state {
  text-align: center;
  padding: var(--space-12) var(--space-4);
}

.empty-state-icon {
  width: 80px;
  height: 80px;
  margin: 0 auto var(--space-5);
  color: var(--border);
  stroke-width: 1;
}

.empty-state h2 {
  font-size: var(--text-lg);
  color: var(--text-secondary);
  margin-bottom: var(--space-2);
}

.empty-state p {
  color: var(--text-muted);
  font-size: var(--text-base);
  max-width: 280px;
  margin: 0 auto;
  line-height: 1.6;
}

/* ===== Loading States ===== */
.skeleton {
  background: linear-gradient(90deg, var(--border) 25%, var(--border-light) 50%, var(--border) 75%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
  border-radius: var(--radius-sm);
}

@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* ===== Dialog/Modal ===== */
.dialog-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 9998;
  display: none;
  align-items: center;
  justify-content: center;
  padding: var(--space-4);
  backdrop-filter: blur(2px);
}

.dialog-overlay.active {
  display: flex;
  animation: fadeIn var(--duration-fast) var(--easing);
}

.dialog {
  background: var(--surface-elevated);
  border-radius: var(--radius-lg);
  max-width: 400px;
  width: 100%;
  max-height: 90vh;
  overflow: hidden;
  animation: dialogIn var(--duration-normal) var(--easing-bounce);
}

@keyframes dialogIn {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.dialog-header {
  padding: var(--space-5) var(--space-5) var(--space-3);
}

.dialog-header h3 {
  font-size: var(--text-lg);
  margin: 0;
}

.dialog-body { padding-bottom: 80px;
  padding: 0 var(--space-5) var(--space-4);
  color: var(--text-secondary);
  line-height: 1.6;
}

.dialog-footer {
  padding: var(--space-3) var(--space-5) var(--space-5);
  display: flex;
  gap: var(--space-3);
  justify-content: flex-end;
}

/* ===== Section Headers ===== */
.section-header {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-bottom: var(--space-3);
}

.section-header h3 {
  margin: 0;
  font-size: var(--text-sm);
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: var(--text-muted);
}

.section-line {
  flex: 1;
  height: 1px;
  background: var(--border);
}

/* ===== Detail View ===== */
.detail-section {
  margin-bottom: var(--space-4);
}

.detail-section h3 {
  font-size: var(--text-xs);
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: var(--text-muted);
  margin-bottom: var(--space-2);
}

.detail-section p {
  color: var(--text);
  font-size: var(--text-base);
  line-height: 1.6;
}

/* ===== GPS Link ===== */
.gps-link {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-sm);
  color: var(--primary);
  background: transparent;
  border: none;
  padding: var(--space-2) 0;
  cursor: pointer;
  font-weight: 500;
  transition: color var(--duration-fast) var(--easing);
}

.gps-link:hover {
  color: var(--primary-dark);
}

.gps-link svg {
  transition: transform var(--duration-fast) var(--easing);
}

.gps-link:hover svg {
  transform: scale(1.1);
}

/* ===== Status Badge ===== */
.status-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-1) var(--space-2);
  border-radius: var(--radius-sm);
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.02em;
}

.status-badge::before {
  content: '';
  width: 6px;
  height: 6px;
  border-radius: 50%;
}

.status-demo {
  background: var(--primary-50);
  color: var(--primary-dark);
}

.status-demo::before {
  background: var(--primary);
}

/* ===== Print Styles ===== */
@media print {
  .bottom-nav,
  .fab,
  .demo-banner,
  .app-header,
  #bct-demo-disclaimer,
  .back-btn,
  .btn-danger {
    display: none !important;
  }
  
  body { padding-bottom: 80px;
    background: var(--white);
    padding: 0;
  }
  
  .card {
    box-shadow: none;
    border: 1px solid var(--border);
    page-break-inside: avoid;
  }
  
  .content {
    max-width: none;
    padding: 0;
  }
}

/* ===== Reduced Motion ===== */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ===== High Contrast Mode ===== */
@media (prefers-contrast: high) {
  :root {
    --primary: #0056b3;
    --text: #000000;
    --border: #000000;
  }
  
  .card {
    border: 2px solid var(--border);
  }
  
  :focus-visible {
    outline: 3px solid var(--primary);
    outline-offset: 3px;
  }
}

/* ===== Mobile Optimizations ===== */
@media (max-width: 400px) {
  .well-card .well-stats {
    gap: var(--space-3);
  }
  
  .well-card .stat-value {
    font-size: 1rem;
  }
  
  .content {
    padding: var(--space-3);
  }
  
  .card {
    padding: var(--space-3);
  }
}
</style>
</head>
<body>
<a href="#main-content" class="skip-link">Skip to main content</a>

<!-- Gate Screen -->
<div id="gate" role="dialog" aria-modal="true" aria-labelledby="gate-title">
  <div id="gate-content">
    <h1 id="gate-title">WellLog</h1>
    <p>This tool requires a valid access key.</p>
    <p><a href="mailto:ben@bennycutools.com">ben@bennycutools.com</a></p>
  </div>
</div>

<!-- Main App -->
<div id="app">
  <header class="app-header">
    <h1>WellLog</h1>
    <p>Magill Drilling & Water Well Service</p>
  </header>
  
  <div class="demo-banner" id="demoBanner" style="display:none" role="status" aria-live="polite">
    <span>Sample data loaded. Tap Clear to start fresh.</span>
    <button onclick="clearDemo()" aria-label="Clear demonstration data">Clear</button>
  </div>
  
  <main id="main-content">
    <!-- Wells List View -->
    <div class="view active" id="viewWells">
      <div class="content">
        <div id="wellsList" role="list" aria-label="Well logs"></div>
        
        <div class="card upsell-card" style="--i:6">
          <h3 style="color:var(--text-secondary)">TCEQ Reports <span class="upsell-badge">Full Version</span></h3>
          <p style="margin-top:var(--space-3)">Auto-format well data into state-compliant documents. No more paperwork piling up on your desk.</p>
        </div>
      </div>
    </div>
    
    <!-- New/Edit Well View -->
    <div class="view" id="viewEdit">
      <div class="content">
        <button class="back-btn" onclick="showView('viewWells')" aria-label="Back to well list">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path d="M19 12H5"/>
            <polyline points="12 19 5 12 12 5"/>
          </svg>
          Back
        </button>
        
        <h2 id="editTitle" style="margin-bottom:var(--space-4)">New Well</h2>
        
        <!-- Voice Input Card -->
        <div class="card">
          <h3>Voice Input</h3>
          <p class="form-help" style="margin-bottom:var(--space-3)">Tap and speak your well data. Works great with muddy hands.</p>
          <button class="voice-btn" id="voiceBtn" onclick="toggleVoice()" aria-label="Start voice input">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z"/>
              <path d="M19 10v2a7 7 0 01-14 0v-2"/>
              <line x1="12" y1="19" x2="12" y2="23"/>
              <line x1="8" y1="23" x2="16" y2="23"/>
            </svg>
            <span id="voiceBtnText">Tap to Speak</span>
          </button>
          <div class="voice-result" id="voiceResult" role="status" aria-live="polite"></div>
        </div>
        
        <!-- Customer Info Card -->
        <div class="card">
          <h3>Customer</h3>
          <div class="form-group">
            <label for="wCustName">Customer / Property <span aria-label="required">*</span></label>
            <input type="text" id="wCustName" placeholder="Johnson Ranch" aria-required="true">
          </div>
          <div class="form-group">
            <label for="wCustPhone">Phone</label>
            <input type="tel" id="wCustPhone" placeholder="(325) 555-0123" inputmode="tel">
          </div>
          <div class="form-group">
            <label for="wAddr">Location</label>
            <input type="text" id="wAddr" placeholder="CR 405, Mason TX">
            <button class="gps-link" onclick="autoLoc()" aria-label="Use current GPS location">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <circle cx="12" cy="12" r="10"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
              Use GPS
            </button>
          </div>
        </div>
        
        <!-- Well Data Card -->
        <div class="card">
          <h3>Well Data</h3>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-3)">
            <div class="form-group" style="margin:0">
              <label for="wDepth">Total Depth (ft)</label>
              <input type="number" id="wDepth" placeholder="215" inputmode="numeric">
            </div>
            <div class="form-group" style="margin:0">
              <label for="wStaticLevel">Static Level (ft)</label>
              <input type="number" id="wStaticLevel" placeholder="190" inputmode="numeric">
            </div>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-3);margin-top:var(--space-4)">
            <div class="form-group" style="margin:0">
              <label for="wYield">Yield (GPM)</label>
              <input type="number" id="wYield" placeholder="12" inputmode="numeric">
            </div>
            <div class="form-group" style="margin:0">
              <label for="wCasing">Casing Size</label>
              <input type="text" id="wCasing" placeholder='6" PVC'>
            </div>
          </div>
          <div class="form-group" style="margin-top:var(--space-4)">
            <label for="wPump">Pump Specs</label>
            <input type="text" id="wPump" placeholder="3/4 HP submersible, set at 200ft">
          </div>
          <div class="form-group" style="margin:0">
            <label for="wDate">Date Drilled</label>
            <input type="date" id="wDate">
          </div>
        </div>
        
        <!-- Geology Card -->
        <div class="card">
          <h3>Geology Log</h3>
          <p class="form-help" style="margin-bottom:var(--space-3)">Add formations as you drill through them.</p>
          <div id="geoLayers" class="geo-column" role="list" aria-label="Geological layers"></div>
          <div style="display:flex;gap:var(--space-2);margin-top:var(--space-3)">
            <select id="newGeoType" style="flex:1;padding:var(--space-3);border:1.5px solid var(--border);border-radius:var(--radius);font-size:var(--text-base)">
              <option value="">Formation type...</option>
              <option value="Topsoil">Topsoil</option>
              <option value="Clay">Clay</option>
              <option value="Sand">Sand</option>
              <option value="Gravel">Gravel</option>
              <option value="Sandstone">Sandstone</option>
              <option value="Limestone">Limestone</option>
              <option value="Granite">Granite</option>
              <option value="Shale">Shale</option>
              <option value="Caliche">Caliche</option>
              <option value="Fractured Rock">Fractured Rock</option>
            </select>
            <input type="number" id="newGeoFrom" placeholder="From" style="width:70px;padding:var(--space-3);border:1.5px solid var(--border);border-radius:var(--radius);font-size:var(--text-base)" inputmode="numeric">
            <input type="number" id="newGeoTo" placeholder="To" style="width:70px;padding:var(--space-3);border:1.5px solid var(--border);border-radius:var(--radius);font-size:var(--text-base)" inputmode="numeric">
            <button class="btn btn-outline btn-sm" onclick="addGeoLayer()" aria-label="Add geology layer">Add</button>
          </div>
        </div>
        
        <!-- Photos Card -->
        <div class="card">
          <h3>Photos</h3>
          <div class="photo-grid" id="wPhotoGrid" role="list" aria-label="Well photos">
            <div class="photo-cell add-photo" onclick="openCamera()" role="button" tabindex="0" aria-label="Take photo">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="1.5" aria-hidden="true">
                <path d="M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"/>
                <circle cx="12" cy="13" r="4"/>
              </svg>
            </div>
          </div>
        </div>
        
        <!-- Notes Card -->
        <div class="card">
          <div class="form-group" style="margin:0">
            <label for="wNotes">Notes</label>
            <textarea id="wNotes" rows="3" placeholder="Water quality, access conditions, pump test results..."></textarea>
          </div>
        </div>
        
        <button class="btn btn-primary btn-block" onclick="saveWell()" id="saveBtn" style="margin-top:var(--space-4)">
          Save Well Log
        </button>
      </div>
    </div>
    
    <!-- Well Detail View -->
    <div class="view" id="viewDetail">
      <div class="content" id="detailContent"></div>
    </div>
    
    <!-- Settings View -->
    <div class="view" id="viewSettings">
      <div class="content">
        <h2 style="margin-bottom:var(--space-4)">Settings</h2>
        
        <div class="card">
          <h3>Data Backup</h3>
          <p class="form-help" style="margin-bottom:var(--space-4)">Export your well logs to transfer to another device or keep as backup.</p>
          <button class="btn btn-outline btn-block" onclick="exportData()" style="margin-bottom:var(--space-3)">Export Data (JSON)</button>
          <button class="btn btn-outline btn-block" onclick="document.getElementById('importFile').click()">Import Data (JSON)</button>
          <input type="file" id="importFile" accept=".json" onchange="importData(event)" style="display:none" aria-label="Import data file">
        </div>
        
        <div class="card">
          <h3 style="color:var(--error)">Danger Zone</h3>
          <p class="form-help" style="margin-bottom:var(--space-4)">This cannot be undone. Make sure you have exported your data first.</p>
          <button class="btn btn-danger btn-block" onclick="confirmClearAll()">Delete All Data</button>
        </div>
      </div>
    </div>
  </main>
  
  <!-- Floating Action Button -->
  <button class="fab" onclick="newWell()" aria-label="Log new well" id="fabBtn">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
      <line x1="12" y1="5" x2="12" y2="19"/>
      <line x1="5" y1="12" x2="19" y2="12"/>
    </svg>
  </button>
  
  <!-- Bottom Navigation -->
  <nav class="bottom-nav" role="navigation" aria-label="Main navigation">
    <button onclick="showView('viewWells')" class="active" id="navWells" aria-label="View wells list">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="8" x2="12" y2="16"/>
        <line x1="12" y1="16" x2="12" y2="20" stroke-dasharray="2 2"/>
      </svg>
      Wells
    </button>
    <button onclick="showView('viewSettings')" id="navSettings" aria-label="Open settings">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
        <circle cx="12" cy="12" r="3"/>
        <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/>
      </svg>
      Settings
    </button>
  </nav>
  
  <!-- Camera Overlay -->
  <div class="camera-overlay" id="cameraOverlay" role="dialog" aria-modal="true" aria-label="Camera">
    <video id="cameraVideo" autoplay playsinline aria-label="Camera preview"></video>
    <button class="close-cam" onclick="closeCamera()" aria-label="Close camera">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
    <div class="controls">
      <button class="shutter" onclick="capturePhoto()" aria-label="Take photo"></button>
    </div>
  </div>
  
  <!-- Hidden canvas for photo processing -->
  <canvas id="cameraCanvas" style="display:none" aria-hidden="true"></canvas>
  
  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer" role="status" aria-live="polite" aria-atomic="true"></div>
  
  <!-- Confirm Dialog -->
  <div class="dialog-overlay" id="confirmDialog" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
    <div class="dialog">
      <div class="dialog-header">
        <h3 id="confirmTitle">Delete All Data?</h3>
      </div>
      <div class="dialog-body">
        <p>This will permanently delete all your well logs. This action cannot be undone.</p>
      </div>
      <div class="dialog-footer">
        <button class="btn btn-outline" onclick="closeConfirmDialog()">Cancel</button>
        <button class="btn btn-danger" onclick="executeClearAll()" id="confirmBtn">Delete</button>
      </div>
    </div>
  </div>
</div>

<!-- DEMO DISCLAIMER -->
<div id="bct-demo-disclaimer" role="contentinfo" aria-label="Demo information" style="position:fixed;bottom:0;left:0;right:0;background:linear-gradient(to right,#f8f9fa,#fff);border-top:1px solid #e9ecef;padding:8px 16px;font-size:11px;line-height:1.4;color:#6c757d;z-index:99999;display:flex;align-items:center;justify-content:space-between;gap:12px;min-height:36px;">
<p style="margin:0;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"><strong style="color:#495057;font-weight:600;">Demo:</strong> Created by BennyCuTools for demonstration. Not affiliated with Magill Drilling.</p>
<div style="display:flex;align-items:center;gap:12px;flex-shrink:0;">
<a href="https://bennycutools.com" target="_blank" rel="noopener" style="color:#6c757d;text-decoration:underline;text-underline-offset:2px;white-space:nowrap;">Learn more</a>
<a href="mailto:cuuper225@gmail.com?subject=Remove%20Demo%3A%20Magill%20Drilling&body=I%20am%20the%20owner%20and%20request%20removal%20of%20this%20demo." style="color:#adb5bd;text-decoration:underline;text-underline-offset:2px;white-space:nowrap;font-size:10px;">Remove</a>
</div>
</div>

<script>
// ===== Authentication =====
function _h(s) {
  let h = 0;
  for (let i = 0; i < s.length; i++) {
    h = ((h << 5) - h) + s.charCodeAt(i);
    h |= 0;
  }
  return h;
}

const _V = 940291654;
const _k = new URLSearchParams(window.location.search).get('key');

if (_k && _h(_k) === _V) {
  initApp().catch(e => {console.error('initApp failed:', e); const t=document.createElement('div');t.style.cssText='position:fixed;top:80px;left:50%;transform:translateX(-50%);background:#b91c1c;color:#fff;padding:12px 20px;border-radius:8px;z-index:9999';t.textContent='Error loading data. Please refresh.';document.body.appendChild(t);setTimeout(()=>t.remove(),3000);});
} else {
  document.getElementById('gate').style.display = 'flex';
  document.getElementById('app').style.display = 'none';
}

// Prevent context menu on long press
let longPressTimer;
document.addEventListener('contextmenu', e => e.preventDefault());

// ===== State Management =====
let db, currentWellId = null, currentGeoLayers = [], currentPhotos = [], cameraStream = null, recognition = null, isRecording = false;
let confirmCallback = null;

// ===== App Initialization =====
function initApp() {
  document.getElementById('gate').style.display = 'none';
  document.getElementById('app').style.display = 'block';
  openDB().then(() => {
    checkFirstVisit();
    renderWells();
  });
}

// ===== IndexedDB Operations =====
function openDB() {
  return new Promise((res, rej) => {
    const r = indexedDB.open('WellLogDB', 1);
    r.onupgradeneeded = e => {
      const d = e.target.result;
      if (!d.objectStoreNames.contains('wells')) {
        d.createObjectStore('wells', { keyPath: 'id' });
      }
    };
    r.onsuccess = e => {
      db = e.target.result;
      res();
    };
    r.onerror = e => rej(e);
  });
}

function dbPut(s, d) {
  return new Promise((res, rej) => {
    const tx = db.transaction(s, 'readwrite');
    tx.objectStore(s).put(d);
    tx.oncomplete = () => res();
    tx.onerror = e => rej(e);
  });
}

function dbGetAll(s) {
  return new Promise((res, rej) => {
    const tx = db.transaction(s, 'readonly');
    const r = tx.objectStore(s).getAll();
    r.onsuccess = () => res(r.result);
    r.onerror = e => rej(e);
  });
}

function dbGet(s, id) {
  return new Promise((res, rej) => {
    const tx = db.transaction(s, 'readonly');
    const r = tx.objectStore(s).get(id);
    r.onsuccess = () => res(r.result);
    r.onerror = e => rej(e);
  });
}

function dbDelete(s, id) {
  return new Promise((res, rej) => {
    const tx = db.transaction(s, 'readwrite');
    tx.objectStore(s).delete(id);
    tx.oncomplete = () => res();
    tx.onerror = e => rej(e);
  });
}

// ===== Demo Data =====
function checkFirstVisit() {
  if (!localStorage.getItem('wl_visited')) {
    localStorage.setItem('wl_visited', '1');
    loadDemoData();
  }
}

function loadDemoData() {
  const demos = [
    {
      id: 'demo-1',
      isDemo: true,
      customer: { name: 'Johnson Ranch', phone: '(325) 555-0147', address: 'CR 405, Mason TX' },
      well: { depth: 225, staticLevel: 190, yield: 15, casing: '6" PVC', pump: '1 HP submersible, set at 210ft', date: '2026-02-10' },
      geology: [
        { type: 'Topsoil', from: 0, to: 12 },
        { type: 'Clay', from: 12, to: 45 },
        { type: 'Caliche', from: 45, to: 90 },
        { type: 'Limestone', from: 90, to: 180 },
        { type: 'Granite', from: 180, to: 225 }
      ],
      photos: [],
      notes: 'Strong water strike at 195ft. Good production well for livestock and residential. Clear water, no sulfur smell.',
      created: Date.now() - 172800000
    },
    {
      id: 'demo-2',
      isDemo: true,
      customer: { name: 'Miller Residence', phone: '(325) 555-0298', address: 'FM 2768, Llano TX' },
      well: { depth: 185, staticLevel: 150, yield: 8, casing: '5" PVC', pump: '3/4 HP submersible, set at 170ft', date: '2026-02-08' },
      geology: [
        { type: 'Topsoil', from: 0, to: 8 },
        { type: 'Sand', from: 8, to: 35 },
        { type: 'Limestone', from: 35, to: 160 },
        { type: 'Fractured Rock', from: 160, to: 185 }
      ],
      photos: [],
      notes: 'Residential well for new home build. Adequate flow for household use. Recommend pressure tank at 40/60 psi.',
      created: Date.now() - 345600000
    },
    {
      id: 'demo-3',
      isDemo: true,
      customer: { name: 'Kingsland Subdivision Lot 3', phone: '(325) 555-0412', address: 'Packsaddle Mountain Dr, Kingsland TX' },
      well: { depth: 250, staticLevel: 210, yield: 20, casing: '6" PVC', pump: '1.5 HP submersible, set at 235ft', date: '2026-02-05' },
      geology: [
        { type: 'Topsoil', from: 0, to: 10 },
        { type: 'Clay', from: 10, to: 55 },
        { type: 'Sandstone', from: 55, to: 120 },
        { type: 'Limestone', from: 120, to: 200 },
        { type: 'Granite', from: 200, to: 250 }
      ],
      photos: [],
      notes: 'High-yield production well for subdivision. One of three wells planned. Builder pleased with GPM results.',
      created: Date.now() - 604800000
    },
    {
      id: 'demo-4',
      isDemo: true,
      customer: { name: 'Davis Farm - Irrigation', phone: '(325) 555-0573', address: 'Hwy 29, Castell TX' },
      well: { depth: 180, staticLevel: 120, yield: 35, casing: '8" steel', pump: '2 HP submersible, set at 160ft', date: '2026-01-28' },
      geology: [
        { type: 'Topsoil', from: 0, to: 15 },
        { type: 'Gravel', from: 15, to: 60 },
        { type: 'Sand', from: 60, to: 130 },
        { type: 'Limestone', from: 130, to: 180 }
      ],
      photos: [],
      notes: 'Irrigation well for 40-acre hay operation. High yield from sand/gravel aquifer. Recommend monitoring water level during summer draw-down.',
      created: Date.now() - 1209600000
    }
  ];
  
  demos.forEach(d => dbPut('wells', d));
  setTimeout(() => {
    document.getElementById('demoBanner').style.display = 'flex';
    renderWells();
  }, 300);
}

function clearDemo() {
  dbGetAll('wells')
    .then(w => Promise.all(w.filter(x => x.isDemo).map(x => dbDelete('wells', x.id))))
    .then(() => {
      document.getElementById('demoBanner').style.display = 'none';
      renderWells();
      toast('Demo data cleared', 'success');
    });
}

// ===== View Management =====
function showView(id) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  
  document.querySelectorAll('.bottom-nav button').forEach(b => b.classList.remove('active'));
  if (id === 'viewWells') document.getElementById('navWells').classList.add('active');
  if (id === 'viewSettings') document.getElementById('navSettings').classList.add('active');
  
  document.getElementById('fabBtn').style.display = (id === 'viewWells') ? 'flex' : 'none';
  
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ===== Wells List =====
function renderWells() {
  dbGetAll('wells').then(wells => {
    wells.sort((a, b) => b.created - a.created);
    const el = document.getElementById('wellsList');
    
    if (!wells.length) {
      el.innerHTML = `
        <div class="empty-state">
          <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="16"/>
            <line x1="12" y1="16" x2="12" y2="20" stroke-dasharray="2 2"/>
          </svg>
          <h2>No wells yet</h2>
          <p>Tap the + button to log your first well. All data stays on your phone.</p>
        </div>
      `;
      return;
    }
    
    el.innerHTML = wells.map((w, i) => {
      const dateStr = w.well?.date 
        ? new Date(w.well.date + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })
        : '';
      
      return `
        <article class="card well-card" style="--i:${i}" onclick="viewWell('${w.id}')" tabindex="0" role="listitem" 
                 aria-label="Well for ${w.customer?.name}, ${w.well?.depth || '--'} feet, ${w.well?.yield || '--'} GPM"
                 onkeydown="if(event.key==='Enter'||event.key===' ')viewWell('${w.id}')">
          <div class="well-meta">
            <span>${dateStr}</span>
            <span class="well-layers">${w.geology?.length || 0} layers</span>
            ${w.isDemo ? '<span class="status-badge status-demo">Demo</span>' : ''}
          </div>
          <h3>${escapeHtml(w.customer?.name || 'Unnamed')}</h3>
          <p style="font-size:var(--text-sm);color:var(--text-muted);margin-top:2px">${escapeHtml(w.customer?.address || '')}</p>
          <div class="well-stats">
            <div class="stat">
              <div class="stat-value">${w.well?.depth || '--'}</div>
              <div class="stat-label">Depth (ft)</div>
            </div>
            <div class="stat">
              <div class="stat-value">${w.well?.yield || '--'}</div>
              <div class="stat-label">GPM</div>
            </div>
            <div class="stat">
              <div class="stat-value">${w.well?.staticLevel || '--'}</div>
              <div class="stat-label">Static (ft)</div>
            </div>
            <div class="stat">
              <div class="stat-value">${w.well?.casing || '--'}</div>
              <div class="stat-label">Casing</div>
            </div>
          </div>
        </article>
      `;
    }).join('');
    
    document.getElementById('demoBanner').style.display = wells.some(w => w.isDemo) ? 'flex' : 'none';
  });
}

function escapeHtml(text) {
  if (!text) return '';
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// ===== New/Edit Well =====
function newWell() {
  currentWellId = null;
  currentGeoLayers = [];
  currentPhotos = [];
  document.getElementById('editTitle').textContent = 'New Well';
  
  ['wCustName', 'wCustPhone', 'wAddr', 'wDepth', 'wStaticLevel', 'wYield', 'wCasing', 'wPump', 'wNotes'].forEach(id => {
    document.getElementById(id).value = '';
  });
  
  document.getElementById('wDate').value = new Date().toISOString().split('T')[0];
  document.getElementById('voiceResult').textContent = '';
  document.getElementById('voiceResult').classList.remove('has-content');
  
  renderGeoLayers();
  renderWellPhotos();
  showView('viewEdit');
}

// ===== Voice Input =====
function toggleVoice() {
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  if (!SpeechRecognition) {
    toast('Voice input not supported in this browser', 'error');
    return;
  }
  
  if (isRecording) {
    recognition.stop();
    return;
  }
  
  recognition = new SpeechRecognition();
  recognition.continuous = false;
  recognition.interimResults = true;
  recognition.lang = 'en-US';
  
  const btn = document.getElementById('voiceBtn');
  const btnText = document.getElementById('voiceBtnText');
  const result = document.getElementById('voiceResult');
  
  recognition.onstart = () => {
    isRecording = true;
    btn.classList.add('recording');
    btnText.textContent = 'Listening...';
  };
  
  recognition.onresult = e => {
    let transcript = '';
    for (let i = e.resultIndex; i < e.results.length; i++) {
      transcript += e.results[i][0].transcript;
    }
    result.textContent = transcript;
    result.classList.add('has-content');
    parseVoiceInput(transcript);
  };
  
  recognition.onend = () => {
    isRecording = false;
    btn.classList.remove('recording');
    btnText.textContent = 'Tap to Speak';
  };
  
  recognition.onerror = () => {
    isRecording = false;
    btn.classList.remove('recording');
    btnText.textContent = 'Tap to Speak';
    toast('Could not hear you. Try again.', 'error');
  };
  
  recognition.start();
}

function parseVoiceInput(text) {
  const lower = text.toLowerCase();
  
  // Depth patterns
  const depthMatch = lower.match(/(?:total\s+)?depth\s+(\d+)\s*(?:feet|ft|foot)?/);
  if (depthMatch) document.getElementById('wDepth').value = depthMatch[1];
  
  // Static water level patterns
  const staticMatch = lower.match(/(?:static\s+)?(?:water\s+)?level\s+(\d+)\s*(?:feet|ft)?/);
  if (staticMatch) document.getElementById('wStaticLevel').value = staticMatch[1];
  
  // Yield patterns
  const yieldMatch = lower.match(/(?:yield\s+)?(\d+)\s*(?:gallons?\s+per\s+minute|gpm|gallon)/);
  if (yieldMatch) document.getElementById('wYield').value = yieldMatch[1];
  
  // Casing patterns
  const casingMatch = lower.match(/(\d+)\s*(?:inch|")\s*(pvc|steel|iron)?/);
  if (casingMatch) {
    const material = casingMatch[2] ? ' ' + casingMatch[2].toUpperCase() : '';
    document.getElementById('wCasing').value = casingMatch[1] + '"' + material;
  }
}

// ===== Geology Layers =====
function addGeoLayer() {
  const type = document.getElementById('newGeoType').value;
  const from = parseInt(document.getElementById('newGeoFrom').value);
  const to = parseInt(document.getElementById('newGeoTo').value);
  
  if (!type) {
    toast('Select a formation type', 'error');
    return;
  }
  if (isNaN(from) || isNaN(to)) {
    toast('Enter depth range', 'error');
    return;
  }
  if (from >= to) {
    toast('End depth must be greater than start', 'error');
    return;
  }
  
  currentGeoLayers.push({ type, from, to });
  currentGeoLayers.sort((a, b) => a.from - b.from);
  
  document.getElementById('newGeoType').value = '';
  document.getElementById('newGeoFrom').value = '';
  document.getElementById('newGeoTo').value = '';
  
  renderGeoLayers();
}

function removeGeoLayer(idx) {
  currentGeoLayers.splice(idx, 1);
  renderGeoLayers();
}

function renderGeoLayers() {
  const el = document.getElementById('geoLayers');
  if (!currentGeoLayers.length) {
    el.innerHTML = '<p style="font-size:var(--text-sm);color:var(--text-muted);padding:var(--space-2) 0">No layers yet. Add formations as you drill.</p>';
    return;
  }
  
  el.innerHTML = currentGeoLayers.map((l, i) => `
    <div class="geo-layer" role="listitem">
      <span class="depth">${l.from}-${l.to} ft</span>
      <span class="formation">${escapeHtml(l.type)}</span>
      <button onclick="removeGeoLayer(${i})" aria-label="Remove ${l.type} layer" title="Remove layer">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
  `).join('');
}

// ===== Geolocation =====
function autoLoc() {
  if (!navigator.geolocation) {
    toast('GPS not available on this device', 'error');
    return;
  }
  
  const btn = event.target.closest('.gps-link');
  const originalText = btn.innerHTML;
  btn.innerHTML = '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="3"/></svg> Getting location...';
  btn.disabled = true;
  
  navigator.geolocation.getCurrentPosition(
    p => {
      document.getElementById('wAddr').value = `${p.coords.latitude.toFixed(5)}, ${p.coords.longitude.toFixed(5)} (GPS)`;
      toast('Location captured');
      btn.innerHTML = originalText;
      btn.disabled = false;
    },
    () => {
      toast('Could not get location. Check GPS permissions.', 'error');
      btn.innerHTML = originalText;
      btn.disabled = false;
    },
    { enableHighAccuracy: true, timeout: 10000 }
  );
}

// ===== Camera =====
function openCamera() {
  navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
    .then(stream => {
      cameraStream = stream;
      const video = document.getElementById('cameraVideo');
      video.srcObject = stream;
      
      const overlay = document.getElementById('cameraOverlay');
      overlay.classList.add('active');
      overlay.style.display = 'flex';
      
      // Focus trap for camera overlay
      overlay.querySelector('.close-cam').focus();
    })
    .catch(() => {
      // Fallback to file input
      const inp = document.createElement('input');
      inp.type = 'file';
      inp.accept = 'image/*';
      inp.capture = 'environment';
      inp.onchange = e => {
        const f = e.target.files[0];
        if (!f) return;
        const r = new FileReader();
        r.onload = ev => {
          currentPhotos.push(ev.target.result);
          renderWellPhotos();
        };
        r.readAsDataURL(f);
      };
      inp.click();
    });
}

function capturePhoto() {
  const v = document.getElementById('cameraVideo');
  const c = document.getElementById('cameraCanvas');
  c.width = v.videoWidth;
  c.height = v.videoHeight;
  c.getContext('2d').drawImage(v, 0, 0);
  currentPhotos.push(c.toDataURL('image/jpeg', 0.8));
  renderWellPhotos();
  closeCamera();
  toast('Photo saved');
}

function closeCamera() {
  if (cameraStream) {
    cameraStream.getTracks().forEach(t => t.stop());
    cameraStream = null;
  }
  const overlay = document.getElementById('cameraOverlay');
  overlay.classList.remove('active');
  overlay.style.display = 'none';
}

function renderWellPhotos() {
  const g = document.getElementById('wPhotoGrid');
  g.innerHTML = currentPhotos.map((p, i) => `
    <div class="photo-cell" role="listitem">
      <img src="${p}" alt="Well photo ${i + 1}" loading="lazy">
      <button class="photo-remove" onclick="currentPhotos.splice(${i}, 1); renderWellPhotos()" aria-label="Remove photo ${i + 1}">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" aria-hidden="true">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
  `).join('') + `
    <div class="photo-cell add-photo" onclick="openCamera()" role="button" tabindex="0" aria-label="Take another photo"
         onkeydown="if(event.key==='Enter'||event.key===' ')openCamera()">
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="1.5" aria-hidden="true">
        <path d="M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"/>
        <circle cx="12" cy="13" r="4"/>
      </svg>
    </div>
  `;
}

// ===== Save Well =====
function saveWell() {
  const name = document.getElementById('wCustName').value.trim();
  if (!name) {
    toast('Enter customer or property name', 'error');
    document.getElementById('wCustName').focus();
    return;
  }
  
  const saveBtn = document.getElementById('saveBtn');
  saveBtn.classList.add('btn-loading');
  saveBtn.disabled = true;
  
  const well = {
    id: currentWellId || 'w-' + Date.now(),
    customer: {
      name,
      phone: document.getElementById('wCustPhone').value.trim(),
      address: document.getElementById('wAddr').value.trim()
    },
    well: {
      depth: parseInt(document.getElementById('wDepth').value) || 0,
      staticLevel: parseInt(document.getElementById('wStaticLevel').value) || 0,
      yield: parseInt(document.getElementById('wYield').value) || 0,
      casing: document.getElementById('wCasing').value.trim(),
      pump: document.getElementById('wPump').value.trim(),
      date: document.getElementById('wDate').value
    },
    geology: [...currentGeoLayers],
    photos: [...currentPhotos],
    notes: document.getElementById('wNotes').value.trim(),
    created: currentWellId ? undefined : Date.now()
  };
  
  if (currentWellId) {
    dbGet('wells', currentWellId).then(ex => {
      well.created = ex?.created || Date.now();
      return dbPut('wells', well);
    }).then(() => {
      saveBtn.classList.remove('btn-loading');
      saveBtn.disabled = false;
      toast('Well log updated', 'success');
      renderWells();
      showView('viewWells');
    });
  } else {
    dbPut('wells', well).then(() => {
      saveBtn.classList.remove('btn-loading');
      saveBtn.disabled = false;
      toast('Well log saved', 'success');
      renderWells();
      showView('viewWells');
    });
  }
}

// ===== View Well Detail =====
function viewWell(id) {
  dbGet('wells', id).then(w => {
    if (!w) return;
    
    const dateStr = w.well?.date 
      ? new Date(w.well.date + 'T12:00:00').toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' })
      : '';
    
    const geoHtml = w.geology?.length
      ? `<div class="geo-column">${w.geology.map(l => `
          <div class="geo-layer">
            <span class="depth">${l.from}-${l.to} ft</span>
            <span class="formation">${escapeHtml(l.type)}</span>
          </div>
        `).join('')}</div>`
      : '<p style="color:var(--text-muted);font-size:var(--text-sm)">No geology recorded</p>';
    
    const photosHtml = w.photos?.length
      ? `<div class="photo-grid">${w.photos.map((p, i) => `
          <div class="photo-cell">
            <img src="${p}" alt="Well photo ${i + 1}" loading="lazy">
          </div>
        `).join('')}</div>`
      : '';
    
    document.getElementById('detailContent').innerHTML = `
      <button class="back-btn" onclick="showView('viewWells')" aria-label="Back to well list">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <path d="M19 12H5"/>
          <polyline points="12 19 5 12 12 5"/>
        </svg>
        Back
      </button>
      
      <article class="card">
        <h2>${escapeHtml(w.customer?.name)}</h2>
        <p style="font-size:var(--text-sm);color:var(--text-muted);margin-top:4px">${escapeHtml(w.customer?.address || '')}</p>
        <p style="font-size:var(--text-xs);color:var(--text-muted);margin-top:4px">${dateStr}</p>
        <div class="well-stats" style="margin-top:var(--space-4)">
          <div class="stat"><div class="stat-value">${w.well?.depth || '--'}</div><div class="stat-label">Depth (ft)</div></div>
          <div class="stat"><div class="stat-value">${w.well?.yield || '--'}</div><div class="stat-label">GPM</div></div>
          <div class="stat"><div class="stat-value">${w.well?.staticLevel || '--'}</div><div class="stat-label">Static (ft)</div></div>
          <div class="stat"><div class="stat-value">${escapeHtml(w.well?.casing || '--')}</div><div class="stat-label">Casing</div></div>
        </div>
      </article>
      
      <div class="card">
        <h3>Pump Details</h3>
        <p style="font-size:var(--text-base)">${escapeHtml(w.well?.pump || 'Not recorded')}</p>
      </div>
      
      <div class="card">
        <h3>Geology Log</h3>
        ${geoHtml}
      </div>
      
      ${w.notes ? `
        <div class="card">
          <h3>Field Notes</h3>
          <p style="font-size:var(--text-base);color:var(--text-secondary);white-space:pre-wrap">${escapeHtml(w.notes)}</p>
        </div>
      ` : ''}
      
      ${photosHtml ? `
        <div class="card">
          <h3>Photos</h3>
          ${photosHtml}
        </div>
      ` : ''}
      
      <div style="display:flex;gap:var(--space-3);margin-top:var(--space-4)">
        <button class="btn btn-primary" style="flex:1" onclick="editWell('${id}')">Edit</button>
        <button class="btn btn-outline" style="flex:1" onclick="shareWell('${id}')">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <circle cx="18" cy="5" r="3"/>
            <circle cx="6" cy="12" r="3"/>
            <circle cx="18" cy="19" r="3"/>
            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
          </svg>
          Share
        </button>
      </div>
      <button class="btn btn-danger btn-block" style="margin-top:var(--space-3)" onclick="deleteWell('${id}')">Delete Well</button>
    `;
    
    showView('viewDetail');
  });
}

// ===== Edit Well =====
function editWell(id) {
  dbGet('wells', id).then(w => {
    if (!w) return;
    currentWellId = id;
    currentGeoLayers = [...(w.geology || [])];
    currentPhotos = [...(w.photos || [])];
    
    document.getElementById('editTitle').textContent = 'Edit Well';
    document.getElementById('wCustName').value = w.customer?.name || '';
    document.getElementById('wCustPhone').value = w.customer?.phone || '';
    document.getElementById('wAddr').value = w.customer?.address || '';
    document.getElementById('wDepth').value = w.well?.depth || '';
    document.getElementById('wStaticLevel').value = w.well?.staticLevel || '';
    document.getElementById('wYield').value = w.well?.yield || '';
    document.getElementById('wCasing').value = w.well?.casing || '';
    document.getElementById('wPump').value = w.well?.pump || '';
    document.getElementById('wDate').value = w.well?.date || '';
    document.getElementById('wNotes').value = w.notes || '';
    
    renderGeoLayers();
    renderWellPhotos();
    showView('viewEdit');
  });
}

// ===== Delete Well =====
function deleteWell(id) {
  if (!confirm('Delete this well log? This cannot be undone.')) return;
  dbDelete('wells', id).then(() => {
    toast('Well deleted', 'success');
    renderWells();
    showView('viewWells');
  });
}

// ===== Share Well =====
function shareWell(id) {
  dbGet('wells', id).then(w => {
    if (!w) return;
    
    const geo = (w.geology || []).map(l => `  ${l.from}-${l.to}ft: ${l.type}`).join('\n');
    const text = `Magill Drilling - Well Log

Property: ${w.customer?.name}
Location: ${w.customer?.address}
Date: ${w.well?.date}

Total Depth: ${w.well?.depth}ft
Static Water Level: ${w.well?.staticLevel}ft
Yield: ${w.well?.yield} GPM
Casing: ${w.well?.casing}
Pump: ${w.well?.pump}

Geology:
${geo || '  No layers recorded'}

Notes: ${w.notes || 'None'}

Magill Drilling (325) 456-5090`;
    
    if (navigator.share) {
      navigator.share({ title: 'Well Log', text }).catch(() => {});
    } else {
      navigator.clipboard.writeText(text).then(() => toast('Copied to clipboard', 'success'));
    }
  });
}

// ===== Data Export/Import =====
function exportData() {
  dbGetAll('wells').then(d => {
    const b = new Blob([JSON.stringify(d, null, 2)], { type: 'application/json' });
    const u = URL.createObjectURL(b);
    const a = document.createElement('a');
    a.href = u;
    a.download = `welllog-backup-${new Date().toISOString().split('T')[0]}.json`;
    a.click();
    URL.revokeObjectURL(u);
    toast('Backup saved', 'success');
  });
}

function importData(ev) {
  const f = ev.target.files[0];
  if (!f) return;
  
  const r = new FileReader();
  r.onload = e => {
    try {
      const d = JSON.parse(e.target.result);
      if (!Array.isArray(d)) {
        toast('Invalid backup file', 'error');
        return;
      }
      
      if (!confirm(`Import ${d.length} wells? This will add to your existing data.`)) return;
      
      Promise.all(d.map(x => dbPut('wells', x))).then(() => {
        toast(`${d.length} wells imported`, 'success');
        renderWells();
      });
    } catch {
      toast('Could not read file', 'error');
    }
  };
  r.readAsText(f);
  ev.target.value = '';
}

// ===== Clear All Data =====
function confirmClearAll() {
  document.getElementById('confirmDialog').classList.add('active');
}

function closeConfirmDialog() {
  document.getElementById('confirmDialog').classList.remove('active');
}

function executeClearAll() {
  const tx = db.transaction('wells', 'readwrite');
  tx.objectStore('wells').clear();
  tx.oncomplete = () => {
    localStorage.removeItem('wl_visited');
    closeConfirmDialog();
    toast('All data deleted', 'success');
    renderWells();
  };
}

// ===== Toast Notifications =====
function toast(msg, type = 'info') {
  const el = document.createElement('div');
  el.className = `toast toast-${type}`;
  el.textContent = msg;
  document.getElementById('toastContainer').appendChild(el);
  
  setTimeout(() => {
    el.classList.add('toast-out');
    setTimeout(() => el.remove(), 300);
  }, 3000);
}

// ===== Keyboard Navigation for Camera Overlay =====
document.getElementById('cameraOverlay').addEventListener('keydown', e => {
  if (e.key === 'Escape') {
    closeCamera();
  }
});

// ===== Keyboard Navigation for Dialog =====
document.getElementById('confirmDialog').addEventListener('keydown', e => {
  if (e.key === 'Escape') {
    closeConfirmDialog();
  }
});
</script>
<script src="http://35.212.159.12/booking-api/tracker.js" async></script>
</body>
</html>
