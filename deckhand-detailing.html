<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>DockQuote - Deckhand Detailing Estimator</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Work+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
--bg:#f7f9fc;--surface:#ffffff;--card:#f0f4f8;--border:#d0d8e4;
--text:#1b3a5c;--muted:#6b7f96;--navy:#1b3a5c;--gold:#e8a838;--gold-dark:#c8882a;
--safe:#2d8a6e;--danger:#c0392b;--wave:#e1eaf4;
}
@media(prefers-reduced-motion:reduce){*,*::before,*::after{animation-duration:.01ms!important;transition-duration:.01ms!important}}
html{font-size:16px;background:var(--bg);color:var(--text)}
body{font-family:'Work Sans',sans-serif;min-height:100vh;padding-bottom:120px!important;background:var(--bg);overflow-x:hidden}
a{color:var(--navy)}
h1,h2,h3{font-family:'Playfair Display',serif;color:var(--navy)}

.skip-link{position:absolute;top:-40px;left:8px;background:var(--gold);color:#111;padding:8px 16px;z-index:10000;border-radius:4px;font-weight:600;text-decoration:none}
.skip-link:focus{top:8px}

/* Header */
.app-header{background:linear-gradient(135deg,#1b3a5c 0%,#274d73 100%);padding:20px 16px;text-align:center;position:sticky;top:0;z-index:100;box-shadow:0 2px 12px rgba(27,58,92,.2)}
.app-header h1{font-size:1.7rem;color:#fff;margin-bottom:2px}
.app-header p{font-size:.75rem;color:rgba(255,255,255,.7);letter-spacing:.1em;text-transform:uppercase;font-family:'Work Sans',sans-serif}
.wave-divider{height:24px;background:var(--bg);margin-top:-1px;position:relative}
.wave-divider::before{content:'';position:absolute;top:-23px;left:0;right:0;height:24px;background:var(--bg);border-radius:50% 50% 0 0 / 100% 100% 0 0}

/* Demo banner */
.demo-banner{background:#fef9e7;border:1px solid #f5dca0;padding:10px 16px;margin:0 12px 12px;border-radius:8px;display:flex;align-items:center;justify-content:space-between;gap:8px}
.demo-banner p{font-size:.82rem;color:#8a6d1a}
.demo-banner button{background:none;border:1px solid #d4b85c;color:#8a6d1a;padding:4px 12px;border-radius:4px;cursor:pointer;font-size:.8rem;white-space:nowrap}
.demo-banner button:focus-visible{outline:2px solid var(--gold);outline-offset:2px}

main{padding:0 12px 24px}

/* Cards */
.card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:20px;margin-bottom:16px;box-shadow:0 1px 4px rgba(27,58,92,.06)}
.card h2{font-size:1.2rem;margin-bottom:12px;color:var(--navy)}

/* Form elements */
.form-row{display:flex;gap:8px;margin-bottom:12px}
.form-group{flex:1}
.form-group label{display:block;font-size:.72rem;color:var(--muted);margin-bottom:4px;text-transform:uppercase;letter-spacing:.06em;font-weight:500}
.form-group select,.form-group input{width:100%;padding:10px 12px;background:var(--card);border:1px solid var(--border);color:var(--text);border-radius:8px;font-size:.95rem;font-family:inherit;-webkit-appearance:none;appearance:none}
.form-group select:focus,.form-group input:focus{border-color:var(--navy);outline:none;box-shadow:0 0 0 3px rgba(27,58,92,.12)}
.form-group select{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' fill='none' stroke='%236b7f96' stroke-width='2'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;padding-right:32px}

/* Service checklist */
.service-list{display:flex;flex-direction:column;gap:6px}
.service-item{display:flex;align-items:center;gap:12px;background:var(--card);border:1px solid var(--border);border-radius:8px;padding:12px;cursor:pointer;transition:border-color .2s,background .2s}
.service-item.checked{border-color:var(--navy);background:rgba(27,58,92,.04)}
.service-item:focus-within{outline:2px solid var(--navy);outline-offset:2px}
.service-item input[type=checkbox]{width:20px;height:20px;accent-color:var(--navy);cursor:pointer;flex-shrink:0}
.service-item .svc-info{flex:1}
.service-item .svc-name{font-weight:600;font-size:.9rem}
.service-item .svc-desc{font-size:.78rem;color:var(--muted);margin-top:2px}
.service-item .svc-price{font-weight:600;color:var(--gold-dark);font-size:1rem;white-space:nowrap}

/* Voice notes */
.voice-area{margin-top:12px}
.voice-btn{display:flex;align-items:center;gap:8px;background:var(--card);border:2px dashed var(--border);border-radius:8px;padding:12px;width:100%;cursor:pointer;font-family:inherit;font-size:.85rem;color:var(--muted);transition:border-color .2s,background .2s}
.voice-btn.recording{border-color:var(--danger);background:rgba(192,57,43,.05);color:var(--danger)}
.voice-btn:focus-visible{outline:2px solid var(--navy);outline-offset:2px}
.voice-btn svg{width:20px;height:20px;flex-shrink:0}
.voice-result{margin-top:8px;padding:10px;background:var(--card);border:1px solid var(--border);border-radius:8px;font-size:.85rem;min-height:48px}

/* Photo area */
.photo-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}
.photo-slot{aspect-ratio:4/3;background:var(--card);border:2px dashed var(--border);border-radius:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:border-color .2s;overflow:hidden;position:relative}
.photo-slot:focus-visible{outline:2px solid var(--navy);outline-offset:2px}
.photo-slot svg{width:28px;height:28px;color:var(--muted)}
.photo-slot span{font-size:.7rem;color:var(--muted);margin-top:4px;text-transform:uppercase}
.photo-slot img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;border-radius:6px}
.photo-slot .remove-photo{position:absolute;top:4px;right:4px;background:rgba(0,0,0,.6);color:#fff;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;font-size:.8rem;display:none;align-items:center;justify-content:center}
.photo-slot:hover .remove-photo,.photo-slot img+.remove-photo{display:flex}

/* Estimate summary */
.estimate-summary{background:linear-gradient(135deg,#1b3a5c,#274d73);border:none;border-radius:12px;padding:24px;margin-bottom:16px;color:#fff}
.estimate-summary h2{color:var(--gold);margin-bottom:16px}
.est-line{display:flex;justify-content:space-between;padding:7px 0;border-bottom:1px solid rgba(255,255,255,.1);font-size:.88rem}
.est-line:last-of-type{border-bottom:none}
.est-total{display:flex;justify-content:space-between;padding:14px 0 0;font-size:1.1rem;font-weight:600;border-top:2px solid var(--gold)}
.est-total .price{font-family:'Playfair Display',serif;font-size:1.8rem;color:var(--gold)}
.est-note{font-size:.78rem;color:rgba(255,255,255,.6);margin-top:8px;font-style:italic}

/* Buttons */
.actions{display:flex;gap:8px;margin-bottom:16px}
.btn{flex:1;padding:14px;border:none;border-radius:10px;font-weight:600;font-size:.9rem;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:transform .15s,box-shadow .2s;font-family:'Work Sans',sans-serif}
.btn:active{transform:scale(.97)}
.btn:focus-visible{outline:2px solid var(--navy);outline-offset:2px}
.btn-primary{background:var(--gold);color:#1b3a5c}
.btn-primary:hover{box-shadow:0 4px 16px rgba(232,168,56,.3)}
.btn-secondary{background:var(--surface);color:var(--text);border:1px solid var(--border)}
.btn-secondary:hover{border-color:var(--navy)}

/* History */
.history-item{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:12px;margin-bottom:8px}
.history-item .hi-top{display:flex;justify-content:space-between;margin-bottom:4px}
.history-item .hi-name{font-weight:600;font-size:.9rem}
.history-item .hi-price{font-family:'Playfair Display',serif;color:var(--gold-dark);font-size:1.1rem}
.history-item .hi-detail{font-size:.78rem;color:var(--muted);line-height:1.4}

/* Upsell */
.upsell-tab{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:20px;margin-bottom:16px;opacity:.5;position:relative}
.upsell-tab h2{font-size:1.1rem;color:var(--muted);margin-bottom:8px}
.upsell-tab p{font-size:.85rem;color:var(--muted);line-height:1.5}
.coming-soon-badge{display:inline-block;background:var(--gold);color:#1b3a5c;padding:2px 10px;border-radius:4px;font-size:.65rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;margin-left:8px}

/* Toast */
.toast-container{position:fixed;top:80px;right:16px;z-index:9000}
.toast{background:var(--safe);color:#fff;padding:12px 20px;border-radius:8px;font-size:.85rem;opacity:0;transform:translateY(-10px);transition:opacity .3s,transform .3s;box-shadow:0 4px 16px rgba(0,0,0,.15)}
.toast.show{opacity:1;transform:translateY(0)}

/* Bottom nav */
.bottom-nav{position:fixed;bottom:60px;left:0;right:0;background:var(--surface);border-top:1px solid var(--border);display:flex;z-index:100;padding:4px 0;box-shadow:0 -2px 8px rgba(27,58,92,.06)}
.bottom-nav button{flex:1;background:none;border:none;color:var(--muted);padding:8px 4px;font-size:.65rem;text-transform:uppercase;letter-spacing:.06em;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:4px;font-family:'Work Sans',sans-serif;font-weight:500}
.bottom-nav button.active{color:var(--navy)}
.bottom-nav button:focus-visible{outline:2px solid var(--navy);outline-offset:-2px}
.bottom-nav svg{width:22px;height:22px}

.section{display:none}
.section.active{display:block}

@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.animate-in{animation:fadeUp .4s ease-out both}
.animate-in:nth-child(2){animation-delay:60ms}
.animate-in:nth-child(3){animation-delay:120ms}

/* Print */
@media print{
.bottom-nav,.app-header,.wave-divider,.demo-banner,.actions,.upsell-tab,.toast-container,.voice-area,#bct-demo-disclaimer{display:none!important}
body{background:#fff;padding:20px}
.card,.estimate-summary{box-shadow:none;border:1px solid #ccc}
.estimate-summary{background:#1b3a5c;color:#fff;-webkit-print-color-adjust:exact;print-color-adjust:exact}
}

@media(min-width:768px){
main{max-width:600px;margin:0 auto}
.bottom-nav{display:none}
}
</style>
</head>
<body>
<a href="#main-content" class="skip-link">Skip to main content</a>
<header class="app-header">
<h1>DockQuote</h1>
<p>Deckhand Detailing -- Seattle, WA</p>
</header>
<div class="wave-divider"></div>

<div class="demo-banner" id="demoBanner" role="status">
<p>Sample data for Seattle marinas. Tap x to clear and add your own.</p>
<button onclick="clearDemo()" aria-label="Clear demo data">Clear</button>
</div>

<div class="toast-container" aria-live="polite"><div class="toast" id="toast"></div></div>

<main id="main-content">

<!-- ESTIMATE TAB -->
<section class="section active" id="sec-estimate">

<div class="card animate-in">
<h2>Boat Details</h2>
<div class="form-row">
<div class="form-group">
<label for="ownerName">Owner Name</label>
<input type="text" id="ownerName" placeholder="e.g. David Thompson" autocomplete="off">
</div>
<div class="form-group">
<label for="ownerPhone">Phone</label>
<input type="tel" id="ownerPhone" placeholder="(206) 555-0123">
</div>
</div>
<div class="form-row">
<div class="form-group">
<label for="boatLength">Length (ft)</label>
<input type="number" id="boatLength" min="10" max="200" value="44" placeholder="44">
</div>
<div class="form-group">
<label for="boatType">Boat Type</label>
<select id="boatType" aria-label="Boat type">
<option value="sailboat">Sailboat</option>
<option value="powerboat">Powerboat / Cruiser</option>
<option value="yacht">Yacht (60ft+)</option>
<option value="fishing">Fishing Boat</option>
<option value="pontoon">Pontoon</option>
<option value="other">Other</option>
</select>
</div>
</div>
<div class="form-row">
<div class="form-group">
<label for="marina">Marina</label>
<select id="marina" aria-label="Marina">
<option value="shilshole">Shilshole Bay Marina</option>
<option value="elliott">Elliott Bay Marina</option>
<option value="lakeunion">Lake Union</option>
<option value="westlake">Westlake Marina</option>
<option value="portage">Portage Bay</option>
<option value="other">Other</option>
</select>
</div>
<div class="form-group">
<label for="slipNum">Slip #</label>
<input type="text" id="slipNum" placeholder="e.g. D-47">
</div>
</div>
<div class="form-group">
<label for="boatName">Boat Name</label>
<input type="text" id="boatName" placeholder='e.g. "Catalina Dreams"'>
</div>
</div>

<div class="card animate-in">
<h2>Services</h2>
<p style="font-size:.8rem;color:var(--muted);margin-bottom:12px">Prices auto-calculate based on boat length. Check what the customer needs.</p>
<div class="service-list" id="serviceList" role="group" aria-label="Available detailing services"></div>
</div>

<div class="card animate-in">
<h2>Notes and Photos</h2>
<div class="voice-area">
<button class="voice-btn" id="voiceBtn" onclick="toggleVoice()" aria-label="Start voice note">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z"/><path d="M19 10v2a7 7 0 01-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>
Tap to dictate notes (hands-free on the dock)
</button>
<div class="voice-result" id="voiceResult" contenteditable="true" role="textbox" aria-label="Condition notes"></div>
</div>
<p style="font-size:.72rem;color:var(--muted);margin:12px 0 4px;text-transform:uppercase;letter-spacing:.06em;font-weight:500">Condition Photos</p>
<div class="photo-grid" id="photoGrid">
<div class="photo-slot" tabindex="0" role="button" aria-label="Add hull photo" onclick="takePhoto(0)">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="12" cy="12" r="3"/><path d="M3 16l4-4 4 4 4-4 5 5"/></svg>
<span>Hull</span>
</div>
<div class="photo-slot" tabindex="0" role="button" aria-label="Add interior photo" onclick="takePhoto(1)">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="12" cy="12" r="3"/><path d="M3 16l4-4 4 4 4-4 5 5"/></svg>
<span>Interior</span>
</div>
<div class="photo-slot" tabindex="0" role="button" aria-label="Add teak photo" onclick="takePhoto(2)">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="12" cy="12" r="3"/><path d="M3 16l4-4 4 4 4-4 5 5"/></svg>
<span>Teak / Deck</span>
</div>
<div class="photo-slot" tabindex="0" role="button" aria-label="Add extra photo" onclick="takePhoto(3)">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="12" cy="12" r="3"/><path d="M3 16l4-4 4 4 4-4 5 5"/></svg>
<span>Other</span>
</div>
</div>
<input type="file" id="photoInput" accept="image/*" capture="environment" style="display:none" onchange="handlePhoto(event)">
</div>

<div class="estimate-summary animate-in" id="estimateSummary">
<h2>Estimate</h2>
<div id="estLines"></div>
<div class="est-total"><span>Total</span><span class="price" id="estTotal">$0</span></div>
<div class="est-note">Prices based on <span id="estLength">44</span>-ft <span id="estType">Sailboat</span> at <span id="estMarina">Shilshole Bay</span></div>
</div>

<div class="actions animate-in">
<button class="btn btn-primary" onclick="shareEstimate()" aria-label="Share this estimate">
<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>
Share Estimate
</button>
<button class="btn btn-secondary" onclick="saveEstimate()" aria-label="Save this estimate">
<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/></svg>
Save
</button>
</div>
</section>

<!-- HISTORY TAB -->
<section class="section" id="sec-history">
<div class="card">
<h2>Saved Estimates</h2>
<div id="historyList"></div>
</div>
<div class="upsell-tab" aria-disabled="true">
<h2>Job History and Reports <span class="coming-soon-badge">Coming Soon</span></h2>
<p>Track completed jobs, total revenue per marina, and repeat customer frequency. See which services sell best and when your busiest months are. Available in the full version.</p>
</div>
</section>

<!-- SETTINGS TAB -->
<section class="section" id="sec-settings">
<div class="card">
<h2>Per-Foot Pricing</h2>
<p style="font-size:.82rem;color:var(--muted);margin-bottom:12px">Set your cost per foot for each service. The tool multiplies by boat length automatically.</p>
<div id="pricingInputs"></div>
<button class="btn btn-primary" onclick="savePricing()" style="margin-top:12px;width:100%">Save Pricing</button>
</div>
<div class="card" style="margin-top:16px">
<h2>Data</h2>
<div class="actions" style="margin-bottom:0">
<button class="btn btn-secondary" onclick="exportData()" aria-label="Export data">Export JSON</button>
<button class="btn btn-secondary" onclick="document.getElementById('importFile').click()" aria-label="Import data">Import JSON</button>
<input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
</div>
</div>
</section>

</main>

<!-- Bottom nav -->
<nav class="bottom-nav" aria-label="Main navigation">
<button class="active" data-tab="sec-estimate" onclick="switchTab(this)" aria-label="Estimate builder">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
Estimate
</button>
<button data-tab="sec-history" onclick="switchTab(this)" aria-label="Saved estimates">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
History
</button>
<button data-tab="sec-settings" onclick="switchTab(this)" aria-label="Settings">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg>
Settings
</button>
</nav>

<!-- DEMO DISCLAIMER -->
<div id="bct-demo-disclaimer" role="contentinfo" aria-label="Demo disclaimer" style="position:fixed;bottom:0;left:0;right:0;background:#f8f8f8;border-top:1px solid #ddd;padding:10px 16px;font-size:12px;line-height:1.4;color:#666;z-index:99999;display:flex;flex-wrap:wrap;align-items:center;justify-content:center;gap:8px 16px;text-align:center;">
<p style="margin:0;max-width:700px;"><strong style="color:#333;">DEMO NOTICE:</strong> This tool was created by BennyCuTools as a free demonstration only. It is not affiliated with, endorsed by, or authorized by Deckhand Detailing. All brand references are used solely for demonstration purposes.</p>
<a href="mailto:cuuper225@gmail.com?subject=Delete%20Demo%3A%20Deckhand%20Detailing&body=I%20am%20the%20owner%20and%20I%20request%20permanent%20deletion%20of%20this%20demo." style="display:inline-flex;align-items:center;gap:4px;background:#dc3545;color:#fff;padding:5px 12px;border-radius:4px;text-decoration:none;font-size:11px;font-weight:500;white-space:nowrap;">
<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>
Request Permanent Deletion
</a>
</div>

<script>
// Access key gate
function _h(s){let h=0;for(let i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i);h|=0;}return h;}
const _V=816097690;
const _k=new URLSearchParams(window.location.search).get('key');
if(!_k||_h(_k)!==_V){
document.body.innerHTML='<div style="display:flex;align-items:center;justify-content:center;height:100vh;font-family:sans-serif;background:#f7f9fc;color:#1b3a5c;text-align:center;padding:20px"><div><h1 style="font-size:2rem;margin-bottom:1rem;font-family:Playfair Display,serif">Access Required</h1><p style="color:#6b7f96">This tool requires a valid access key.</p><p style="margin-top:1rem"><a href="mailto:ben@bennycutools.com" style="color:#1b3a5c">ben@bennycutools.com</a></p></div></div><div id="bct-demo-disclaimer" role="contentinfo" style="position:fixed;bottom:0;left:0;right:0;background:#f8f8f8;border-top:1px solid #ddd;padding:10px 16px;font-size:12px;color:#666;z-index:99999;text-align:center"><p style="margin:0"><strong style="color:#333;">DEMO NOTICE:</strong> This tool was created by BennyCuTools as a free demonstration only. Not affiliated with Deckhand Detailing.</p></div>';
throw new Error('Invalid key');
}

// Services config
const defaultServices=[
{id:'hull',name:'Hull Wash and Polish',desc:'Pressure wash, compound, polish. Removes waterline stain, oxidation.',perFt:6.50,checked:true},
{id:'interior',name:'Interior Deep Clean',desc:'Cabin, galley, head. All surfaces wiped, vacuumed, deodorized.',perFt:5.00,checked:true},
{id:'teak',name:'Teak Restoration',desc:'Sand, clean, and seal all teak decking and trim.',perFt:8.00,checked:false},
{id:'canvas',name:'Canvas and Cushion Care',desc:'Clean, waterproof, and UV-protect all canvas and cushion covers.',perFt:3.50,checked:false},
{id:'brightwork',name:'Brightwork Polish',desc:'Chrome, stainless, and aluminum polished to mirror finish.',perFt:4.00,checked:false},
{id:'bottom',name:'Bottom Paint Prep',desc:'Scrape, sand, and prep hull bottom for new anti-fouling paint.',perFt:7.00,checked:false},
];

let services=[...defaultServices.map(s=>({...s}))];
let photos=[null,null,null,null];
let currentPhotoSlot=0;
let pricing={};

// DB
let db;
const DB_NAME='DockQuoteDB';const DB_VER=1;const STORE='estimates';const PRICING_STORE='pricing';
function openDB(){return new Promise((res,rej)=>{const r=indexedDB.open(DB_NAME,DB_VER);r.onupgradeneeded=e=>{const d=e.target.result;if(!d.objectStoreNames.contains(STORE))d.createObjectStore(STORE,{keyPath:'id',autoIncrement:true});if(!d.objectStoreNames.contains(PRICING_STORE))d.createObjectStore(PRICING_STORE,{keyPath:'key'});};r.onsuccess=e=>{db=e.target.result;res(db)};r.onerror=e=>rej(e)})}
function dbPut(store,data){return new Promise((res,rej)=>{const tx=db.transaction(store,'readwrite');tx.objectStore(store).put(data);tx.oncomplete=()=>res();tx.onerror=e=>rej(e)})}
function dbGetAll(store){return new Promise((res,rej)=>{const tx=db.transaction(store,'readonly');const r=tx.objectStore(store).getAll();r.onsuccess=()=>res(r.result);r.onerror=e=>rej(e)})}
function dbClear(store){return new Promise((res,rej)=>{const tx=db.transaction(store,'readwrite');tx.objectStore(store).clear();tx.oncomplete=()=>res();tx.onerror=e=>rej(e)})}

// Init
(async function(){
await openDB();
await loadPricing();
buildServiceList();
buildPricingInputs();
const isFirst=!localStorage.getItem('dockquote_visited');
if(isFirst){loadDemoData();localStorage.setItem('dockquote_visited','1')}
updateEstimate();
loadHistory();

// Auto-detect marina via geolocation
if(navigator.geolocation){
navigator.geolocation.getCurrentPosition(pos=>{
const lat=pos.coords.latitude,lon=pos.coords.longitude;
// Rough marina detection for Seattle area
if(lat>47.68&&lat<47.70&&lon>-122.41&&lon<-122.39)document.getElementById('marina').value='shilshole';
else if(lat>47.62&&lat<47.64&&lon>-122.39&&lon<-122.37)document.getElementById('marina').value='elliott';
else if(lat>47.63&&lat<47.65&&lon>-122.34&&lon<-122.33)document.getElementById('marina').value='lakeunion';
},()=>{},{timeout:5000,maximumAge:60000});
}
})();

async function loadPricing(){try{const p=await dbGetAll(PRICING_STORE);if(p.length){p.forEach(r=>{if(r.key==='svcPricing')pricing=r.data})}
services.forEach(s=>{if(pricing[s.id]!==undefined)s.perFt=pricing[s.id]})}catch(e){}}

function buildServiceList(){
const el=document.getElementById('serviceList');
el.innerHTML=services.map(s=>`
<label class="service-item ${s.checked?'checked':''}" for="svc_${s.id}">
<input type="checkbox" id="svc_${s.id}" ${s.checked?'checked':''} onchange="toggleService('${s.id}',this)">
<div class="svc-info"><div class="svc-name">${s.name}</div><div class="svc-desc">${s.desc}</div></div>
<div class="svc-price" id="price_${s.id}">$${calcSvcPrice(s)}</div>
</label>`).join('');
}

function calcSvcPrice(svc){const len=+document.getElementById('boatLength').value||44;return Math.round(svc.perFt*len)}

function toggleService(id,cb){
const svc=services.find(s=>s.id===id);if(svc)svc.checked=cb.checked;
cb.closest('.service-item').classList.toggle('checked',cb.checked);
updateEstimate();
}

function updateEstimate(){
const len=+document.getElementById('boatLength').value||44;
const checked=services.filter(s=>s.checked);
const el=document.getElementById('estLines');
let total=0;
el.innerHTML=checked.map(s=>{const p=calcSvcPrice(s);total+=p;return`<div class="est-line"><span>${s.name}</span><span>$${p}</span></div>`}).join('');
document.getElementById('estTotal').textContent='$'+total;
document.getElementById('estLength').textContent=len;
const typeNames={sailboat:'Sailboat',powerboat:'Powerboat',yacht:'Yacht',fishing:'Fishing Boat',pontoon:'Pontoon',other:'Boat'};
document.getElementById('estType').textContent=typeNames[document.getElementById('boatType').value]||'Boat';
const marinaNames={shilshole:'Shilshole Bay',elliott:'Elliott Bay',lakeunion:'Lake Union',westlake:'Westlake',portage:'Portage Bay',other:'Marina'};
document.getElementById('estMarina').textContent=marinaNames[document.getElementById('marina').value]||'Marina';
// Update individual prices
services.forEach(s=>{const pe=document.getElementById('price_'+s.id);if(pe)pe.textContent='$'+calcSvcPrice(s)});
}

// Listeners for live price updates
['boatLength','boatType','marina'].forEach(id=>{document.getElementById(id).addEventListener('change',updateEstimate);document.getElementById(id).addEventListener('input',updateEstimate)});

// Voice notes
let recognition=null;let isRecording=false;
function toggleVoice(){
if(!('webkitSpeechRecognition' in window||'SpeechRecognition' in window)){
showToast('Voice not available in this browser');return;
}
const btn=document.getElementById('voiceBtn');
if(isRecording){recognition.stop();isRecording=false;btn.classList.remove('recording');btn.innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z"/><path d="M19 10v2a7 7 0 01-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>Tap to dictate notes (hands-free on the dock)';return}
const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
recognition=new SR();recognition.continuous=true;recognition.interimResults=true;recognition.lang='en-US';
const result=document.getElementById('voiceResult');
recognition.onresult=e=>{let t='';for(let i=0;i<e.results.length;i++)t+=e.results[i][0].transcript;result.textContent=t};
recognition.onerror=()=>{isRecording=false;btn.classList.remove('recording')};
recognition.onend=()=>{isRecording=false;btn.classList.remove('recording');btn.innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z"/><path d="M19 10v2a7 7 0 01-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>Tap to dictate notes (hands-free on the dock)'};
recognition.start();isRecording=true;btn.classList.add('recording');
btn.innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="red" stroke-width="2"><circle cx="12" cy="12" r="6"/></svg>Recording... tap to stop';
}

// Photos
function takePhoto(slot){currentPhotoSlot=slot;document.getElementById('photoInput').click()}
function handlePhoto(e){
const file=e.target.files[0];if(!file)return;
const reader=new FileReader();
reader.onload=function(ev){
photos[currentPhotoSlot]=ev.target.result;
renderPhotos();
};
reader.readAsDataURL(file);
e.target.value='';
}

function renderPhotos(){
const labels=['Hull','Interior','Teak / Deck','Other'];
const grid=document.getElementById('photoGrid');
grid.innerHTML=photos.map((p,i)=>{
if(p)return`<div class="photo-slot" tabindex="0" role="button" aria-label="${labels[i]} photo" onclick="takePhoto(${i})"><img src="${p}" alt="${labels[i]} photo"><button class="remove-photo" onclick="event.stopPropagation();removePhoto(${i})" aria-label="Remove ${labels[i]} photo">x</button></div>`;
return`<div class="photo-slot" tabindex="0" role="button" aria-label="Add ${labels[i]} photo" onclick="takePhoto(${i})"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="12" cy="12" r="3"/><path d="M3 16l4-4 4 4 4-4 5 5"/></svg><span>${labels[i]}</span></div>`;
}).join('');
}
function removePhoto(i){photos[i]=null;renderPhotos()}

// Share
async function shareEstimate(){
const text=buildEstimateText();
if(navigator.share){try{await navigator.share({title:'Deckhand Detailing Estimate',text});showToast('Estimate shared')}catch(e){}}
else{try{await navigator.clipboard.writeText(text);showToast('Estimate copied to clipboard')}catch(e){showToast('Could not share')}}
}

function buildEstimateText(){
const name=document.getElementById('ownerName').value||'Customer';
const len=document.getElementById('boatLength').value;
const type=document.getElementById('boatType').selectedOptions[0].text;
const marina=document.getElementById('marina').selectedOptions[0].text;
const slip=document.getElementById('slipNum').value;
const boat=document.getElementById('boatName').value;
const checked=services.filter(s=>s.checked);
let total=0;
const lines=checked.map(s=>{const p=calcSvcPrice(s);total+=p;return`  ${s.name}: $${p}`}).join('\n');
const notes=document.getElementById('voiceResult').textContent.trim();
return`Deckhand Detailing - Estimate\nPrepared for: ${name}\n${boat?'Vessel: '+boat+'\n':''}${len}ft ${type} at ${marina}${slip?' (Slip '+slip+')':''}\n\nServices:\n${lines}\n\nTotal: $${total}${notes?'\n\nNotes: '+notes:''}\n\nDeckhand Detailing - Seattle, WA\n(425) 406-4084\ndeckhanddetailing.com`;
}

// Save
async function saveEstimate(){
const est={
name:document.getElementById('ownerName').value||'Walk-in',
phone:document.getElementById('ownerPhone').value,
boatName:document.getElementById('boatName').value,
length:+document.getElementById('boatLength').value,
type:document.getElementById('boatType').value,
marina:document.getElementById('marina').value,
slip:document.getElementById('slipNum').value,
services:services.filter(s=>s.checked).map(s=>({id:s.id,name:s.name,price:calcSvcPrice(s)})),
total:services.filter(s=>s.checked).reduce((sum,s)=>sum+calcSvcPrice(s),0),
notes:document.getElementById('voiceResult').textContent.trim(),
date:new Date().toISOString(),
isDemo:false
};
await dbPut(STORE,est);showToast('Estimate saved');loadHistory();
}

async function loadHistory(){
const ests=await dbGetAll(STORE);
const el=document.getElementById('historyList');
if(!ests.length){el.innerHTML='<p style="color:var(--muted);font-size:.85rem;padding:12px">No saved estimates yet.</p>';return}
ests.sort((a,b)=>new Date(b.date)-new Date(a.date));
const marinaNames={shilshole:'Shilshole Bay',elliott:'Elliott Bay',lakeunion:'Lake Union',westlake:'Westlake',portage:'Portage Bay',other:'Other'};
el.innerHTML=ests.map(e=>`<div class="history-item"><div class="hi-top"><span class="hi-name">${esc(e.name)}${e.boatName?' - '+esc(e.boatName):''}</span><span class="hi-price">$${e.total}</span></div><div class="hi-detail">${e.length}ft ${e.type} at ${marinaNames[e.marina]||e.marina} | ${e.services.length} services | ${new Date(e.date).toLocaleDateString()}</div></div>`).join('');
}

function esc(s){const d=document.createElement('div');d.textContent=s;return d.innerHTML}

// Demo data
function loadDemoData(){
document.getElementById('ownerName').value='David Thompson';
document.getElementById('ownerPhone').value='(206) 555-0289';
document.getElementById('boatLength').value='44';
document.getElementById('boatType').value='sailboat';
document.getElementById('marina').value='shilshole';
document.getElementById('slipNum').value='D-47';
document.getElementById('boatName').value='Wind Dancer';
document.getElementById('voiceResult').textContent='Hull has heavy oxidation on port side, waterline staining around the bow. Teak needs sanding, two coats minimum. Canvas is weathered on the bimini but the cockpit cushions are fine.';
services[0].checked=true;services[1].checked=true;services[2].checked=true;services[3].checked=true;
buildServiceList();updateEstimate();

// Add some history
const demos=[
{name:'David Thompson',boatName:'Wind Dancer',length:44,type:'sailboat',marina:'shilshole',slip:'D-47',services:[{id:'hull',name:'Hull Wash and Polish',price:286},{id:'interior',name:'Interior Deep Clean',price:220},{id:'teak',name:'Teak Restoration',price:352}],total:858,notes:'Spring detail, heavy oxidation.',date:new Date(Date.now()-86400000).toISOString(),isDemo:true},
{name:'Karen Liu',boatName:'Pacific Dreamer',length:38,type:'powerboat',marina:'elliott',slip:'B-12',services:[{id:'hull',name:'Hull Wash and Polish',price:247},{id:'brightwork',name:'Brightwork Polish',price:152}],total:399,notes:'Monthly maintenance wash.',date:new Date(Date.now()-259200000).toISOString(),isDemo:true},
{name:'James Okafor',boatName:'The Office',length:52,type:'yacht',marina:'lakeunion',slip:'A-03',services:[{id:'hull',name:'Hull Wash and Polish',price:338},{id:'interior',name:'Interior Deep Clean',price:260},{id:'teak',name:'Teak Restoration',price:416},{id:'canvas',name:'Canvas and Cushion Care',price:182},{id:'brightwork',name:'Brightwork Polish',price:208}],total:1404,notes:'Full spring overhaul before sailing season.',date:new Date(Date.now()-604800000).toISOString(),isDemo:true}
];
(async()=>{for(const d of demos)await dbPut(STORE,d);loadHistory()})();
}

async function clearDemo(){
const all=await dbGetAll(STORE);const keep=all.filter(e=>!e.isDemo);
await dbClear(STORE);for(const e of keep)await dbPut(STORE,e);
document.getElementById('demoBanner').style.display='none';
document.getElementById('ownerName').value='';document.getElementById('ownerPhone').value='';
document.getElementById('boatName').value='';document.getElementById('slipNum').value='';
document.getElementById('voiceResult').textContent='';
services.forEach(s=>s.checked=false);services[0].checked=true;
buildServiceList();updateEstimate();loadHistory();showToast('Demo data cleared');
}

// Pricing settings
function buildPricingInputs(){
const el=document.getElementById('pricingInputs');
el.innerHTML=services.map(s=>`<div class="form-row"><div class="form-group"><label for="pp_${s.id}">${s.name} ($/ft)</label><input type="number" id="pp_${s.id}" value="${s.perFt}" min="0" step="0.25"></div></div>`).join('');
}

async function savePricing(){
const data={};services.forEach(s=>{const v=+document.getElementById('pp_'+s.id).value;if(v>=0){s.perFt=v;data[s.id]=v}});
await dbPut(PRICING_STORE,{key:'svcPricing',data});
buildServiceList();updateEstimate();showToast('Pricing saved');
}

// Tab switching
function switchTab(btn){
document.querySelectorAll('.bottom-nav button').forEach(b=>b.classList.remove('active'));
btn.classList.add('active');
document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
document.getElementById(btn.dataset.tab).classList.add('active');
if(btn.dataset.tab==='sec-history')loadHistory();
}

// Export/Import
async function exportData(){
const estimates=await dbGetAll(STORE);const blob=new Blob([JSON.stringify({estimates,services:services.map(s=>({id:s.id,perFt:s.perFt}))},null,2)],{type:'application/json'});
const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='dockquote-backup.json';a.click();URL.revokeObjectURL(url);showToast('Data exported');
}

async function importData(e){
const file=e.target.files[0];if(!file)return;
try{const text=await file.text();const data=JSON.parse(text);
if(data.estimates){await dbClear(STORE);for(const est of data.estimates)await dbPut(STORE,est)}
if(data.services){data.services.forEach(s=>{const svc=services.find(x=>x.id===s.id);if(svc)svc.perFt=s.perFt})}
buildServiceList();updateEstimate();loadHistory();showToast('Data imported')}catch(err){showToast('Import failed')}
e.target.value='';
}

function showToast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500)}
</script>
<script src="https://book.bennycutools.com/tracker.js" async></script>
</body>
</html>
