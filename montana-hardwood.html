<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex,nofollow">
    <title>Hardwood Floor Project Estimator | Montana Hardwood Floor Company ‚Äî Billings, MT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        wood: { 50:'#fdf8f0', 100:'#f9ecda', 200:'#f0d4b0', 300:'#e4b87a', 400:'#d49a4e', 500:'#b07830', 600:'#8d5f24', 700:'#6d4a1c', 800:'#4a3313', 900:'#2c1f0b' },
                        dark: { 700:'#2a1f16', 800:'#1a1310', 900:'#0d0a07' }
                    },
                    fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] }
                }
            }
        }
    </script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .step-enter{animation:stepIn .35s ease-out}@keyframes stepIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
        .pulse-glow{animation:glow 2s ease-in-out infinite alternate}@keyframes glow{from{box-shadow:0 0 8px rgba(176,120,48,.3)}to{box-shadow:0 0 20px rgba(176,120,48,.5)}}
    </style>

    <style>
    /* Kimi UI/UX Improvements */
    .fade-in-up { animation: fadeInUp 0.4s ease-out forwards; }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    .radio-option, [class*="option"], [class*="choice"] { 
        min-height: 52px; transition: all 0.15s ease !important; 
    }
    .radio-option:active, [class*="option"]:active { transform: scale(0.98); }
    .btn-primary:active, [class*="btn"]:active { transform: translateY(1px); }
    /* Better progress bar */
    [class*="progress"] { height: 6px !important; border-radius: 3px; }
    </style>
    
</head>
<body class="bg-dark-900 text-white font-sans min-h-screen">

    <header class="bg-dark-800/90 backdrop-blur border-b border-dark-700/50">
        <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-wood-500 rounded-lg flex items-center justify-center">
                    <i data-lucide="tree-pine" class="w-5 h-5 text-white"></i>
                </div>
                <div>
                    <h1 class="font-bold text-lg leading-tight">Montana Hardwood Floor Co.</h1>
                    <p class="text-xs text-gray-400">Billings, MT ‚Ä¢ Since 1977 ‚Ä¢ (406) 690-8773</p>
                </div>
            </div>
            <span class="text-xs bg-wood-500/20 text-wood-300 px-3 py-1 rounded-full font-medium">~50 Years</span>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 py-8">
        <div class="text-center mb-10">
            <div class="inline-flex items-center gap-2 bg-dark-800 rounded-full px-4 py-2 mb-4">
                <i data-lucide="calculator" class="w-4 h-4 text-wood-400"></i>
                <span class="text-sm text-gray-400">Instant Estimator</span>
            </div>
            <h2 class="text-3xl md:text-4xl font-extrabold mb-3">Hardwood Floor<br><span class="text-wood-400">Project Estimator</span></h2>
            <p class="text-gray-400 max-w-lg mx-auto">New installation, refinishing, or repair ‚Äî get a ballpark cost and compare wood species for Montana's climate.</p>
        </div>

        <!-- Step 1: Project Type -->
        <div id="step1" class="step-enter">
            <div class="bg-dark-800/60 border border-dark-700/50 rounded-2xl p-6 md:p-8 mb-6">
                <h3 class="text-xl font-bold mb-1 flex items-center gap-2"><i data-lucide="hammer" class="w-5 h-5 text-wood-400"></i> Project Type</h3>
                <p class="text-sm text-gray-400 mb-6">What are you looking to do?</p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-3" id="projGrid">
                    <button onclick="selProj(this,'install')" class="prj-btn bg-dark-700/50 border border-dark-700 rounded-xl p-5 text-center hover:border-wood-500/50 transition-all">
                        <div class="text-3xl mb-2">ü™µ</div>
                        <div class="font-bold">New Installation</div>
                        <div class="text-xs text-gray-400 mt-1">Brand new hardwood floors</div>
                    </button>
                    <button onclick="selProj(this,'refinish')" class="prj-btn bg-dark-700/50 border border-dark-700 rounded-xl p-5 text-center hover:border-wood-500/50 transition-all">
                        <div class="text-3xl mb-2">‚ú®</div>
                        <div class="font-bold">Refinishing</div>
                        <div class="text-xs text-gray-400 mt-1">Sand & refinish existing floors</div>
                    </button>
                    <button onclick="selProj(this,'repair')" class="prj-btn bg-dark-700/50 border border-dark-700 rounded-xl p-5 text-center hover:border-wood-500/50 transition-all">
                        <div class="text-3xl mb-2">üîß</div>
                        <div class="font-bold">Repair</div>
                        <div class="text-xs text-gray-400 mt-1">Fix damaged sections</div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 2: Details -->
        <div id="step2" class="hidden step-enter">
            <div class="bg-dark-800/60 border border-dark-700/50 rounded-2xl p-6 md:p-8 mb-6" id="detailsPanel"></div>
            <div class="flex justify-between">
                <button onclick="goStep(1)" class="text-gray-400 hover:text-white font-medium px-6 py-3 transition-all">‚Üê Back</button>
                <button onclick="calcEst()" class="bg-wood-500 hover:bg-wood-400 text-white font-bold px-8 py-3 rounded-xl transition-all pulse-glow">See My Estimate ‚Üí</button>
            </div>
        </div>

        <!-- Step 3: Results -->
        <div id="step3" class="hidden step-enter">
            <div class="bg-dark-800/60 border border-dark-700/50 rounded-2xl p-6 md:p-8 mb-6">
                <div class="text-center mb-6">
                    <div class="inline-flex items-center gap-2 bg-green-500/20 text-green-400 rounded-full px-4 py-2 text-sm font-medium mb-3"><i data-lucide="check-circle" class="w-4 h-4"></i> Estimate Ready</div>
                    <h3 class="text-2xl font-bold" id="resultTitle">Your Hardwood Floor Estimate</h3>
                </div>

                <div class="bg-dark-900/60 rounded-xl p-6 mb-6 text-center">
                    <div class="text-sm text-gray-400 mb-1">Estimated Project Cost</div>
                    <div class="text-4xl md:text-5xl font-extrabold text-wood-400" id="totalCost">$4,500 ‚Äì $7,200</div>
                    <div class="text-sm text-gray-400 mt-2" id="perSqftCost"></div>
                </div>

                <div class="space-y-2 mb-6" id="breakdown"></div>

                <!-- Refinish vs Replace (conditional) -->
                <div id="refinishCompare" class="hidden bg-wood-500/10 border border-wood-500/30 rounded-xl p-5 mb-6">
                    <h4 class="font-bold text-wood-300 text-sm mb-3 flex items-center gap-2"><i data-lucide="scale" class="w-4 h-4"></i> Refinish vs. Replace Comparison</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center bg-green-500/10 rounded-lg p-3">
                            <div class="text-xs text-gray-400 mb-1">Refinishing</div>
                            <div class="text-xl font-bold text-green-400" id="refinishCost">$2,100</div>
                            <div class="text-xs text-gray-400 mt-1">Save your existing floors</div>
                        </div>
                        <div class="text-center bg-wood-500/10 rounded-lg p-3">
                            <div class="text-xs text-gray-400 mb-1">Full Replacement</div>
                            <div class="text-xl font-bold text-wood-400" id="replaceCost">$6,800</div>
                            <div class="text-xs text-gray-400 mt-1">Brand new hardwood</div>
                        </div>
                    </div>
                    <p class="text-xs text-gray-300 mt-3" id="refinishAdvice"></p>
                </div>

                <!-- Species Comparison -->
                <div class="bg-dark-700/30 rounded-xl p-5 mb-6" id="speciesCompareSection">
                    <h4 class="font-semibold text-sm mb-3 flex items-center gap-2"><i data-lucide="trees" class="w-4 h-4 text-wood-400"></i> Wood Species Comparison</h4>
                    <div class="space-y-2" id="speciesCompare"></div>
                </div>

                <!-- Montana Climate Note -->
                <div class="bg-blue-500/10 border border-blue-500/30 rounded-xl p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <i data-lucide="mountain-snow" class="w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"></i>
                        <div>
                            <div class="font-semibold text-blue-400 text-sm">Montana Climate Consideration</div>
                            <p class="text-xs text-gray-300 mt-1">Montana's dry winters and wide temperature swings require proper acclimation and humidity control for hardwood floors. Montana Hardwood Floor Company has nearly 50 years of experience with local conditions ‚Äî they know exactly how to install and finish floors that perform in our climate.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lead Form -->
            <div id="leadForm" class="bg-gradient-to-br from-wood-600/20 to-dark-800/60 border border-wood-500/30 rounded-2xl p-6 md:p-8 mb-6">
                <h3 class="text-xl font-bold mb-2 text-center">Get Your Free Estimate</h3>
                <p class="text-sm text-gray-400 text-center mb-6">Nearly 50 years of hardwood excellence. Serving Montana & Wyoming.</p>
                <div class="space-y-4 max-w-md mx-auto">
                    <div class="grid grid-cols-2 gap-3">
                        <div><label class="block text-xs font-medium text-gray-300 mb-1">Name *</label><input type="text" id="leadName" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-gray-500 focus:border-wood-500 focus:outline-none" placeholder="Your name"></div>
                        <div><label class="block text-xs font-medium text-gray-300 mb-1">Phone *</label><input type="tel" id="leadPhone" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-gray-500 focus:border-wood-500 focus:outline-none" placeholder="(406) 555-0000"></div>
                    </div>
                    <div><label class="block text-xs font-medium text-gray-300 mb-1">Address / City</label><input type="text" id="leadAddr" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-gray-500 focus:border-wood-500 focus:outline-none" placeholder="Your location"></div>
                    <button onclick="submitLead()" id="submitBtn" class="w-full bg-wood-500 hover:bg-wood-400 text-white font-bold py-3 rounded-xl transition-all text-lg">Request Free Estimate</button>
                </div>
            </div>
            <div id="successMsg" class="hidden bg-green-500/20 border border-green-500/40 rounded-2xl p-8 text-center mb-6">
                <div class="text-4xl mb-3">‚úÖ</div>
                <h3 class="text-xl font-bold text-green-400 mb-2">Estimate Request Sent!</h3>
                <p class="text-gray-300">Montana Hardwood Floor Company will reach out to schedule your free estimate.</p>
                <p class="text-gray-400 text-sm mt-3">Call: <a href="tel:4066908773" class="text-wood-400 underline">(406) 690-8773</a> | Email: <a href="mailto:mtwoodfloors@gmail.com" class="text-wood-400 underline">mtwoodfloors@gmail.com</a></p>
            </div>
        </div>
    </main>

    <footer class="border-t border-dark-800 py-6 text-center text-xs text-gray-500">
        <p>Built for Montana Hardwood Floor Company ‚Ä¢ 210 Hallowell Lane, Billings, MT 59101</p>
        <p class="mt-1">Estimates are approximate. Final pricing determined during on-site consultation.</p>
    </footer>

    <script>
        let state = { project:null, sqft:500, species:null, finish:null, condition:null, rooms:[] };

        const SPECIES = {
            oak:     { label:'Red Oak', low:6, high:10, hardness:1290, durability:'High', climate:'Excellent for MT', popular:true },
            white:   { label:'White Oak', low:7, high:12, hardness:1360, durability:'Very High', climate:'Excellent for MT', popular:true },
            maple:   { label:'Maple', low:7, high:11, hardness:1450, durability:'Very High', climate:'Good ‚Äî monitor humidity' },
            hickory: { label:'Hickory', low:6, high:10, hardness:1820, durability:'Exceptional', climate:'Great for MT ‚Äî very stable' },
            cherry:  { label:'Cherry', low:8, high:14, hardness:950, durability:'Moderate', climate:'Good ‚Äî softer wood' },
            walnut:  { label:'Walnut', low:9, high:15, hardness:1010, durability:'Moderate', climate:'Good ‚Äî premium look' }
        };

        const FINISH = {
            poly: { label:'Polyurethane', mult:1, lifespan:'8-12 yrs between coats' },
            oilwax: { label:'Oil / Wax', mult:1.1, lifespan:'3-5 yrs between coats' },
            waterpoly: { label:'Water-Based Poly', mult:1.05, lifespan:'7-10 yrs between coats' }
        };

        function selProj(el,v) {
            state.project=v;
            document.querySelectorAll('.prj-btn').forEach(b=>{b.classList.remove('border-wood-500','bg-wood-500/10');b.classList.add('border-dark-700');});
            el.classList.add('border-wood-500','bg-wood-500/10'); el.classList.remove('border-dark-700');
            setTimeout(()=>{ buildDetails(v); goStep(2); }, 250);
        }

        function buildDetails(proj) {
            const panel = document.getElementById('detailsPanel');
            let html = '';

            if(proj==='install') {
                html = `
                <h3 class="text-xl font-bold mb-1 flex items-center gap-2"><i data-lucide="ruler" class="w-5 h-5 text-wood-400"></i> New Installation Details</h3>
                <p class="text-sm text-gray-400 mb-6">Help us size your project.</p>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-300 mb-3">Area (sq ft): <span id="sqftLabel" class="text-wood-400">500</span></label>
                    <input type="range" id="sqftSlider" min="100" max="3000" value="500" step="50" class="w-full" oninput="state.sqft=+this.value;document.getElementById('sqftLabel').textContent=this.value" style="-webkit-appearance:none;height:8px;border-radius:4px;background:#4a3313;">
                    <div class="flex justify-between text-xs text-gray-500 mt-1"><span>100</span><span>3,000 sq ft</span></div>
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-300 mb-3">Wood Species</label>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                        ${Object.entries(SPECIES).map(([k,s])=>`<button onclick="selSpecies(this,'${k}')" class="sp-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-wood-500/50 transition-all">
                            <div class="text-sm font-bold">${s.label}</div>
                            <div class="text-xs text-gray-400">$${s.low}-${s.high}/sq ft</div>
                            ${s.popular?'<div class="text-xs text-wood-400 mt-1">‚òÖ Popular</div>':''}
                        </button>`).join('')}
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-3">Finish Type</label>
                    <div class="grid grid-cols-3 gap-3">
                        ${Object.entries(FINISH).map(([k,f])=>`<button onclick="selFinish(this,'${k}')" class="fn-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-wood-500/50 transition-all">
                            <div class="text-sm font-medium">${f.label}</div>
                            <div class="text-xs text-gray-400">${f.lifespan}</div>
                        </button>`).join('')}
                    </div>
                </div>`;
            } else if(proj==='refinish') {
                html = `
                <h3 class="text-xl font-bold mb-1 flex items-center gap-2"><i data-lucide="sparkles" class="w-5 h-5 text-wood-400"></i> Refinishing Details</h3>
                <p class="text-sm text-gray-400 mb-6">Tell us about your existing floors.</p>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-300 mb-3">Area (sq ft): <span id="sqftLabel" class="text-wood-400">500</span></label>
                    <input type="range" id="sqftSlider" min="100" max="3000" value="500" step="50" class="w-full" oninput="state.sqft=+this.value;document.getElementById('sqftLabel').textContent=this.value" style="-webkit-appearance:none;height:8px;border-radius:4px;background:#4a3313;">
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-300 mb-3">Floor Condition</label>
                    <div class="grid grid-cols-3 gap-3">
                        ${[['good','Good','Minor wear/scratches'],['fair','Fair','Visible wear, dull finish'],['poor','Poor','Deep scratches, stains, damage']].map(([v,l,d])=>`<button onclick="selCond(this,'${v}')" class="cnd-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-wood-500/50 transition-all"><div class="text-sm font-bold">${l}</div><div class="text-xs text-gray-400">${d}</div></button>`).join('')}
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-3">Stain Change?</label>
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="selStain(this,false)" class="stn-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-wood-500/50 transition-all"><div class="text-sm font-medium">Same Color</div><div class="text-xs text-gray-400">Just refresh</div></button>
                        <button onclick="selStain(this,true)" class="stn-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-wood-500/50 transition-all"><div class="text-sm font-medium">New Color/Stain</div><div class="text-xs text-gray-400">Change the look</div></button>
                    </div>
                </div>`;
            } else {
                html = `
                <h3 class="text-xl font-bold mb-1 flex items-center gap-2"><i data-lucide="wrench" class="w-5 h-5 text-wood-400"></i> Repair Details</h3>
                <p class="text-sm text-gray-400 mb-6">What needs fixing?</p>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-300 mb-3">Repair Type</label>
                    <div class="grid grid-cols-2 gap-3">
                        ${[['boards','Replace Boards','A few damaged planks'],['patch','Patch Section','Small damaged area'],['water','Water Damage','Swelling, buckling, staining'],['gap','Gaps/Squeaks','Gaps between boards or squeaking']].map(([v,l,d])=>`<button onclick="selRepair(this,'${v}')" class="rep-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-wood-500/50 transition-all"><div class="text-sm font-bold">${l}</div><div class="text-xs text-gray-400">${d}</div></button>`).join('')}
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-3">Approximate Area</label>
                    <div class="grid grid-cols-3 gap-3">
                        ${[['small','Small','Under 50 sq ft'],['medium','Medium','50-200 sq ft'],['large','Large','200+ sq ft']].map(([v,l,d])=>`<button onclick="selRepairSize(this,'${v}')" class="rsz-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-wood-500/50 transition-all"><div class="text-sm font-bold">${l}</div><div class="text-xs text-gray-400">${d}</div></button>`).join('')}
                    </div>
                </div>`;
            }
            panel.innerHTML = html;
            lucide.createIcons();
        }

        function sel(cls,el){document.querySelectorAll('.'+cls).forEach(b=>{b.classList.remove('border-wood-500','bg-wood-500/10');b.classList.add('border-dark-700');});el.classList.add('border-wood-500','bg-wood-500/10');el.classList.remove('border-dark-700');}
        function selSpecies(el,v){state.species=v;sel('sp-btn',el);}
        function selFinish(el,v){state.finish=v;sel('fn-btn',el);}
        function selCond(el,v){state.condition=v;sel('cnd-btn',el);}
        function selStain(el,v){state.stainChange=v;sel('stn-btn',el);}
        function selRepair(el,v){state.repairType=v;sel('rep-btn',el);}
        function selRepairSize(el,v){state.repairSize=v;sel('rsz-btn',el);}

        function goStep(n){[1,2,3].forEach(i=>document.getElementById('step'+i).classList.add('hidden'));document.getElementById('step'+n).classList.remove('hidden');window.scrollTo({top:0,behavior:'smooth'});}

        function calcEst() {
            let low=0, high=0, title='', showRefComp=false;

            if(state.project==='install') {
                const sp = SPECIES[state.species||'oak'];
                const fn = FINISH[state.finish||'poly'];
                low = Math.round(sp.low * fn.mult * state.sqft / 100)*100;
                high = Math.round(sp.high * fn.mult * state.sqft / 100)*100;
                title = `New ${sp.label} Floor Installation`;
            } else if(state.project==='refinish') {
                const condMult = {good:1,fair:1.15,poor:1.4}[state.condition||'fair'];
                const stainAdd = state.stainChange ? 0.50 : 0;
                const baseLow = 3.00 + stainAdd, baseHigh = 5.50 + stainAdd;
                low = Math.round(baseLow * condMult * state.sqft / 50)*50;
                high = Math.round(baseHigh * condMult * state.sqft / 50)*50;
                title = 'Hardwood Floor Refinishing';
                showRefComp = true;
            } else {
                const sizes = {small:[200,600],medium:[500,1500],large:[1200,3500]};
                const typeMult = {boards:1,patch:0.8,water:1.3,gap:0.6}[state.repairType||'boards'];
                const sz = sizes[state.repairSize||'small'];
                low = Math.round(sz[0]*typeMult/50)*50;
                high = Math.round(sz[1]*typeMult/50)*50;
                title = 'Hardwood Floor Repair';
            }

            document.getElementById('resultTitle').textContent = title;
            document.getElementById('totalCost').textContent = `$${low.toLocaleString()} ‚Äì $${high.toLocaleString()}`;
            document.getElementById('perSqftCost').textContent = state.project!=='repair' ? `~$${(low/state.sqft).toFixed(2)} ‚Äì $${(high/state.sqft).toFixed(2)} per sq ft ‚Ä¢ ${state.sqft} sq ft` : '';

            // Breakdown
            const bd = document.getElementById('breakdown');
            let items = [['Project Type', title]];
            if(state.project==='install') {
                const sp = SPECIES[state.species||'oak'];
                items.push(['Wood Species', sp.label], ['Hardness (Janka)', sp.hardness], ['Finish', FINISH[state.finish||'poly'].label], ['Area', state.sqft+' sq ft'], ['MT Climate Rating', sp.climate]);
            } else if(state.project==='refinish') {
                items.push(['Area', state.sqft+' sq ft'], ['Condition', (state.condition||'fair').charAt(0).toUpperCase()+(state.condition||'fair').slice(1)], ['Stain Change', state.stainChange?'Yes':'No']);
            } else {
                items.push(['Repair Type', (state.repairType||'boards')], ['Area Size', (state.repairSize||'small')]);
            }
            bd.innerHTML = items.map(([k,v])=>`<div class="flex justify-between bg-dark-700/30 rounded-lg px-4 py-3"><span class="text-sm text-gray-400">${k}</span><span class="text-sm font-medium capitalize">${v}</span></div>`).join('');

            // Refinish vs Replace comparison
            const rfc = document.getElementById('refinishCompare');
            if(showRefComp) {
                rfc.classList.remove('hidden');
                document.getElementById('refinishCost').textContent = `$${low.toLocaleString()} ‚Äì $${high.toLocaleString()}`;
                const replLow = Math.round(7 * state.sqft / 100)*100;
                const replHigh = Math.round(12 * state.sqft / 100)*100;
                document.getElementById('replaceCost').textContent = `$${replLow.toLocaleString()} ‚Äì $${replHigh.toLocaleString()}`;
                const savings = Math.round(((replLow+replHigh)/2) - ((low+high)/2));
                document.getElementById('refinishAdvice').textContent = state.condition==='poor'
                    ? `Your floors need significant work. Refinishing saves ~$${savings.toLocaleString()} vs replacement, but Montana Hardwood can assess if your floors have enough material left for sanding.`
                    : `Refinishing saves ~$${savings.toLocaleString()} compared to full replacement. With nearly 50 years of experience, Montana Hardwood Floor Company can restore your floors to like-new condition.`;
            } else { rfc.classList.add('hidden'); }

            // Species comparison (for install)
            const scs = document.getElementById('speciesCompareSection');
            if(state.project==='install') {
                scs.classList.remove('hidden');
                const sc = document.getElementById('speciesCompare');
                sc.innerHTML = Object.entries(SPECIES).map(([k,s])=>{
                    const isSel = k===(state.species||'oak');
                    const lo = Math.round(s.low*state.sqft/100)*100;
                    const hi = Math.round(s.high*state.sqft/100)*100;
                    return `<div class="flex items-center justify-between ${isSel?'bg-wood-500/10 border border-wood-500/30':'bg-dark-800/40'} rounded-lg px-4 py-3">
                        <div><div class="text-sm font-medium ${isSel?'text-wood-300':''}">${s.label} ${isSel?'‚úì':''}</div><div class="text-xs text-gray-400">Janka ${s.hardness} ‚Ä¢ ${s.climate}</div></div>
                        <div class="text-right"><div class="text-sm font-bold ${isSel?'text-wood-400':'text-gray-300'}">$${lo.toLocaleString()} ‚Äì $${hi.toLocaleString()}</div></div>
                    </div>`;
                }).join('');
            } else { scs.classList.add('hidden'); }

            localStorage.setItem('mthw_est', JSON.stringify({...state,low,high,ts:new Date().toISOString()}));
            goStep(3);
            lucide.createIcons();
        }

        function submitLead(){
            const name=document.getElementById('leadName').value.trim();
            const phone=document.getElementById('leadPhone').value.trim();
            if(!name||!phone){alert('Please enter your name and phone.');return;}
            localStorage.setItem('mthw_lead',JSON.stringify({name,phone,address:document.getElementById('leadAddr').value.trim(),estimate:JSON.parse(localStorage.getItem('mthw_est')||'{}'),submitted:new Date().toISOString()}));
            document.getElementById('leadForm').classList.add('hidden');
            document.getElementById('successMsg').classList.remove('hidden');
        }

        lucide.createIcons();
    </script>

<!-- BennyCuTools Purchase CTA ‚Äî injected by inject-cta.py -->
<style>
#bct-cta-bar {
  position: fixed;
  bottom: 48px;
  left: 0;
  right: 0;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  border-top: 2px solid #6366f1;
  padding: 10px 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  z-index: 99998;
  flex-wrap: wrap;
  box-shadow: 0 -4px 20px rgba(0,0,0,0.3);
}
#bct-cta-bar .bct-cta-text {
  color: #e4e4e7;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 14px;
  font-weight: 500;
}
#bct-cta-bar .bct-cta-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 20px;
  background: #6366f1;
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 14px;
  font-weight: 600;
  border: none;
  border-radius: 6px;
  text-decoration: none;
  cursor: pointer;
  transition: background 0.2s, transform 0.1s;
}
#bct-cta-bar .bct-cta-btn:hover {
  background: #4f46e5;
  transform: translateY(-1px);
}
#bct-cta-bar .bct-cta-btn-secondary {
  background: transparent;
  border: 1px solid #6366f1;
  color: #a5b4fc;
}
#bct-cta-bar .bct-cta-btn-secondary:hover {
  background: rgba(99,102,241,0.15);
}
@media (max-width: 600px) {
  #bct-cta-bar {
    flex-direction: column;
    gap: 8px;
    padding: 8px 12px;
    bottom: 44px;
  }
  #bct-cta-bar .bct-cta-text { font-size: 12px; }
  #bct-cta-bar .bct-cta-btn { font-size: 13px; padding: 7px 16px; width: 100%; justify-content: center; }
}
</style>
<div id="bct-cta-bar" role="banner" aria-label="Purchase this tool">
  <span class="bct-cta-text">Like this tool? Make it yours.</span>
  <a class="bct-cta-btn" id="bct-buy-btn" href="https://bennycutools.com/buy.html">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
    Get It ‚Äî $200 One-Time
  </a>
  <a class="bct-cta-btn bct-cta-btn-secondary" href="mailto:cuuper225@gmail.com?subject=Question%20about%20my%20custom%20tool">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
    Questions? Email Ben
  </a>
</div>
<script>
// Auto-fill the buy link with the current tool's page name
(function(){
  try {
    var pg = location.pathname.replace(/.*\//, '').replace('.html','');
    var buyBtn = document.getElementById('bct-buy-btn');
    if (buyBtn && pg) {
      buyBtn.href = 'https://bennycutools.com/buy.html?tool=' + encodeURIComponent(pg);
    }
  } catch(e){}
})();
</script>
<!-- End BennyCuTools Purchase CTA -->

</body>
</html>
