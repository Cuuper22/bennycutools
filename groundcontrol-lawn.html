<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex,nofollow">
    <title>Lawn Care Plan Builder | Ground Control Lawn Care ‚Äî Baltimore County, MD</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 50:'#f0fdf4', 100:'#dcfce7', 200:'#bbf7d0', 300:'#86efac', 400:'#4ade80', 500:'#22c55e', 600:'#16a34a', 700:'#15803d', 800:'#166534', 900:'#14532d' },
                        dark: { 700:'#1a2e1a', 800:'#0f1f0f', 900:'#071207' }
                    },
                    fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] }
                }
            }
        }
    </script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .step-enter{animation:stepIn .35s ease-out}
        @keyframes stepIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
        .pulse-glow{animation:glow 2s ease-in-out infinite alternate}
        @keyframes glow{from{box-shadow:0 0 8px rgba(34,197,94,.3)}to{box-shadow:0 0 20px rgba(34,197,94,.5)}}
    </style>

    <style>
    /* Kimi UI/UX Improvements */
    .fade-in-up { animation: fadeInUp 0.4s ease-out forwards; }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    .radio-option, [class*="option"], [class*="choice"] { 
        min-height: 52px; transition: all 0.15s ease !important; 
    }
    .radio-option:active, [class*="option"]:active { transform: scale(0.98); }
    .btn-primary:active, [class*="btn"]:active { transform: translateY(1px); }
    /* Better progress bar */
    [class*="progress"] { height: 6px !important; border-radius: 3px; }
    </style>
    
</head>
<body class="bg-dark-900 text-white font-sans min-h-screen">

    <header class="bg-dark-800/90 backdrop-blur border-b border-dark-700/50">
        <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-brand-500 rounded-lg flex items-center justify-center">
                    <i data-lucide="leaf" class="w-5 h-5 text-white"></i>
                </div>
                <div>
                    <h1 class="font-bold text-lg leading-tight">Ground Control Lawn Care</h1>
                    <p class="text-xs text-gray-400">Baltimore County, MD ‚Ä¢ (443) 520-5646</p>
                </div>
            </div>
            <span class="text-xs bg-brand-500/20 text-brand-400 px-3 py-1 rounded-full font-medium">Since 2015</span>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 py-8">
        <div class="text-center mb-10">
            <div class="inline-flex items-center gap-2 bg-dark-800 rounded-full px-4 py-2 mb-4">
                <i data-lucide="calendar" class="w-4 h-4 text-brand-400"></i>
                <span class="text-sm text-gray-400">Custom Lawn Plan</span>
            </div>
            <h2 class="text-3xl md:text-4xl font-extrabold mb-3">Build Your<br><span class="text-brand-400">Lawn Care Plan</span></h2>
            <p class="text-gray-400 max-w-lg mx-auto">Pick your property size, choose your services, and see what a year of professional lawn care actually costs. No surprises.</p>
        </div>

        <!-- Step 1: Property -->
        <div id="step1" class="step-enter">
            <div class="bg-dark-800/60 border border-dark-700/50 rounded-2xl p-6 md:p-8 mb-6">
                <h3 class="text-xl font-bold mb-1 flex items-center gap-2"><i data-lucide="home" class="w-5 h-5 text-brand-400"></i> Your Property</h3>
                <p class="text-sm text-gray-400 mb-6">Select what best describes your lawn.</p>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-300 mb-3">Lawn Size</label>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3" id="sizeGrid">
                        <button onclick="selSize(this,'small')" class="sz-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-2xl mb-1">üè†</div>
                            <div class="text-sm font-bold">Small</div>
                            <div class="text-xs text-gray-400">Under 5,000 sq ft</div>
                        </button>
                        <button onclick="selSize(this,'medium')" class="sz-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-2xl mb-1">üè°</div>
                            <div class="text-sm font-bold">Medium</div>
                            <div class="text-xs text-gray-400">5,000‚Äì10,000 sq ft</div>
                        </button>
                        <button onclick="selSize(this,'large')" class="sz-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-2xl mb-1">üèòÔ∏è</div>
                            <div class="text-sm font-bold">Large</div>
                            <div class="text-xs text-gray-400">10,000‚Äì20,000 sq ft</div>
                        </button>
                        <button onclick="selSize(this,'xlarge')" class="sz-btn bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-2xl mb-1">üè∞</div>
                            <div class="text-sm font-bold">Extra Large</div>
                            <div class="text-xs text-gray-400">20,000+ sq ft</div>
                        </button>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-300 mb-3">Property Type</label>
                    <div class="grid grid-cols-3 gap-3" id="typeGrid">
                        <button onclick="selType(this,'residential')" class="tp-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-sm font-medium">Residential</div>
                        </button>
                        <button onclick="selType(this,'commercial')" class="tp-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-sm font-medium">Commercial</div>
                        </button>
                        <button onclick="selType(this,'hoa')" class="tp-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-sm font-medium">HOA / Multi-Unit</div>
                        </button>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-3">Current Lawn Condition</label>
                    <div class="grid grid-cols-3 gap-3" id="condGrid">
                        <button onclick="selCond(this,'good')" class="cd-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-lg mb-1">üåø</div>
                            <div class="text-sm font-medium">Healthy</div>
                            <div class="text-xs text-gray-400">Just needs maintenance</div>
                        </button>
                        <button onclick="selCond(this,'fair')" class="cd-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-lg mb-1">üåæ</div>
                            <div class="text-sm font-medium">Needs Work</div>
                            <div class="text-xs text-gray-400">Thin spots, some weeds</div>
                        </button>
                        <button onclick="selCond(this,'poor')" class="cd-btn bg-dark-700/50 border border-dark-700 rounded-xl p-3 text-center hover:border-brand-500/50 transition-all">
                            <div class="text-lg mb-1">üçÇ</div>
                            <div class="text-sm font-medium">Major Help</div>
                            <div class="text-xs text-gray-400">Overgrown, bare spots, weeds</div>
                        </button>
                    </div>
                </div>
            </div>
            <div class="text-center">
                <button onclick="goStep(2)" class="bg-brand-500 hover:bg-brand-400 text-white font-bold px-8 py-3 rounded-xl transition-all pulse-glow">Choose Your Services ‚Üí</button>
            </div>
        </div>

        <!-- Step 2: Services -->
        <div id="step2" class="hidden step-enter">
            <div class="bg-dark-800/60 border border-dark-700/50 rounded-2xl p-6 md:p-8 mb-6">
                <h3 class="text-xl font-bold mb-1 flex items-center gap-2"><i data-lucide="list-checks" class="w-5 h-5 text-brand-400"></i> Pick Your Services</h3>
                <p class="text-sm text-gray-400 mb-2">Select everything you want. We'll build your custom annual plan.</p>
                <p class="text-xs text-brand-400 mb-6">üí° Bundle 3+ services and save 10%</p>

                <div class="space-y-3" id="svcList">
                    <!-- Recurring -->
                    <div class="text-xs uppercase tracking-wider text-gray-500 font-bold mt-2 mb-1">Recurring Services</div>

                    <button onclick="toggleSvc(this,'mowing')" class="svc-btn w-full bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-left hover:border-brand-500/50 transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3"><span class="text-xl">üåø</span><div><div class="text-sm font-semibold">Weekly Lawn Mowing</div><div class="text-xs text-gray-400">Mow, edge, blow ‚Äî every week Apr-Nov</div></div></div>
                            <div class="text-right"><div class="text-sm font-bold text-brand-400" id="price-mowing"></div><div class="text-xs text-gray-400">per visit</div></div>
                        </div>
                    </button>

                    <button onclick="toggleSvc(this,'biweekly')" class="svc-btn w-full bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-left hover:border-brand-500/50 transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3"><span class="text-xl">üå±</span><div><div class="text-sm font-semibold">Bi-Weekly Mowing</div><div class="text-xs text-gray-400">Every other week ‚Äî budget option</div></div></div>
                            <div class="text-right"><div class="text-sm font-bold text-brand-400" id="price-biweekly"></div><div class="text-xs text-gray-400">per visit</div></div>
                        </div>
                    </button>

                    <div class="text-xs uppercase tracking-wider text-gray-500 font-bold mt-4 mb-1">Seasonal Services</div>

                    <button onclick="toggleSvc(this,'aeration')" class="svc-btn w-full bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-left hover:border-brand-500/50 transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3"><span class="text-xl">üåæ</span><div><div class="text-sm font-semibold">Aeration & Overseeding</div><div class="text-xs text-gray-400">Fall ‚Äî thicken and repair lawn</div></div></div>
                            <div class="text-right"><div class="text-sm font-bold text-brand-400" id="price-aeration"></div><div class="text-xs text-gray-400">one-time</div></div>
                        </div>
                    </button>

                    <button onclick="toggleSvc(this,'mulch')" class="svc-btn w-full bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-left hover:border-brand-500/50 transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3"><span class="text-xl">ü™µ</span><div><div class="text-sm font-semibold">Mulching</div><div class="text-xs text-gray-400">Spring ‚Äî refresh landscape beds</div></div></div>
                            <div class="text-right"><div class="text-sm font-bold text-brand-400" id="price-mulch"></div><div class="text-xs text-gray-400">per yard</div></div>
                        </div>
                    </button>

                    <button onclick="toggleSvc(this,'leafremoval')" class="svc-btn w-full bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-left hover:border-brand-500/50 transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3"><span class="text-xl">üçÇ</span><div><div class="text-sm font-semibold">Fall Leaf Removal</div><div class="text-xs text-gray-400">Oct-Dec ‚Äî full property cleanup</div></div></div>
                            <div class="text-right"><div class="text-sm font-bold text-brand-400" id="price-leafremoval"></div><div class="text-xs text-gray-400">per visit</div></div>
                        </div>
                    </button>

                    <button onclick="toggleSvc(this,'pruning')" class="svc-btn w-full bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-left hover:border-brand-500/50 transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3"><span class="text-xl">‚úÇÔ∏è</span><div><div class="text-sm font-semibold">Shrub & Tree Pruning</div><div class="text-xs text-gray-400">Shape and maintain landscaping</div></div></div>
                            <div class="text-right"><div class="text-sm font-bold text-brand-400" id="price-pruning"></div><div class="text-xs text-gray-400">per session</div></div>
                        </div>
                    </button>

                    <button onclick="toggleSvc(this,'snow')" class="svc-btn w-full bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-left hover:border-brand-500/50 transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3"><span class="text-xl">‚ùÑÔ∏è</span><div><div class="text-sm font-semibold">Snow Removal</div><div class="text-xs text-gray-400">Winter ‚Äî driveway & walkways</div></div></div>
                            <div class="text-right"><div class="text-sm font-bold text-brand-400" id="price-snow"></div><div class="text-xs text-gray-400">per event</div></div>
                        </div>
                    </button>

                    <div class="text-xs uppercase tracking-wider text-gray-500 font-bold mt-4 mb-1">One-Time Projects</div>

                    <button onclick="toggleSvc(this,'sod')" class="svc-btn w-full bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-left hover:border-brand-500/50 transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3"><span class="text-xl">üåø</span><div><div class="text-sm font-semibold">Sod Installation</div><div class="text-xs text-gray-400">New lawn or repair sections</div></div></div>
                            <div class="text-right"><div class="text-sm font-bold text-brand-400" id="price-sod"></div><div class="text-xs text-gray-400">per sq ft</div></div>
                        </div>
                    </button>

                    <button onclick="toggleSvc(this,'planting')" class="svc-btn w-full bg-dark-700/50 border border-dark-700 rounded-xl p-4 text-left hover:border-brand-500/50 transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3"><span class="text-xl">üå∏</span><div><div class="text-sm font-semibold">Plant Installation</div><div class="text-xs text-gray-400">Shrubs, trees, flowers, perennials</div></div></div>
                            <div class="text-right"><div class="text-sm font-bold text-brand-400" id="price-planting"></div><div class="text-xs text-gray-400">varies</div></div>
                        </div>
                    </button>
                </div>

                <!-- Running total -->
                <div class="mt-6 bg-brand-500/10 border border-brand-500/30 rounded-xl p-4">
                    <div class="flex justify-between items-center">
                        <div>
                            <div class="text-sm font-medium text-brand-400">Running Annual Estimate</div>
                            <div class="text-xs text-gray-400"><span id="svcCount">0</span> services selected</div>
                        </div>
                        <div class="text-2xl font-extrabold text-brand-400" id="runningTotal">$0</div>
                    </div>
                    <div id="bundleNote" class="hidden text-xs text-green-400 mt-2">‚ú® Bundle discount applied ‚Äî 10% off!</div>
                </div>
            </div>
            <div class="flex justify-between">
                <button onclick="goStep(1)" class="text-gray-400 hover:text-white font-medium px-6 py-3 transition-all">‚Üê Back</button>
                <button onclick="buildPlan()" class="bg-brand-500 hover:bg-brand-400 text-white font-bold px-8 py-3 rounded-xl transition-all pulse-glow">See My Full Plan ‚Üí</button>
            </div>
        </div>

        <!-- Step 3: Plan -->
        <div id="step3" class="hidden step-enter">
            <div class="bg-dark-800/60 border border-dark-700/50 rounded-2xl p-6 md:p-8 mb-6">
                <div class="text-center mb-6">
                    <div class="inline-flex items-center gap-2 bg-green-500/20 text-green-400 rounded-full px-4 py-2 text-sm font-medium mb-3">
                        <i data-lucide="check-circle" class="w-4 h-4"></i> Your Custom Plan
                    </div>
                    <h3 class="text-2xl font-bold">Annual Lawn Care Plan</h3>
                </div>

                <div class="bg-dark-900/60 rounded-xl p-6 mb-6 text-center">
                    <div class="text-sm text-gray-400 mb-1">Estimated Annual Cost</div>
                    <div class="text-4xl md:text-5xl font-extrabold text-brand-400" id="annualTotal">$3,200</div>
                    <div class="text-sm text-gray-400 mt-2" id="monthlyBreakdown">~$267/month</div>
                </div>

                <!-- Seasonal Calendar -->
                <div class="mb-6">
                    <h4 class="font-semibold text-sm mb-3 flex items-center gap-2"><i data-lucide="calendar" class="w-4 h-4 text-brand-400"></i> Your Year-Round Schedule</h4>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3" id="seasonGrid"></div>
                </div>

                <!-- Service Breakdown -->
                <div class="space-y-2 mb-6" id="planBreakdown"></div>

                <!-- Organic Note -->
                <div class="bg-green-500/10 border border-green-500/30 rounded-xl p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <i data-lucide="leaf" class="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5"></i>
                        <div>
                            <div class="font-semibold text-green-400 text-sm">Organic Lawn Care</div>
                            <p class="text-xs text-gray-300 mt-1">Ground Control uses organic lawn care practices that are safe for kids, pets, and the environment. Better for your lawn long-term and better for Baltimore County waterways.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lead Form -->
            <div id="leadForm" class="bg-gradient-to-br from-brand-600/20 to-dark-800/60 border border-brand-500/30 rounded-2xl p-6 md:p-8 mb-6">
                <h3 class="text-xl font-bold mb-2 text-center">Get Your Exact Quote from Andrew</h3>
                <p class="text-sm text-gray-400 text-center mb-6">Free estimate ‚Äî no obligation. Serving Baltimore County for 10+ years.</p>
                <div class="space-y-4 max-w-md mx-auto">
                    <div class="grid grid-cols-2 gap-3">
                        <div><label class="block text-xs font-medium text-gray-300 mb-1">Name *</label><input type="text" id="leadName" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-gray-500 focus:border-brand-500 focus:outline-none" placeholder="Your name"></div>
                        <div><label class="block text-xs font-medium text-gray-300 mb-1">Phone *</label><input type="tel" id="leadPhone" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-gray-500 focus:border-brand-500 focus:outline-none" placeholder="(443) 555-0000"></div>
                    </div>
                    <div><label class="block text-xs font-medium text-gray-300 mb-1">Property Address</label><input type="text" id="leadAddr" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-gray-500 focus:border-brand-500 focus:outline-none" placeholder="Your address in Baltimore County"></div>
                    <div><label class="block text-xs font-medium text-gray-300 mb-1">When Would You Like to Start?</label>
                        <select id="leadStart" class="w-full bg-dark-900/60 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-white focus:border-brand-500 focus:outline-none">
                            <option value="asap">ASAP</option><option value="spring" selected>This Spring</option><option value="fall">This Fall</option><option value="planning">Just Planning</option>
                        </select>
                    </div>
                    <button onclick="submitLead()" id="submitBtn" class="w-full bg-brand-500 hover:bg-brand-400 text-white font-bold py-3 rounded-xl transition-all text-lg">Request Free Estimate</button>
                </div>
            </div>

            <div id="successMsg" class="hidden bg-green-500/20 border border-green-500/40 rounded-2xl p-8 text-center mb-6">
                <div class="text-4xl mb-3">‚úÖ</div>
                <h3 class="text-xl font-bold text-green-400 mb-2">Plan Request Sent!</h3>
                <p class="text-gray-300">Andrew from Ground Control Lawn Care will contact you shortly with an exact quote for your custom plan.</p>
                <p class="text-gray-400 text-sm mt-3">Call now: <a href="tel:4435205646" class="text-brand-400 underline">(443) 520-5646</a></p>
            </div>
        </div>
    </main>

    <footer class="border-t border-dark-800 py-6 text-center text-xs text-gray-500">
        <p>Built for Ground Control Lawn Care ‚Ä¢ Dundalk, MD 21222</p>
        <p class="mt-1">Estimates are approximate. Final pricing based on property assessment.</p>
    </footer>

    <script>
        let state = { size:null, type:null, condition:null, services:[] };

        const SIZE_MULT = { small:1, medium:1.5, large:2.2, xlarge:3.2 };
        const COND_MULT = { good:1, fair:1.15, poor:1.35 };

        // Base prices for medium-sized residential property
        const SVC_DATA = {
            mowing:      { base:45, freq:'weekly', visits:30, season:'spring-fall', label:'Weekly Mowing', icon:'üåø' },
            biweekly:    { base:55, freq:'biweekly', visits:15, season:'spring-fall', label:'Bi-Weekly Mowing', icon:'üå±' },
            aeration:    { base:200, freq:'annual', visits:1, season:'fall', label:'Aeration & Overseeding', icon:'üåæ' },
            mulch:       { base:300, freq:'annual', visits:1, season:'spring', label:'Mulching', icon:'ü™µ' },
            leafremoval: { base:175, freq:'seasonal', visits:3, season:'fall', label:'Leaf Removal', icon:'üçÇ' },
            pruning:     { base:150, freq:'annual', visits:2, season:'spring-summer', label:'Shrub & Tree Pruning', icon:'‚úÇÔ∏è' },
            snow:        { base:65, freq:'per-event', visits:8, season:'winter', label:'Snow Removal', icon:'‚ùÑÔ∏è' },
            sod:         { base:600, freq:'one-time', visits:1, season:'spring-fall', label:'Sod Installation', icon:'üåø' },
            planting:    { base:400, freq:'one-time', visits:1, season:'spring', label:'Plant Installation', icon:'üå∏' }
        };

        function selSize(el,v) { state.size=v; document.querySelectorAll('.sz-btn').forEach(b=>{b.classList.remove('border-brand-500','bg-brand-500/10');b.classList.add('border-dark-700');}); el.classList.add('border-brand-500','bg-brand-500/10'); el.classList.remove('border-dark-700'); updatePrices(); }
        function selType(el,v) { state.type=v; document.querySelectorAll('.tp-btn').forEach(b=>{b.classList.remove('border-brand-500','bg-brand-500/10');b.classList.add('border-dark-700');}); el.classList.add('border-brand-500','bg-brand-500/10'); el.classList.remove('border-dark-700'); }
        function selCond(el,v) { state.condition=v; document.querySelectorAll('.cd-btn').forEach(b=>{b.classList.remove('border-brand-500','bg-brand-500/10');b.classList.add('border-dark-700');}); el.classList.add('border-brand-500','bg-brand-500/10'); el.classList.remove('border-dark-700'); }

        function updatePrices() {
            const mult = SIZE_MULT[state.size||'medium'];
            Object.entries(SVC_DATA).forEach(([k,v]) => {
                const el = document.getElementById('price-'+k);
                if(el) el.textContent = '$'+Math.round(v.base * mult);
            });
        }

        function toggleSvc(el, svc) {
            const idx = state.services.indexOf(svc);
            if(idx>-1) { state.services.splice(idx,1); el.classList.remove('border-brand-500','bg-brand-500/10'); el.classList.add('border-dark-700'); }
            else {
                // Can't have both mowing and biweekly
                if(svc==='mowing') { state.services = state.services.filter(s=>s!=='biweekly'); document.querySelectorAll('.svc-btn').forEach(b=>{if(b.onclick&&b.onclick.toString().includes('biweekly')){b.classList.remove('border-brand-500','bg-brand-500/10');b.classList.add('border-dark-700');}}); }
                if(svc==='biweekly') { state.services = state.services.filter(s=>s!=='mowing'); document.querySelectorAll('.svc-btn').forEach(b=>{if(b.onclick&&b.onclick.toString().includes("'mowing'")){b.classList.remove('border-brand-500','bg-brand-500/10');b.classList.add('border-dark-700');}}); }
                state.services.push(svc);
                el.classList.add('border-brand-500','bg-brand-500/10'); el.classList.remove('border-dark-700');
            }
            updateRunning();
        }

        function calcAnnual() {
            const szM = SIZE_MULT[state.size||'medium'];
            const cdM = COND_MULT[state.condition||'fair'];
            let total = 0;
            state.services.forEach(svc => {
                const d = SVC_DATA[svc];
                total += d.base * szM * d.visits;
            });
            total *= cdM;
            if(state.services.length >= 3) total *= 0.9; // bundle discount
            return Math.round(total/50)*50;
        }

        function updateRunning() {
            const total = calcAnnual();
            document.getElementById('runningTotal').textContent = '$'+total.toLocaleString();
            document.getElementById('svcCount').textContent = state.services.length;
            document.getElementById('bundleNote').classList.toggle('hidden', state.services.length < 3);
        }

        function goStep(n) {
            if(n===2) updatePrices();
            [1,2,3].forEach(i=>document.getElementById('step'+i).classList.add('hidden'));
            document.getElementById('step'+n).classList.remove('hidden');
            window.scrollTo({top:0,behavior:'smooth'});
        }

        function buildPlan() {
            const total = calcAnnual();
            const monthly = Math.round(total/12);
            document.getElementById('annualTotal').textContent = '$'+total.toLocaleString();
            document.getElementById('monthlyBreakdown').textContent = `~$${monthly}/month averaged over 12 months`;

            const szM = SIZE_MULT[state.size||'medium'];
            const cdM = COND_MULT[state.condition||'fair'];

            // Season grid
            const seasons = {
                spring: {label:'Spring',icon:'üå∑',color:'bg-green-500/10 border-green-500/30',services:[]},
                summer: {label:'Summer',icon:'‚òÄÔ∏è',color:'bg-yellow-500/10 border-yellow-500/30',services:[]},
                fall: {label:'Fall',icon:'üçÇ',color:'bg-amber-500/10 border-amber-500/30',services:[]},
                winter: {label:'Winter',icon:'‚ùÑÔ∏è',color:'bg-blue-500/10 border-blue-500/30',services:[]}
            };
            state.services.forEach(svc => {
                const d = SVC_DATA[svc];
                if(d.season.includes('spring')) seasons.spring.services.push(d.label);
                if(d.season.includes('summer') || d.season.includes('spring-fall') || d.season.includes('spring-summer')) seasons.summer.services.push(d.label);
                if(d.season.includes('fall') || d.season.includes('spring-fall')) seasons.fall.services.push(d.label);
                if(d.season.includes('winter')) seasons.winter.services.push(d.label);
            });
            document.getElementById('seasonGrid').innerHTML = Object.values(seasons).map(s =>
                `<div class="${s.color} border rounded-xl p-3"><div class="text-center mb-2"><span class="text-xl">${s.icon}</span><div class="text-xs font-bold">${s.label}</div></div>
                <div class="space-y-1">${s.services.length ? s.services.map(sv=>`<div class="text-xs text-gray-300">‚Ä¢ ${sv}</div>`).join('') : '<div class="text-xs text-gray-500 italic">No services</div>'}</div></div>`
            ).join('');

            // Breakdown
            const bd = document.getElementById('planBreakdown');
            const bundle = state.services.length >= 3;
            bd.innerHTML = state.services.map(svc => {
                const d = SVC_DATA[svc];
                const annual = Math.round(d.base * szM * d.visits * cdM * (bundle?0.9:1));
                return `<div class="flex justify-between bg-dark-700/30 rounded-lg px-4 py-3">
                    <span class="text-sm text-gray-400">${d.icon} ${d.label} <span class="text-xs">(${d.visits}x)</span></span>
                    <span class="text-sm font-medium">$${annual.toLocaleString()}/yr</span>
                </div>`;
            }).join('');
            if(bundle) {
                bd.innerHTML += `<div class="flex justify-between bg-green-500/10 rounded-lg px-4 py-3"><span class="text-sm text-green-400">‚ú® Bundle Discount (10%)</span><span class="text-sm font-medium text-green-400">Included</span></div>`;
            }

            localStorage.setItem('gc_plan', JSON.stringify({...state, total, ts:new Date().toISOString()}));
            goStep(3);
            lucide.createIcons();
        }

        function submitLead() {
            const name = document.getElementById('leadName').value.trim();
            const phone = document.getElementById('leadPhone').value.trim();
            if(!name||!phone){alert('Please enter your name and phone.');return;}
            const lead={name,phone,address:document.getElementById('leadAddr').value.trim(),start:document.getElementById('leadStart').value,plan:JSON.parse(localStorage.getItem('gc_plan')||'{}'),submitted:new Date().toISOString()};
            localStorage.setItem('gc_lead',JSON.stringify(lead));
            document.getElementById('leadForm').classList.add('hidden');
            document.getElementById('successMsg').classList.remove('hidden');
        }

        updatePrices();
        lucide.createIcons();
    </script>
</body>
</html>
