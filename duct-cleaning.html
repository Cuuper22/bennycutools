<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DuctQuote Pro — Glacier Air Duct Cleaning</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Play:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --glacier-blue: #00C8F0;
      --glacier-blue-dark: #00a8cc;
      --navy: #1A3A52;
      --navy-light: #2a4a62;
      --ice-bg: #F5F9FC;
      --white: #FFFFFF;
      --success: #28A745;
      --success-dark: #1e7e34;
      --text-dark: #2C3E50;
      --text-muted: #6c757d;
      --border: #dee2e6;
      --error: #dc3545;
      --shadow-sm: 0 2px 4px rgba(26,58,82,0.08);
      --shadow-md: 0 4px 12px rgba(26,58,82,0.12);
      --shadow-lg: 0 8px 24px rgba(26,58,82,0.16);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
    }

    *, *::before, *::after {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--ice-bg);
      color: var(--text-dark);
      margin: 0;
      padding: 0 0 80px 0;
      line-height: 1.5;
      min-height: 100vh;
    }

    h1, h2, h3 {
      font-family: 'Play', sans-serif;
      color: var(--navy);
      margin: 0;
    }

    .app-container {
      max-width: 480px;
      margin: 0 auto;
      padding: 16px;
      min-height: 100vh;
    }

    /* Header */
    .header {
      text-align: center;
      padding: 24px 16px;
      background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%);
      border-radius: var(--radius-lg);
      margin-bottom: 24px;
      box-shadow: var(--shadow-md);
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(0,200,240,0.1) 0%, transparent 70%);
      pointer-events: none;
    }

    .logo-text {
      font-family: 'Play', sans-serif;
      font-size: 28px;
      font-weight: 700;
      color: var(--white);
      margin-bottom: 4px;
    }

    .logo-text span {
      color: var(--glacier-blue);
    }

    .tagline {
      color: rgba(255,255,255,0.8);
      font-size: 14px;
      margin: 0;
    }

    /* Demo Banner */
    .demo-banner {
      background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
      border: 1px solid #ffc107;
      border-radius: var(--radius-md);
      padding: 12px 16px;
      margin-bottom: 16px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
      animation: slideDown 0.3s ease-out;
    }

    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .demo-banner-icon {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      color: #856404;
    }

    .demo-banner-content {
      flex: 1;
    }

    .demo-banner-title {
      font-weight: 600;
      color: #856404;
      margin-bottom: 4px;
      font-size: 14px;
    }

    .demo-banner-text {
      font-size: 13px;
      color: #856404;
      margin: 0;
    }

    .demo-banner-close {
      background: none;
      border: none;
      padding: 4px;
      cursor: pointer;
      color: #856404;
      flex-shrink: 0;
    }

    .demo-banner-close:hover {
      color: #533f03;
    }

    .demo-banner-close:focus-visible {
      outline: 2px solid #856404;
      outline-offset: 2px;
      border-radius: 4px;
    }

    /* Progress Indicator */
    .progress-bar {
      display: flex;
      gap: 8px;
      margin-bottom: 24px;
    }

    .progress-step {
      flex: 1;
      height: 4px;
      background: var(--border);
      border-radius: 2px;
      transition: background 0.3s ease;
    }

    .progress-step.active {
      background: var(--glacier-blue);
    }

    .progress-step.complete {
      background: var(--success);
    }

    /* Cards */
    .card {
      background: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      padding: 24px;
      margin-bottom: 16px;
    }

    .card-title {
      font-size: 20px;
      margin-bottom: 8px;
    }

    .card-subtitle {
      color: var(--text-muted);
      font-size: 14px;
      margin-bottom: 20px;
    }

    /* Form Elements */
    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 14px;
      color: var(--text-dark);
    }

    .form-select, .form-input {
      width: 100%;
      padding: 14px 16px;
      font-size: 16px;
      border: 2px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--white);
      color: var(--text-dark);
      transition: border-color 0.2s, box-shadow 0.2s;
      -webkit-appearance: none;
    }

    .form-select:focus, .form-input:focus {
      outline: none;
      border-color: var(--glacier-blue);
      box-shadow: 0 0 0 3px rgba(0,200,240,0.15);
    }

    .form-select:focus-visible, .form-input:focus-visible {
      outline: none;
      border-color: var(--glacier-blue);
      box-shadow: 0 0 0 3px rgba(0,200,240,0.25);
    }

    .form-input::placeholder {
      color: var(--text-muted);
    }

    /* Counter */
    .counter-group {
      margin-bottom: 24px;
    }

    .counter-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .vent-icon {
      width: 48px;
      height: 48px;
      background: var(--ice-bg);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--glacier-blue);
    }

    .counter-info h3 {
      font-size: 16px;
      margin-bottom: 2px;
    }

    .counter-info p {
      font-size: 13px;
      color: var(--text-muted);
      margin: 0;
    }

    .counter-controls {
      display: flex;
      align-items: center;
      gap: 16px;
      justify-content: center;
    }

    .counter-btn {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: 2px solid var(--glacier-blue);
      background: var(--white);
      color: var(--glacier-blue);
      font-size: 28px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.15s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
    }

    .counter-btn:hover {
      background: var(--glacier-blue);
      color: var(--white);
      transform: scale(1.05);
    }

    .counter-btn:active {
      transform: scale(0.95);
    }

    .counter-btn:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px rgba(0,200,240,0.4);
    }

    .counter-value {
      font-size: 36px;
      font-weight: 700;
      color: var(--navy);
      min-width: 60px;
      text-align: center;
      font-family: 'Play', sans-serif;
    }

    /* Add-ons */
    .addon-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .addon-item {
      display: flex;
      align-items: center;
      padding: 16px;
      border: 2px solid var(--border);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--white);
    }

    .addon-item:hover {
      border-color: var(--glacier-blue);
      background: rgba(0,200,240,0.02);
    }

    .addon-item.selected {
      border-color: var(--success);
      background: rgba(40,167,69,0.05);
    }

    .addon-item:focus-within {
      border-color: var(--glacier-blue);
      box-shadow: 0 0 0 3px rgba(0,200,240,0.15);
    }

    .addon-checkbox {
      width: 24px;
      height: 24px;
      border: 2px solid var(--border);
      border-radius: 6px;
      margin-right: 16px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .addon-item.selected .addon-checkbox {
      background: var(--success);
      border-color: var(--success);
    }

    .addon-checkbox svg {
      width: 14px;
      height: 14px;
      color: var(--white);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .addon-item.selected .addon-checkbox svg {
      opacity: 1;
    }

    .addon-info {
      flex: 1;
    }

    .addon-name {
      font-weight: 600;
      margin-bottom: 2px;
    }

    .addon-desc {
      font-size: 13px;
      color: var(--text-muted);
    }

    .addon-price {
      font-weight: 700;
      color: var(--success);
      font-size: 16px;
    }

    .addon-input {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }

    /* Buttons */
    .btn {
      width: 100%;
      padding: 16px 24px;
      font-size: 16px;
      font-weight: 600;
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px rgba(0,200,240,0.4);
    }

    .btn-primary {
      background: var(--glacier-blue);
      color: var(--white);
    }

    .btn-primary:hover {
      background: var(--glacier-blue-dark);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    .btn-secondary {
      background: var(--white);
      color: var(--navy);
      border: 2px solid var(--border);
    }

    .btn-secondary:hover {
      border-color: var(--navy);
      background: var(--ice-bg);
    }

    .btn-success {
      background: var(--success);
      color: var(--white);
    }

    .btn-success:hover {
      background: var(--success-dark);
    }

    .btn-group {
      display: flex;
      gap: 12px;
      margin-top: 24px;
    }

    .btn-group .btn {
      flex: 1;
    }

    /* Step Container */
    .step-container {
      display: none;
      animation: fadeSlideIn 0.3s ease-out;
    }

    .step-container.active {
      display: block;
    }

    @keyframes fadeSlideIn {
      from {
        opacity: 0;
        transform: translateX(20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* Quote Result */
    .quote-result {
      background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%);
      border-radius: var(--radius-lg);
      padding: 32px 24px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .quote-result::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 80%, rgba(0,200,240,0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255,255,255,0.05) 0%, transparent 50%);
      pointer-events: none;
    }

    .quote-label {
      color: rgba(255,255,255,0.8);
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }

    .quote-price {
      font-family: 'Play', sans-serif;
      font-size: 48px;
      font-weight: 700;
      color: var(--white);
      margin-bottom: 4px;
    }

    .quote-note {
      color: rgba(255,255,255,0.7);
      font-size: 13px;
      margin-bottom: 24px;
    }

    .quote-actions {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .quote-cta {
      padding: 16px 24px;
      font-size: 16px;
      font-weight: 600;
      border-radius: var(--radius-md);
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s ease;
      cursor: pointer;
      border: none;
    }

    .quote-cta:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px rgba(255,255,255,0.4);
    }

    .quote-cta-primary {
      background: var(--success);
      color: var(--white);
    }

    .quote-cta-primary:hover {
      background: var(--success-dark);
      transform: translateY(-1px);
    }

    .quote-cta-secondary {
      background: rgba(255,255,255,0.15);
      color: var(--white);
      backdrop-filter: blur(4px);
    }

    .quote-cta-secondary:hover {
      background: rgba(255,255,255,0.25);
    }

    /* Comparison Chart */
    .comparison-section {
      margin-top: 24px;
    }

    .comparison-title {
      font-size: 16px;
      color: var(--navy);
      margin-bottom: 16px;
      text-align: center;
    }

    .chart-container {
      background: var(--white);
      border-radius: var(--radius-md);
      padding: 20px;
      height: 200px;
    }

    /* Lead Capture */
    .lead-form {
      margin-top: 24px;
    }

    .lead-form .form-input {
      margin-bottom: 12px;
    }

    /* Upsell */
    .upsell-tabs {
      display: flex;
      gap: 8px;
      margin-top: 24px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
    }

    .upsell-tab {
      flex: 1;
      padding: 12px 8px;
      background: var(--ice-bg);
      border: 1px dashed var(--border);
      border-radius: var(--radius-sm);
      text-align: center;
      color: var(--text-muted);
      font-size: 12px;
      cursor: not-allowed;
      opacity: 0.7;
    }

    .upsell-tab-label {
      display: block;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .upsell-tab-pro {
      font-size: 10px;
      background: var(--glacier-blue);
      color: var(--white);
      padding: 2px 6px;
      border-radius: 4px;
      display: inline-block;
    }

    /* Service Area */
    .service-check {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      background: rgba(40,167,69,0.1);
      border-radius: var(--radius-sm);
      margin-bottom: 16px;
      color: var(--success);
      font-size: 14px;
    }

    .service-check.outside {
      background: rgba(255,193,7,0.1);
      color: #856404;
    }

    .service-check svg {
      flex-shrink: 0;
    }

    /* Confetti */
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1000;
      overflow: hidden;
    }

    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      animation: confetti-fall 3s ease-out forwards;
    }

    @keyframes confetti-fall {
      0% {
        transform: translateY(-100%) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }

    /* Trust Badges */
    .trust-badges {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
    }

    .trust-badge {
      text-align: center;
    }

    .trust-badge-value {
      font-family: 'Play', sans-serif;
      font-size: 20px;
      font-weight: 700;
      color: var(--navy);
    }

    .trust-badge-label {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Summary */
    .summary-list {
      list-style: none;
      padding: 0;
      margin: 0 0 20px 0;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid var(--border);
      font-size: 14px;
    }

    .summary-item:last-child {
      border-bottom: none;
    }

    .summary-label {
      color: var(--text-muted);
    }

    .summary-value {
      font-weight: 600;
      color: var(--text-dark);
    }

    /* Hidden */
    .hidden {
      display: none !important;
    }

    /* Auth wall */
    .auth-wall {
      text-align: center;
      padding: 48px 24px;
    }

    .auth-wall h2 {
      margin-bottom: 16px;
    }

    .auth-wall p {
      color: var(--text-muted);
      margin-bottom: 24px;
    }

    .auth-wall .form-input {
      max-width: 280px;
      margin: 0 auto 16px;
      text-align: center;
    }

    /* Reduced Motion */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Skip Link */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: var(--navy);
      color: white;
      padding: 8px 16px;
      text-decoration: none;
      font-weight: 600;
      border-radius: 0 0 var(--radius-md) 0;
      z-index: 10000;
      transition: top 0.2s ease;
      font-family: 'Play', sans-serif;
    }
    .skip-link:focus {
      top: 0;
      outline: 2px solid var(--glacier-blue);
      outline-offset: 2px;
    }

    /* Glass Morphism Effect */
    .glass-card {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    /* Noise Texture Overlay */
    .noise-overlay::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      opacity: 0.03;
      pointer-events: none;
      z-index: 1;
    }

    /* Enhanced Step Transitions */
    .step-container {
      display: none;
      opacity: 0;
      transform: translateX(30px) scale(0.98);
      transition: opacity 0.35s cubic-bezier(0.4, 0, 0.2, 1),
                  transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .step-container.active {
      display: block;
      opacity: 1;
      transform: translateX(0) scale(1);
    }

    /* Counter Animation */
    @keyframes countPop {
      0% { transform: scale(1); }
      40% { transform: scale(1.15); }
      100% { transform: scale(1); }
    }

    .counter-value.animating {
      animation: countPop 0.25s ease-out;
      color: var(--glacier-blue);
    }

    /* Button Ripple Effect */
    .btn {
      position: relative;
      overflow: hidden;
    }

    .btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.4s ease, height 0.4s ease;
    }

    .btn:active::after {
      width: 200%;
      height: 200%;
    }

    /* Quote Result Card Enhancement */
    .quote-result {
      background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%);
      position: relative;
      overflow: hidden;
    }

    .quote-result::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle at 30% 70%, rgba(0, 200, 240, 0.15) 0%, transparent 50%),
                  radial-gradient(circle at 70% 30%, rgba(255, 255, 255, 0.08) 0%, transparent 40%);
      pointer-events: none;
      animation: shimmer 8s ease-in-out infinite;
    }

    @keyframes shimmer {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      50% { transform: translate(-5%, -5%) rotate(5deg); }
    }

    /* Price Counter Animation */
    @keyframes priceReveal {
      0% { opacity: 0; transform: translateY(20px) scale(0.9); }
      60% { transform: translateY(-5px) scale(1.02); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }

    .quote-price.animating {
      animation: priceReveal 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    /* Progress Step Pulse */
    @keyframes stepPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    .progress-step.active {
      animation: stepPulse 2s ease-in-out infinite;
      box-shadow: 0 0 8px rgba(0, 200, 240, 0.5);
    }

    /* Trust Badge Hover */
    .trust-badge {
      transition: transform 0.2s ease;
    }

    .trust-badge:hover {
      transform: translateY(-3px);
    }

    /* Demo Disclaimer */
    #bct-demo-disclaimer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #f8f8f8;
      border-top: 1px solid #ddd;
      padding: 10px 16px;
      font-size: 12px;
      line-height: 1.4;
      color: #666;
      z-index: 99999;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
      gap: 8px 16px;
      text-align: center;
    }

    #bct-demo-disclaimer p {
      margin: 0;
      max-width: 700px;
    }

    #bct-demo-disclaimer strong {
      color: #333;
    }

    #bct-demo-disclaimer a {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: #dc3545;
      color: #fff;
      padding: 5px 12px;
      border-radius: 4px;
      text-decoration: none;
      font-size: 11px;
      font-weight: 500;
      white-space: nowrap;
    }

    #bct-demo-disclaimer a:hover {
      background: #c82333;
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- Auth Wall -->
  <div id="auth-wall" class="app-container">
    <div class="header">
      <div class="logo-text"><span>Glacier</span> Air Duct</div>
      <p class="tagline">Colorado Springs' Trusted Duct Cleaners</p>
    </div>
    <div class="card auth-wall">
      <h2>Access Required</h2>
      <p>Enter the access key to use DuctQuote Pro.</p>
      <input type="text" id="access-key-input" class="form-input" placeholder="Enter access key" aria-label="Access key">
      <button id="access-key-submit" class="btn btn-primary">Continue</button>
      <p id="auth-error" class="hidden" style="color: var(--error); margin-top: 12px; font-size: 14px;">Incorrect access key. Please try again.</p>
    </div>
  </div>

  <!-- Main App -->
  <div id="main-app" class="app-container hidden">
    <!-- Header -->
    <header class="header" id="main-content">
      <div class="logo-text"><span>Glacier</span> Air Duct</div>
      <p class="tagline">Get Your Free Quote in 60 Seconds</p>
    </header>

    <!-- Demo Banner -->
    <div id="demo-banner" class="demo-banner hidden">
      <svg class="demo-banner-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 16v-4"/>
        <path d="M12 8h.01"/>
      </svg>
      <div class="demo-banner-content">
        <div class="demo-banner-title">Sample Quote</div>
        <p class="demo-banner-text">This shows a typical Colorado Springs home. Hit "Start Fresh" to price your own home.</p>
      </div>
      <button id="demo-close" class="demo-banner-close" aria-label="Dismiss sample quote banner">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
    </div>

    <!-- Progress Bar -->
    <div class="progress-bar" role="progressbar" aria-valuenow="1" aria-valuemin="1" aria-valuemax="4" aria-label="Quote progress">
      <div class="progress-step active" data-step="1"></div>
      <div class="progress-step" data-step="2"></div>
      <div class="progress-step" data-step="3"></div>
      <div class="progress-step" data-step="4"></div>
    </div>

    <!-- Step 1: Home Profile -->
    <section id="step-1" class="step-container active" aria-labelledby="step1-title">
      <div class="card">
        <h2 id="step1-title" class="card-title">Tell Us About Your Home</h2>
        <p class="card-subtitle">Takes about 15 seconds</p>

        <div id="service-area-status" aria-live="polite" aria-atomic="true"></div>

        <div class="form-group">
          <label for="sqft" class="form-label">Home Size</label>
          <select id="sqft" class="form-select" aria-describedby="sqft-help">
            <option value="">Select square footage</option>
            <option value="1000">Under 1,000 sq ft</option>
            <option value="1500">1,000 - 1,500 sq ft</option>
            <option value="2000">1,500 - 2,000 sq ft</option>
            <option value="2500">2,000 - 2,500 sq ft</option>
            <option value="3000">2,500 - 3,000 sq ft</option>
            <option value="3500">3,000 - 4,000 sq ft</option>
            <option value="4500">4,000 - 5,000 sq ft</option>
            <option value="5500">Over 5,000 sq ft</option>
          </select>
        </div>

        <div class="form-group">
          <label for="stories" class="form-label">Number of Stories</label>
          <select id="stories" class="form-select">
            <option value="">Select stories</option>
            <option value="1">1 Story (Ranch)</option>
            <option value="2">2 Stories</option>
            <option value="3">3+ Stories</option>
          </select>
        </div>

        <div class="form-group">
          <label for="home-age" class="form-label">When Was Your Home Built?</label>
          <select id="home-age" class="form-select">
            <option value="">Select era</option>
            <option value="pre1980">Before 1980</option>
            <option value="1980s">1980 - 1990</option>
            <option value="1990s">1991 - 2000</option>
            <option value="2000s">2001 - 2010</option>
            <option value="2010s">2011 - 2020</option>
            <option value="new">After 2020</option>
          </select>
        </div>

        <div class="form-group">
          <label for="hvac-systems" class="form-label">HVAC Systems</label>
          <select id="hvac-systems" class="form-select">
            <option value="">How many furnaces/AC units?</option>
            <option value="1">1 System</option>
            <option value="2">2 Systems</option>
            <option value="3">3+ Systems</option>
          </select>
        </div>

        <button id="step1-next" class="btn btn-primary" disabled>
          Continue to Vent Count
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </button>
      </div>

      <div class="trust-badges">
        <div class="trust-badge">
          <div class="trust-badge-value">5.0</div>
          <div class="trust-badge-label">Star Rating</div>
        </div>
        <div class="trust-badge">
          <div class="trust-badge-value">129</div>
          <div class="trust-badge-label">Reviews</div>
        </div>
        <div class="trust-badge">
          <div class="trust-badge-value">Local</div>
          <div class="trust-badge-label">Family Owned</div>
        </div>
      </div>
    </section>

    <!-- Step 2: Vent Counter -->
    <section id="step-2" class="step-container" aria-labelledby="step2-title">
      <div class="card">
        <h2 id="step2-title" class="card-title">Count Your Vents</h2>
        <p class="card-subtitle">Walk through your home — takes about 30 seconds</p>

        <div class="counter-group">
          <div class="counter-header">
            <div class="vent-icon" aria-hidden="true">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <line x1="7" y1="8" x2="17" y2="8"/>
                <line x1="7" y1="12" x2="17" y2="12"/>
                <line x1="7" y1="16" x2="17" y2="16"/>
              </svg>
            </div>
            <div class="counter-info">
              <h3>Supply Vents</h3>
              <p>Small rectangular vents that blow air out</p>
            </div>
          </div>
          <div class="counter-controls">
            <button class="counter-btn" id="supply-minus" aria-label="Decrease supply vent count">−</button>
            <span class="counter-value" id="supply-count" aria-live="polite">0</span>
            <button class="counter-btn" id="supply-plus" aria-label="Increase supply vent count">+</button>
          </div>
        </div>

        <div class="counter-group">
          <div class="counter-header">
            <div class="vent-icon" aria-hidden="true">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="2" y="6" width="20" height="12" rx="2"/>
                <line x1="6" y1="10" x2="18" y2="10"/>
                <line x1="6" y1="14" x2="18" y2="14"/>
              </svg>
            </div>
            <div class="counter-info">
              <h3>Return Vents</h3>
              <p>Larger vents (often on walls) that pull air in</p>
            </div>
          </div>
          <div class="counter-controls">
            <button class="counter-btn" id="return-minus" aria-label="Decrease return vent count">−</button>
            <span class="counter-value" id="return-count" aria-live="polite">0</span>
            <button class="counter-btn" id="return-plus" aria-label="Increase return vent count">+</button>
          </div>
        </div>

        <p style="text-align: center; font-size: 13px; color: var(--text-muted); margin: 0;">
          Most homes have 10-15 supply vents and 2-4 return vents
        </p>

        <div class="btn-group">
          <button id="step2-back" class="btn btn-secondary">Back</button>
          <button id="step2-next" class="btn btn-primary" disabled>Continue</button>
        </div>
      </div>
    </section>

    <!-- Step 3: Add-ons -->
    <section id="step-3" class="step-container" aria-labelledby="step3-title">
      <div class="card">
        <h2 id="step3-title" class="card-title">Optional Add-ons</h2>
        <p class="card-subtitle">Extras to consider while we're at your home</p>

        <div class="addon-list">
          <label class="addon-item" for="addon-dryer">
            <input type="checkbox" id="addon-dryer" class="addon-input" data-price="125">
            <div class="addon-checkbox">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
            </div>
            <div class="addon-info">
              <div class="addon-name">Dryer Vent Cleaning</div>
              <div class="addon-desc">Reduces fire risk, improves drying time</div>
            </div>
            <div class="addon-price">+$125</div>
          </label>

          <label class="addon-item" for="addon-sanitize">
            <input type="checkbox" id="addon-sanitize" class="addon-input" data-price="75">
            <div class="addon-checkbox">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
            </div>
            <div class="addon-info">
              <div class="addon-name">Sanitization Treatment</div>
              <div class="addon-desc">Kills bacteria, reduces allergens</div>
            </div>
            <div class="addon-price">+$75</div>
          </label>

          <label class="addon-item" for="addon-priority">
            <input type="checkbox" id="addon-priority" class="addon-input" data-price="50">
            <div class="addon-checkbox">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
            </div>
            <div class="addon-info">
              <div class="addon-name">Priority Scheduling</div>
              <div class="addon-desc">Get cleaned within 48 hours</div>
            </div>
            <div class="addon-price">+$50</div>
          </label>
        </div>

        <div class="btn-group">
          <button id="step3-back" class="btn btn-secondary">Back</button>
          <button id="step3-next" class="btn btn-primary">See My Quote</button>
        </div>
      </div>

      <!-- Upsell Gap -->
      <div class="upsell-tabs">
        <div class="upsell-tab">
          <span class="upsell-tab-label">Photo Upload</span>
          <span class="upsell-tab-pro">PRO</span>
        </div>
        <div class="upsell-tab">
          <span class="upsell-tab-label">Full Calendar</span>
          <span class="upsell-tab-pro">PRO</span>
        </div>
      </div>
    </section>

    <!-- Step 4: Quote Result -->
    <section id="step-4" class="step-container" aria-labelledby="step4-title">
      <div class="quote-result noise-overlay">
        <div class="quote-label">Your Estimated Price</div>
        <div class="quote-price" id="quote-price" aria-live="polite">$0-$0</div>
        <div class="quote-note">Based on <span id="total-vents">0</span> vents</div>

        <div class="quote-actions">
          <a href="tel:+17192573771" class="quote-cta quote-cta-primary" role="button">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
            </svg>
            Call Eyal Now
          </a>
          <button id="share-quote" class="quote-cta quote-cta-secondary">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="18" cy="5" r="3"/>
              <circle cx="6" cy="12" r="3"/>
              <circle cx="18" cy="19" r="3"/>
              <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
              <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
            </svg>
            Text Me This Quote
          </button>
        </div>
      </div>

      <!-- Summary -->
      <div class="card glass-card" style="margin-top: 16px;">
        <h3 style="font-size: 16px; margin-bottom: 16px;">Quote Summary</h3>
        <ul class="summary-list" id="quote-summary">
          <!-- Populated by JS -->
        </ul>
        <button id="start-over" class="btn btn-secondary">Start Fresh</button>
      </div>

      <!-- Price Comparison Chart -->
      <div class="comparison-section">
        <h3 class="comparison-title">How Glacier Compares</h3>
        <div class="chart-container">
          <canvas id="comparison-chart" aria-label="Price comparison chart showing Glacier is more affordable than average and big brand prices"></canvas>
        </div>
      </div>

      <!-- Lead Capture -->
      <div class="card lead-form">
        <h3 style="font-size: 16px; margin-bottom: 16px;">Save this quote for later</h3>
        <input type="text" id="lead-name" class="form-input" placeholder="Your name" aria-label="Your name">
        <input type="tel" id="lead-phone" class="form-input" placeholder="Phone number" aria-label="Phone number">
        <input type="email" id="lead-email" class="form-input" placeholder="Email address" aria-label="Email address">
        <button id="save-lead" class="btn btn-success">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          Send Me the Quote
        </button>
        <p id="lead-success" class="hidden" style="text-align: center; color: var(--success); margin-top: 12px; font-size: 14px;">
          Got it. Eyal will reach out within 24 hours.
        </p>
      </div>
    </section>
  </div>

  <!-- Confetti Container -->
  <div id="confetti-container" class="confetti-container"></div>

  <!-- Demo Disclaimer -->
  <div id="bct-demo-disclaimer" role="contentinfo" aria-label="Demo disclaimer">
    <p><strong>DEMO:</strong> This tool was created by BennyCuTools as a free demonstration only. It is not affiliated with, endorsed by, or authorized by Glacier Air Duct Cleaning.</p>
    <a href="mailto:cuuper225@gmail.com?subject=Delete%20Demo%3A%20Glacier%20Air%20Duct%20Cleaning">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>
      Request Permanent Deletion
    </a>
  </div>

  <script>
    // State
    const state = {
      currentStep: 1,
      sqft: '',
      stories: '',
      homeAge: '',
      hvacSystems: '',
      supplyVents: 0,
      returnVents: 0,
      addons: {
        dryer: false,
        sanitize: false,
        priority: false
      },
      isDemo: false,
      inServiceArea: null
    };

    // Auth
    const AUTH_HASH = -1254470962;
    
    function hashCode(str) {
      let hash = 0;
      for (let i = 0; i < str.length; i++) {
        hash = ((hash << 5) - hash) + str.charCodeAt(i);
        hash |= 0;
      }
      return hash;
    }

    function checkAuth() {
      const params = new URLSearchParams(window.location.search);
      const key = params.get('key');
      if (key && hashCode(key) === AUTH_HASH) {
        return true;
      }
      const stored = localStorage.getItem('ductquote_auth');
      if (stored && hashCode(stored) === AUTH_HASH) {
        return true;
      }
      return false;
    }

    function initAuth() {
      if (checkAuth()) {
        showApp();
        return;
      }
      
      document.getElementById('auth-wall').classList.remove('hidden');
      document.getElementById('main-app').classList.add('hidden');

      const input = document.getElementById('access-key-input');
      const submit = document.getElementById('access-key-submit');
      const error = document.getElementById('auth-error');

      submit.addEventListener('click', () => {
        const key = input.value.trim();
        if (hashCode(key) === AUTH_HASH) {
          localStorage.setItem('ductquote_auth', key);
          showApp();
        } else {
          error.classList.remove('hidden');
          input.focus();
        }
      });

      input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') submit.click();
      });
    }

    function showApp() {
      document.getElementById('auth-wall').classList.add('hidden');
      document.getElementById('main-app').classList.remove('hidden');
      checkServiceArea();
      loadDemoData();
    }

    // Service Area Check
    function checkServiceArea() {
      if (!navigator.geolocation) {
        updateServiceAreaUI(null);
        return;
      }

      navigator.geolocation.getCurrentPosition(
        (pos) => {
          const lat = pos.coords.latitude;
          const lng = pos.coords.longitude;
          // Colorado Springs area roughly: 38.7-39.0 lat, -104.9 to -104.6 lng
          const inArea = (lat >= 38.6 && lat <= 39.1 && lng >= -105.0 && lng <= -104.5);
          state.inServiceArea = inArea;
          updateServiceAreaUI(inArea);
        },
        () => {
          updateServiceAreaUI(null);
        },
        { timeout: 5000 }
      );
    }

    function updateServiceAreaUI(inArea) {
      const container = document.getElementById('service-area-status');
      if (inArea === null) {
        container.innerHTML = '';
        return;
      }
      if (inArea) {
        container.innerHTML = `
          <div class="service-check">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            You're in our service area!
          </div>
        `;
      } else {
        container.innerHTML = `
          <div class="service-check outside">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 8v4"/>
              <path d="M12 16h.01"/>
            </svg>
            You may be outside our primary service area. Call to confirm.
          </div>
        `;
      }
    }

    // Demo Data
    function loadDemoData() {
      const hasVisited = localStorage.getItem('ductquote_visited');
      if (hasVisited) return;

      state.isDemo = true;
      state.sqft = '2000';
      state.stories = '2';
      state.homeAge = '1990s';
      state.hvacSystems = '1';
      state.supplyVents = 12;
      state.returnVents = 3;
      state.addons.dryer = true;

      // Update UI
      document.getElementById('sqft').value = state.sqft;
      document.getElementById('stories').value = state.stories;
      document.getElementById('home-age').value = state.homeAge;
      document.getElementById('hvac-systems').value = state.hvacSystems;
      document.getElementById('supply-count').textContent = state.supplyVents;
      document.getElementById('return-count').textContent = state.returnVents;
      document.getElementById('addon-dryer').checked = true;
      document.querySelector('label[for="addon-dryer"]').classList.add('selected');

      // Show demo banner
      document.getElementById('demo-banner').classList.remove('hidden');
      
      // Enable buttons
      validateStep1();
      validateStep2();

      // Jump to quote result
      navigateToStep(4);
      updateQuote();
    }

    // Navigation
    function navigateToStep(step) {
      const currentEl = document.getElementById(`step-${state.currentStep}`);
      const nextEl = document.getElementById(`step-${step}`);

      // Animate out current step
      if (currentEl && state.currentStep !== step) {
        currentEl.style.opacity = '0';
        currentEl.style.transform = step > state.currentStep ? 'translateX(-30px) scale(0.98)' : 'translateX(30px) scale(0.98)';
      }

      setTimeout(() => {
        document.querySelectorAll('.step-container').forEach(s => {
          s.classList.remove('active');
          s.style.opacity = '';
          s.style.transform = '';
        });
        nextEl.classList.add('active');

        document.querySelectorAll('.progress-step').forEach((s, i) => {
          s.classList.remove('active', 'complete');
          if (i + 1 < step) s.classList.add('complete');
          if (i + 1 === step) s.classList.add('active');
        });

        state.currentStep = step;

        if (step === 4) {
          updateQuote();
          setTimeout(animatePrice, 100);
          if (!state.isDemo) {
            triggerConfetti();
          }
        }
      }, currentEl && state.currentStep !== step ? 200 : 0);
    }

    // Validation
    function validateStep1() {
      const sqft = document.getElementById('sqft').value;
      const stories = document.getElementById('stories').value;
      const homeAge = document.getElementById('home-age').value;
      const hvac = document.getElementById('hvac-systems').value;
      const btn = document.getElementById('step1-next');
      
      const valid = sqft && stories && homeAge && hvac;
      btn.disabled = !valid;
      
      state.sqft = sqft;
      state.stories = stories;
      state.homeAge = homeAge;
      state.hvacSystems = hvac;
    }

    function validateStep2() {
      const btn = document.getElementById('step2-next');
      const valid = state.supplyVents > 0 || state.returnVents > 0;
      btn.disabled = !valid;
    }

    // Pricing Logic
    function calculatePrice() {
      let basePrice = 200;
      
      // Square footage adjustment
      const sqft = parseInt(state.sqft) || 1500;
      if (sqft >= 2500) basePrice += 50;
      if (sqft >= 3500) basePrice += 50;
      if (sqft >= 4500) basePrice += 75;

      // Per-vent pricing
      const totalVents = state.supplyVents + state.returnVents;
      basePrice += totalVents * 12;

      // Multi-story adjustment
      if (state.stories === '2') basePrice += 25;
      if (state.stories === '3') basePrice += 50;

      // Multi-system adjustment
      const systems = parseInt(state.hvacSystems) || 1;
      if (systems >= 2) basePrice += 75 * (systems - 1);

      // Home age adjustment (older = harder access sometimes)
      if (state.homeAge === 'pre1980') basePrice += 25;

      // Add-ons
      if (state.addons.dryer) basePrice += 125;
      if (state.addons.sanitize) basePrice += 75;
      if (state.addons.priority) basePrice += 50;

      const lowPrice = Math.round(basePrice * 0.9);
      const highPrice = Math.round(basePrice * 1.1);

      return { low: lowPrice, high: highPrice, mid: basePrice, totalVents };
    }

    function updateQuote() {
      const { low, high, mid, totalVents } = calculatePrice();
      
      const priceEl = document.getElementById('quote-price');
      priceEl.textContent = `$${low}-$${high}`;
      
      document.getElementById('total-vents').textContent = totalVents;

      // Update summary
      const summary = document.getElementById('quote-summary');
      const sqftLabel = document.getElementById('sqft').options[document.getElementById('sqft').selectedIndex]?.text || 'Not set';
      const storiesLabel = document.getElementById('stories').options[document.getElementById('stories').selectedIndex]?.text || 'Not set';
      
      let summaryHTML = `
        <li class="summary-item">
          <span class="summary-label">Home Size</span>
          <span class="summary-value">${sqftLabel}</span>
        </li>
        <li class="summary-item">
          <span class="summary-label">Stories</span>
          <span class="summary-value">${storiesLabel}</span>
        </li>
        <li class="summary-item">
          <span class="summary-label">Supply Vents</span>
          <span class="summary-value">${state.supplyVents}</span>
        </li>
        <li class="summary-item">
          <span class="summary-label">Return Vents</span>
          <span class="summary-value">${state.returnVents}</span>
        </li>
      `;

      if (state.addons.dryer) {
        summaryHTML += `<li class="summary-item"><span class="summary-label">Dryer Vent Cleaning</span><span class="summary-value">+$125</span></li>`;
      }
      if (state.addons.sanitize) {
        summaryHTML += `<li class="summary-item"><span class="summary-label">Sanitization</span><span class="summary-value">+$75</span></li>`;
      }
      if (state.addons.priority) {
        summaryHTML += `<li class="summary-item"><span class="summary-label">Priority Scheduling</span><span class="summary-value">+$50</span></li>`;
      }

      summary.innerHTML = summaryHTML;

      // Update chart
      updateComparisonChart(mid);
    }

    // Comparison Chart
    let comparisonChart = null;
    let chartAnimated = false;

    function updateComparisonChart(glacierPrice) {
      const ctx = document.getElementById('comparison-chart').getContext('2d');

      const avgPrice = Math.round(glacierPrice * 1.25);
      const bigBrandPrice = Math.round(glacierPrice * 1.55);

      if (comparisonChart) {
        comparisonChart.data.datasets[0].data = [glacierPrice, avgPrice, bigBrandPrice];
        comparisonChart.update('active');
        return;
      }

      // Create gradient for Glacier bar
      const glacierGradient = ctx.createLinearGradient(0, 0, 0, 200);
      glacierGradient.addColorStop(0, '#28A745');
      glacierGradient.addColorStop(1, '#1e7e34');

      comparisonChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Glacier', 'COS Average', 'Big Brand'],
          datasets: [{
            label: 'Price',
            data: [glacierPrice, avgPrice, bigBrandPrice],
            backgroundColor: [glacierGradient, '#6c757d', '#dc3545'],
            borderRadius: 8,
            borderSkipped: false,
            barPercentage: 0.6
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          animation: {
            duration: 1200,
            easing: 'easeOutQuart',
            delay: (context) => {
              let delay = 0;
              if (context.type === 'data' && context.mode === 'default') {
                delay = context.dataIndex * 200;
              }
              return delay;
            }
          },
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: 'rgba(26, 58, 82, 0.9)',
              titleFont: { family: 'Play, sans-serif', size: 14 },
              bodyFont: { size: 13 },
              padding: 12,
              cornerRadius: 8,
              callbacks: {
                label: (ctx) => `$${ctx.raw.toLocaleString()}`
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: (val) => `$${val}`,
                font: { size: 11 }
              },
              grid: {
                color: 'rgba(0,0,0,0.05)'
              }
            },
            x: {
              grid: { display: false },
              ticks: {
                font: { size: 12, weight: '600' }
              }
            }
          }
        }
      });
    }

    // Confetti
    function triggerConfetti() {
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      
      const container = document.getElementById('confetti-container');
      const colors = ['#00C8F0', '#28A745', '#1A3A52', '#ffc107', '#fff'];
      
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + '%';
        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.animationDelay = Math.random() * 0.5 + 's';
        confetti.style.animationDuration = (2 + Math.random() * 2) + 's';
        container.appendChild(confetti);
      }

      setTimeout(() => {
        container.innerHTML = '';
      }, 4000);
    }

    // Web Share
    function shareQuote() {
      const { low, high } = calculatePrice();
      const text = `My Glacier Air Duct Cleaning quote: $${low}-$${high} for ${state.supplyVents + state.returnVents} vents. Family-owned, 5-star rated in Colorado Springs. Call (719) 257-3771`;

      if (navigator.share) {
        navigator.share({
          title: 'My Duct Cleaning Quote',
          text: text,
          url: 'https://www.glacierduct.com/'
        }).catch(() => {});
      } else if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
          alert('Quote copied to clipboard!');
        });
      } else {
        alert(text);
      }
    }

    // IndexedDB for leads
    function initDB() {
      return new Promise((resolve, reject) => {
        const request = indexedDB.open('DuctQuoteDB', 1);
        request.onerror = () => reject(request.error);
        request.onsuccess = () => resolve(request.result);
        request.onupgradeneeded = (e) => {
          const db = e.target.result;
          if (!db.objectStoreNames.contains('leads')) {
            db.createObjectStore('leads', { keyPath: 'id', autoIncrement: true });
          }
        };
      });
    }

    async function saveLead(name, phone, email) {
      try {
        const db = await initDB();
        const tx = db.transaction('leads', 'readwrite');
        const store = tx.objectStore('leads');
        
        const { low, high } = calculatePrice();
        
        store.add({
          name,
          phone,
          email,
          quote: `$${low}-$${high}`,
          sqft: state.sqft,
          stories: state.stories,
          supplyVents: state.supplyVents,
          returnVents: state.returnVents,
          addons: state.addons,
          timestamp: new Date().toISOString()
        });

        return new Promise((resolve, reject) => {
          tx.oncomplete = resolve;
          tx.onerror = () => reject(tx.error);
        });
      } catch (err) {
        console.error('Failed to save lead:', err);
      }
    }

    // Event Listeners
    function initEventListeners() {
      // Step 1 inputs
      ['sqft', 'stories', 'home-age', 'hvac-systems'].forEach(id => {
        document.getElementById(id).addEventListener('change', validateStep1);
      });

      // Step 1 next
      document.getElementById('step1-next').addEventListener('click', () => {
        navigateToStep(2);
      });

      // Vent counters
      document.getElementById('supply-plus').addEventListener('click', () => {
        state.supplyVents++;
        const el = document.getElementById('supply-count');
        el.textContent = state.supplyVents;
        animateCounter(el);
        validateStep2();
      });
      document.getElementById('supply-minus').addEventListener('click', () => {
        if (state.supplyVents > 0) {
          state.supplyVents--;
          const el = document.getElementById('supply-count');
          el.textContent = state.supplyVents;
          animateCounter(el);
          validateStep2();
        }
      });
      document.getElementById('return-plus').addEventListener('click', () => {
        state.returnVents++;
        const el = document.getElementById('return-count');
        el.textContent = state.returnVents;
        animateCounter(el);
        validateStep2();
      });
      document.getElementById('return-minus').addEventListener('click', () => {
        if (state.returnVents > 0) {
          state.returnVents--;
          const el = document.getElementById('return-count');
          el.textContent = state.returnVents;
          animateCounter(el);
          validateStep2();
        }
      });

      // Step 2 navigation
      document.getElementById('step2-back').addEventListener('click', () => navigateToStep(1));
      document.getElementById('step2-next').addEventListener('click', () => navigateToStep(3));

      // Add-ons
      document.querySelectorAll('.addon-input').forEach(input => {
        input.addEventListener('change', (e) => {
          const item = e.target.closest('.addon-item');
          item.classList.toggle('selected', e.target.checked);
          
          if (e.target.id === 'addon-dryer') state.addons.dryer = e.target.checked;
          if (e.target.id === 'addon-sanitize') state.addons.sanitize = e.target.checked;
          if (e.target.id === 'addon-priority') state.addons.priority = e.target.checked;
        });
      });

      // Step 3 navigation
      document.getElementById('step3-back').addEventListener('click', () => navigateToStep(2));
      document.getElementById('step3-next').addEventListener('click', () => {
        localStorage.setItem('ductquote_visited', 'true');
        state.isDemo = false;
        navigateToStep(4);
      });

      // Share quote
      document.getElementById('share-quote').addEventListener('click', shareQuote);

      // Start over
      document.getElementById('start-over').addEventListener('click', () => {
        state.sqft = '';
        state.stories = '';
        state.homeAge = '';
        state.hvacSystems = '';
        state.supplyVents = 0;
        state.returnVents = 0;
        state.addons = { dryer: false, sanitize: false, priority: false };
        state.isDemo = false;

        document.getElementById('sqft').value = '';
        document.getElementById('stories').value = '';
        document.getElementById('home-age').value = '';
        document.getElementById('hvac-systems').value = '';
        document.getElementById('supply-count').textContent = '0';
        document.getElementById('return-count').textContent = '0';
        document.querySelectorAll('.addon-input').forEach(i => {
          i.checked = false;
          i.closest('.addon-item').classList.remove('selected');
        });

        document.getElementById('demo-banner').classList.add('hidden');
        document.getElementById('step1-next').disabled = true;
        document.getElementById('step2-next').disabled = true;

        navigateToStep(1);
      });

      // Demo banner close
      document.getElementById('demo-close').addEventListener('click', () => {
        document.getElementById('demo-banner').classList.add('hidden');
      });

      // Lead capture
      document.getElementById('save-lead').addEventListener('click', async () => {
        const name = document.getElementById('lead-name').value.trim();
        const phone = document.getElementById('lead-phone').value.trim();
        const email = document.getElementById('lead-email').value.trim();

        if (!name && !phone && !email) {
          alert('Please enter at least your name, phone, or email.');
          return;
        }

        await saveLead(name, phone, email);
        document.getElementById('lead-success').classList.remove('hidden');
        document.getElementById('save-lead').disabled = true;
        document.getElementById('save-lead').textContent = 'Saved!';
      });
    }

    // Anti-scrape Protection
    function initAntiScrape() {
      // Block right-click
      document.addEventListener('contextmenu', (e) => {
        e.preventDefault();
        return false;
      });

      // Block dev tools shortcuts
      document.addEventListener('keydown', (e) => {
        // F12
        if (e.key === 'F12') {
          e.preventDefault();
          return false;
        }
        // Ctrl+Shift+I/J/C
        if ((e.ctrlKey || e.metaKey) && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C')) {
          e.preventDefault();
          return false;
        }
        // Ctrl+U (view source)
        if ((e.ctrlKey || e.metaKey) && e.key === 'u') {
          e.preventDefault();
          return false;
        }
      });

      // Console warning
      const styles = [
        'background: linear-gradient(135deg, #1A3A52 0%, #00C8F0 100%)',
        'color: #fff',
        'padding: 20px',
        'font-size: 14px',
        'font-weight: bold',
        'border-radius: 8px'
      ].join(';');

      console.log('%c<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8l-8 8-4-4M22 12l-8 8-4-4"/></svg> Hey there! This tool was built by BennyCuTools for Glacier Air Duct Cleaning.', styles);
      console.log('%cInterested in a custom tool for your business? Reach out at cuuper225@gmail.com', 'color: #00C8F0; font-size: 12px;');
    }

    // Enhanced Counter Animation
    function animateCounter(element) {
      element.classList.add('animating');
      setTimeout(() => element.classList.remove('animating'), 250);
    }

    // Enhanced Price Animation
    function animatePrice() {
      const priceEl = document.getElementById('quote-price');
      if (priceEl) {
        priceEl.classList.remove('animating');
        void priceEl.offsetWidth; // Force reflow
        priceEl.classList.add('animating');
      }
    }

    // Init
    document.addEventListener('DOMContentLoaded', () => {
      initAuth();
      initEventListeners();
      initAntiScrape();
    });
  </script>
</body>
</html>
