<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TermiteLog - Take Care Termite</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700;800&family=Open+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
--pri:#2e7d32;--pri-light:#43a047;--pri-dark:#1b5e20;
--accent:#37474f;--accent-light:#546e7a;
--s1:#c62828;--s1-bg:#ffebee;--s2:#e65100;--s2-bg:#fff3e0;
--bg:#f1f3f2;--surf:#fff;--surf-alt:#f5f7f6;
--text:#1a2e1e;--text-m:#5a6e5e;--text-l:#8a9a8e;
--bdr:#d8e0d9;--bdr-f:#2e7d32;
--ok:#2e7d32;--warn:#e65100;--err:#c62828;
--sh-sm:0 1px 2px rgba(0,0,0,.05);--sh:0 2px 4px rgba(0,0,0,.08);--sh-md:0 4px 8px rgba(0,0,0,.1);--sh-lg:0 10px 20px rgba(0,0,0,.12);
--r:8px;--rl:12px;
--fh:'Montserrat',sans-serif;--fb:'Open Sans',sans-serif;
}
html{font-size:16px}
body{font-family:var(--fb);background:var(--bg);color:var(--text);line-height:1.5;padding-bottom:120px!important;overflow-x:hidden;-webkit-font-smoothing:antialiased}
h1,h2,h3,h4{font-family:var(--fh);font-weight:700;line-height:1.2}
*:focus-visible{outline:2px solid var(--pri);outline-offset:2px}
@media(prefers-reduced-motion:reduce){*,*::before,*::after{animation-duration:.01ms!important;transition-duration:.01ms!important}}
.skip{position:absolute;top:-100px;left:0;background:var(--pri);color:#fff;padding:8px 16px;z-index:100000;border-radius:0 0 var(--r) 0}.skip:focus{top:0}

#app{display:none;min-height:100vh}
.hdr{background:linear-gradient(135deg,var(--pri-dark),var(--pri));color:#fff;padding:16px 20px 14px;position:sticky;top:0;z-index:900}
.hdr h1{font-size:1.2rem;letter-spacing:-.01em}.hdr p{font-size:.78rem;opacity:.7;margin-top:2px;font-weight:300}

.demo-b{background:#e8f5e9;border-bottom:1px solid #c8e6c9;padding:10px 16px;display:flex;align-items:center;justify-content:space-between;font-size:.82rem;color:#1b5e20}
.demo-b button{background:none;border:1px solid #4caf50;color:#1b5e20;padding:4px 10px;border-radius:4px;cursor:pointer;font-size:.78rem}

.view{display:none;padding:16px;animation:fu .3s ease-out}.view.active{display:block}
@keyframes fu{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

.card{background:var(--surf);border-radius:var(--rl);box-shadow:var(--sh);padding:16px;margin-bottom:10px;cursor:pointer;transition:transform .12s;position:relative;overflow:hidden}
.card:hover{transform:translateY(-1px);box-shadow:var(--sh-md)}
.card-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:6px}
.card-addr{font-family:var(--fh);font-weight:600;font-size:.92rem}
.card-cost{font-family:var(--fh);font-weight:700;font-size:1rem;color:var(--pri)}
.card-sub{font-size:.8rem;color:var(--text-m);margin-bottom:4px}
.card-tags{display:flex;gap:6px;flex-wrap:wrap}
.tag{display:inline-block;padding:2px 8px;border-radius:16px;font-size:.7rem;font-weight:600}
.tag-s1{background:var(--s1-bg);color:var(--s1)}.tag-s2{background:var(--s2-bg);color:var(--s2)}
.tag-status{background:#e0f2f1;color:#00695c}

.fsec{margin-bottom:16px}
.fsec-t{font-family:var(--fh);font-weight:600;font-size:.82rem;color:var(--pri);text-transform:uppercase;letter-spacing:.05em;margin-bottom:8px;padding-bottom:5px;border-bottom:2px solid var(--bdr)}
.fg{margin-bottom:10px}
.fg label{display:block;font-size:.8rem;font-weight:500;color:var(--text-m);margin-bottom:3px}
.fg input,.fg select,.fg textarea{width:100%;padding:10px 12px;border:1.5px solid var(--bdr);border-radius:var(--r);font-size:1rem;background:var(--surf);color:var(--text);transition:border-color .15s,box-shadow .15s}
.fg input:focus,.fg select:focus,.fg textarea:focus{border-color:var(--bdr-f);box-shadow:0 0 0 3px rgba(46,125,50,.1)}
.fr{display:grid;grid-template-columns:1fr 1fr;gap:10px}

/* Finding cards */
.finding{background:var(--surf);border-radius:var(--r);border-left:4px solid var(--text-l);padding:12px;margin-bottom:8px;position:relative}
.finding.s1{border-left-color:var(--s1)}
.finding.s2{border-left-color:var(--s2)}
.finding-type{font-weight:600;font-size:.88rem;margin-bottom:2px}
.finding-loc{font-size:.78rem;color:var(--text-m)}
.finding-cost{font-family:var(--fh);font-weight:700;position:absolute;top:12px;right:12px;color:var(--pri)}
.finding-photo{width:60px;height:60px;border-radius:6px;object-fit:cover;margin-top:6px}
.finding-del{position:absolute;bottom:8px;right:8px;background:none;border:none;color:var(--text-l);cursor:pointer;font-size:.75rem;padding:4px 8px}

/* Section summary */
.section-summary{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin:14px 0}
.ss-card{padding:14px;border-radius:var(--r);text-align:center}
.ss-card.s1{background:var(--s1-bg);border:1px solid #ef9a9a}
.ss-card.s2{background:var(--s2-bg);border:1px solid #ffcc80}
.ss-card .ss-label{font-size:.72rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;margin-bottom:4px}
.ss-card .ss-count{font-family:var(--fh);font-size:1.5rem;font-weight:800}
.ss-card .ss-cost{font-size:.82rem;font-weight:600;margin-top:2px}

/* Quick picks */
.qp-grid{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:10px}
.qp{padding:6px 12px;background:var(--surf-alt);border:1.5px solid var(--bdr);border-radius:20px;font-size:.78rem;cursor:pointer;transition:all .1s;font-weight:500}
.qp.selected{background:var(--pri);color:#fff;border-color:var(--pri)}
.qp:active{transform:scale(.96)}

/* Photo area */
.photo-btn{display:flex;align-items:center;gap:8px;padding:12px;background:var(--surf-alt);border:2px dashed var(--bdr);border-radius:var(--r);cursor:pointer;font-size:.85rem;color:var(--text-m);transition:border-color .15s}
.photo-btn:hover{border-color:var(--pri)}

.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:11px 18px;border:none;border-radius:var(--r);font-size:.88rem;font-weight:600;cursor:pointer;transition:transform .1s;font-family:var(--fb)}
.btn:active{transform:scale(.97)}
.btn-pri{background:var(--pri);color:#fff;box-shadow:var(--sh)}.btn-pri:hover{background:var(--pri-dark)}
.btn-sec{background:var(--surf);color:var(--text);border:1.5px solid var(--bdr)}
.btn-sm{padding:7px 12px;font-size:.8rem}
.btn-block{width:100%}
.btn-danger{background:#ffebee;color:var(--err)}
.upsell-lock{opacity:.45;pointer-events:none;position:relative}
.upsell-lock::after{content:'Full Version';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--accent);color:#fff;padding:3px 10px;border-radius:16px;font-size:.72rem;font-weight:600}

.bnav{position:fixed;bottom:40px;left:0;right:0;background:var(--surf);border-top:1px solid var(--bdr);display:flex;z-index:800;box-shadow:0 -2px 8px rgba(0,0,0,.04)}
.ni{flex:1;display:flex;flex-direction:column;align-items:center;padding:8px 0;cursor:pointer;color:var(--text-l);transition:color .12s;border:none;background:none;font-size:.67rem;font-weight:500;gap:2px}
.ni.active{color:var(--pri)}
.ni svg{width:22px;height:22px}

.toast-c{position:fixed;top:80px;right:16px;z-index:6000}
.toast{background:#1a2e1e;color:#fff;padding:10px 14px;border-radius:var(--r);font-size:.82rem;margin-bottom:6px;animation:si .25s ease-out;box-shadow:var(--sh-lg)}
@keyframes si{from{opacity:0;transform:translateX(16px)}to{opacity:1;transform:translateX(0)}}

.empty{text-align:center;padding:44px 20px}
.empty svg{margin-bottom:14px;color:var(--text-l)}
.empty h3{margin-bottom:6px}.empty p{color:var(--text-m);font-size:.88rem;margin-bottom:18px;max-width:280px;margin-left:auto;margin-right:auto}

.sbox{padding:16px;background:var(--surf);border-radius:var(--rl);margin-bottom:10px;box-shadow:var(--sh-sm)}
.sbox h3{font-size:.88rem;font-weight:600;margin-bottom:10px;color:var(--pri)}

/* Camera */
#camOv{display:none;position:fixed;inset:0;background:#000;z-index:5000;flex-direction:column}
#camOv.active{display:flex}
#camVid{flex:1;object-fit:cover;width:100%}
.cam-bar{position:absolute;bottom:0;left:0;right:0;padding:20px;display:flex;justify-content:center;background:linear-gradient(transparent,rgba(0,0,0,.7))}
.cam-snap{width:60px;height:60px;border-radius:50%;border:3px solid #fff;background:rgba(255,255,255,.2);cursor:pointer;display:flex;align-items:center;justify-content:center}
.cam-snap:active{transform:scale(.9)}
.cam-x{position:absolute;top:16px;right:16px;width:36px;height:36px;border-radius:50%;background:rgba(0,0,0,.5);border:none;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center}

@media print{.bnav,.hdr,.demo-b,.toast-c,#bct-demo-disclaimer,.btn,.upsell-lock{display:none!important}body{background:#fff;padding:0!important}.view{display:block!important;padding:0}.finding{page-break-inside:avoid}}
@media(min-width:1024px){.bnav{display:none}#app{max-width:480px;margin:0 auto}.dnav{display:flex;gap:4px;background:var(--surf);padding:4px;border-radius:var(--r);margin:16px;box-shadow:var(--sh)}.dnav button{flex:1;padding:9px;border:none;background:none;border-radius:6px;cursor:pointer;font-weight:500;font-size:.83rem;color:var(--text-m);transition:all .12s}.dnav button.active{background:var(--pri);color:#fff}}
@media(max-width:1023px){.dnav{display:none}}
</style>
</head>
<body>
<a href="#main" class="skip">Skip to content</a>
<div id="gate" style="display:flex;align-items:center;justify-content:center;height:100vh;font-family:var(--fb);background:#111;color:#fff;text-align:center;padding:20px"><div><h1 style="font-size:2rem;margin-bottom:1rem;font-family:var(--fh)">Access Required</h1><p style="color:#999;margin-bottom:20px">This tool needs a valid access key.</p><p><a href="mailto:ben@bennycutools.com" style="color:#4da6ff">ben@bennycutools.com</a></p></div></div>

<div id="app" role="application">
<header class="hdr"><h1>TermiteLog</h1><p>Take Care Termite -- Field Reports</p></header>
<div class="demo-b" id="demoB" role="alert"><span>Sample Tracy inspections loaded.</span><button onclick="clearDemo()" aria-label="Clear demo data">Clear</button></div>
<nav class="dnav" aria-label="Main navigation"><button class="active" onclick="go('list')" data-v="list">Inspections</button><button onclick="go('new')" data-v="new">New</button><button onclick="go('settings')" data-v="settings">Settings</button></nav>
<main id="main">

<!-- LIST -->
<section class="view active" id="listView" aria-label="Inspections">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
<h2 style="font-size:1.1rem">Inspections</h2>
<button class="btn btn-pri btn-sm" onclick="go('new')" aria-label="New inspection"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg> New</button>
</div>
<div id="listEl"></div>
</section>

<!-- NEW/EDIT -->
<section class="view" id="newView" aria-label="New inspection">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
<h2 id="fTitle" style="font-size:1.05rem">New Inspection</h2>
<button class="btn btn-sec btn-sm" onclick="go('list')">Back</button>
</div>

<div class="fsec"><div class="fsec-t">Property</div>
<div class="fg"><label for="pAddr">Address</label><input type="text" id="pAddr" placeholder="1428 W 11th St, Tracy, CA" autocomplete="street-address"></div>
<div class="fr">
<div class="fg"><label for="pType">Property Type</label><select id="pType"><option value="single">Single Family</option><option value="multi">Multi-Family</option><option value="commercial">Commercial</option><option value="condo">Condo/Townhome</option></select></div>
<div class="fg"><label for="pYear">Year Built</label><input type="number" id="pYear" placeholder="1972" min="1800" max="2030"></div>
</div>
</div>

<div class="fsec"><div class="fsec-t">Client</div>
<div class="fr">
<div class="fg"><label for="cName">Client Name</label><input type="text" id="cName" placeholder="Buyer or agent name" autocomplete="name"></div>
<div class="fg"><label for="cPhone">Phone</label><input type="tel" id="cPhone" placeholder="(209) 555-0100" autocomplete="tel"></div>
</div>
<div class="fg"><label for="cAgent">Real Estate Agent</label><input type="text" id="cAgent" placeholder="Agent name (optional)"></div>
</div>

<div class="fsec"><div class="fsec-t">Findings</div>
<div class="section-summary">
<div class="ss-card s1"><div class="ss-label">Section 1</div><div class="ss-count" id="s1Count">0</div><div class="ss-cost" id="s1Cost">$0</div></div>
<div class="ss-card s2"><div class="ss-label">Section 2</div><div class="ss-count" id="s2Count">0</div><div class="ss-cost" id="s2Cost">$0</div></div>
</div>
<div id="findingsEl"></div>
<button class="btn btn-sec btn-block" onclick="addFinding()" style="margin-top:8px"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg> Add Finding</button>
</div>

<div class="fsec"><div class="fg"><label for="notes">Inspector Notes</label><textarea id="notes" rows="2" placeholder="General observations..."></textarea></div></div>

<div style="display:flex;gap:8px;margin-top:14px"><button class="btn btn-pri btn-block" onclick="saveInsp()">Save Inspection</button></div>
<div style="display:flex;gap:8px;margin-top:6px">
<button class="btn btn-sec btn-block" onclick="shareInsp()"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg> Share Summary</button>
<button class="btn btn-sec btn-block upsell-lock" disabled><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg> PDF Report</button>
</div>
</section>

<!-- DETAIL -->
<section class="view" id="detailView" aria-label="Inspection detail">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
<button class="btn btn-sec btn-sm" onclick="go('list')">Back</button>
<div style="display:flex;gap:6px">
<button class="btn btn-pri btn-sm" onclick="shareInsp()">Share</button>
<button class="btn btn-sec btn-sm" onclick="editInsp()">Edit</button>
</div>
</div>
<div id="detailEl"></div>
</section>

<!-- SETTINGS -->
<section class="view" id="settingsView" aria-label="Settings">
<h2 style="margin-bottom:14px;font-size:1.05rem">Settings</h2>
<div class="sbox"><h3>Inspector Info</h3>
<div class="fg"><label for="iName">Inspector Name</label><input type="text" id="iName" value="Ray Carrier"></div>
<div class="fg"><label for="iLic">License #</label><input type="text" id="iLic" placeholder="SPCB license number"></div>
</div>
<div class="sbox"><h3>Data</h3>
<div style="display:flex;gap:8px;flex-wrap:wrap">
<button class="btn btn-sec btn-sm" onclick="expData()">Export JSON</button>
<button class="btn btn-sec btn-sm" onclick="document.getElementById('impF').click()">Import JSON</button>
<input type="file" id="impF" accept=".json" style="display:none" onchange="impData(event)">
<button class="btn btn-danger btn-sm" onclick="resetAll()">Reset All</button>
</div></div>
<div class="sbox"><h3 style="display:flex;align-items:center;gap:8px">Branded PDF Reports <span style="display:inline-block;padding:2px 8px;background:#e8f5e9;border:1px solid #a5d6a7;border-radius:16px;font-size:.68rem;font-weight:600;color:#2e7d32;text-transform:uppercase">Full Version</span></h3>
<p style="font-size:.83rem;color:var(--text-m)">Generate letterhead PDF reports with digital signature, company logo, and direct email delivery to agents. $200 one-time.</p>
</div>
</section>

<!-- FINDING FORM (modal-like) -->
<section class="view" id="findingView" aria-label="Add finding">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
<h2 style="font-size:1.05rem">Add Finding</h2>
<button class="btn btn-sec btn-sm" onclick="cancelFinding()">Cancel</button>
</div>
<div class="fsec"><div class="fsec-t">Finding Type</div>
<div class="qp-grid" id="typeGrid"></div>
</div>
<div class="fsec"><div class="fsec-t">Location</div>
<div class="qp-grid" id="locGrid"></div>
</div>
<div class="fsec"><div class="fsec-t">Classification</div>
<div style="display:flex;gap:8px">
<button class="qp" id="secBtn1" onclick="setSec(1)" style="flex:1;text-align:center;padding:12px">Section 1<br><span style="font-size:.72rem">Active infestation</span></button>
<button class="qp" id="secBtn2" onclick="setSec(2)" style="flex:1;text-align:center;padding:12px">Section 2<br><span style="font-size:.72rem">Conditions conducive</span></button>
</div>
</div>
<div class="fsec">
<div class="fg"><label for="fCost">Estimated Repair Cost ($)</label><input type="number" id="fCost" placeholder="500" min="0" step="50"></div>
<div class="fg"><label for="fNotes">Details</label><textarea id="fNotes" rows="2" placeholder="Describe the finding..."></textarea></div>
</div>
<div class="fsec">
<div class="fsec-t">Photo</div>
<div class="photo-btn" onclick="openCam()" role="button" tabindex="0" aria-label="Take photo">
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"/><circle cx="12" cy="13" r="4"/></svg>
<span id="photoStatus">Tap to photograph this finding</span>
</div>
<div id="photoPreview" style="margin-top:8px"></div>
</div>
<button class="btn btn-pri btn-block" onclick="saveFinding()">Save Finding</button>
</section>

</main>

<nav class="bnav" aria-label="Main navigation">
<button class="ni active" onclick="go('list')" data-v="list" aria-label="Inspections"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"><path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2"/><rect x="9" y="3" width="6" height="4" rx="1"/><path d="M9 14l2 2 4-4"/></svg>Inspections</button>
<button class="ni" onclick="go('new')" data-v="new" aria-label="New"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>New</button>
<button class="ni" onclick="go('settings')" data-v="settings" aria-label="Settings"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 01-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg>Settings</button>
</nav>
</div>

<!-- Camera -->
<div id="camOv" role="dialog" aria-label="Camera">
<video id="camVid" autoplay playsinline></video>
<button class="cam-x" onclick="closeCam()" aria-label="Close camera"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
<div class="cam-bar"><button class="cam-snap" onclick="snap()" aria-label="Capture photo"><svg width="24" height="24" viewBox="0 0 24 24" fill="#fff" stroke="none"><circle cx="12" cy="12" r="8"/></svg></button></div>
</div>

<div class="toast-c" id="toastC" aria-live="polite" aria-atomic="true"></div>

<div id="bct-demo-disclaimer" role="contentinfo" aria-label="Demo disclaimer" style="position:fixed;bottom:0;left:0;right:0;background:#f8f8f8;border-top:1px solid #ddd;padding:10px 16px;font-size:12px;line-height:1.4;color:#666;z-index:99999;display:flex;flex-wrap:wrap;align-items:center;justify-content:center;gap:8px 16px;text-align:center;">
<p style="margin:0;max-width:700px;"><strong style="color:#333;">DEMO NOTICE:</strong> This tool was created by BennyCuTools as a free demonstration only. It is not affiliated with, endorsed by, or authorized by Take Care Termite & Pest Control. All brand references are used solely for demonstration purposes.</p>
<a href="mailto:cuuper225@gmail.com?subject=Delete%20Demo%3A%20Take%20Care%20Termite&body=I%20am%20the%20owner%20and%20I%20request%20permanent%20deletion%20of%20this%20demo." style="display:inline-flex;align-items:center;gap:4px;background:#dc3545;color:#fff;padding:5px 12px;border-radius:4px;text-decoration:none;font-size:11px;font-weight:500;white-space:nowrap;"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>Request Permanent Deletion</a>
</div>

<script>
function _h(s){let h=0;for(let i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i);h|=0;}return h;}
const _V=-1907013736;
const _k=new URLSearchParams(window.location.search).get('key');
if(_k&&_h(_k)===_V){localStorage.setItem('tl_a','1');document.getElementById('gate').style.display='none';document.getElementById('app').style.display='block';init();}
else if(localStorage.getItem('tl_a')==='1'){document.getElementById('gate').style.display='none';document.getElementById('app').style.display='block';init();}
document.addEventListener('contextmenu',e=>e.preventDefault());

let db;
function odb(){return new Promise((r,j)=>{const q=indexedDB.open('TermiteLogDB',1);q.onupgradeneeded=e=>{const d=e.target.result;if(!d.objectStoreNames.contains('inspections'))d.createObjectStore('inspections',{keyPath:'id'});};q.onsuccess=e=>{db=e.target.result;r();};q.onerror=e=>j(e);});}
function pt(d){return new Promise((r,j)=>{const t=db.transaction('inspections','readwrite');t.objectStore('inspections').put(d);t.oncomplete=()=>r();});}
function ga(){return new Promise((r,j)=>{const t=db.transaction('inspections','readonly');const q=t.objectStore('inspections').getAll();q.onsuccess=()=>r(q.result);});}
function gt(k){return new Promise((r,j)=>{const t=db.transaction('inspections','readonly');const q=t.objectStore('inspections').get(k);q.onsuccess=()=>r(q.result);});}
function dl(k){return new Promise((r,j)=>{const t=db.transaction('inspections','readwrite');t.objectStore('inspections').delete(k);t.oncomplete=()=>r();});}
function cl(){return new Promise((r,j)=>{const t=db.transaction('inspections','readwrite');t.objectStore('inspections').clear();t.oncomplete=()=>r();});}

let editId=null;let findings=[];let curFinding={};let curPhoto=null;let curSec=1;let selType='';let selLoc='';let camStream=null;

const TYPES=['Subterranean termite evidence','Drywood termite evidence','Dampwood termite evidence','Wood-boring beetle damage','Fungus damage (dry rot)','Fungus damage (wet rot)','Water damage to wood','Earth-to-wood contact','Faulty grade (soil above sill)','Cellulose debris','Insufficient ventilation','Shower/tub leak','Plumbing leak','Inaccessible area noted'];
const LOCS=['Crawl space','Attic','Garage','Exterior - North','Exterior - South','Exterior - East','Exterior - West','Bathroom','Kitchen','Laundry','Living room','Bedroom','Foundation','Roof eaves','Fence line','Deck/patio'];

const DEMOS=[
{id:'d1',addr:'1428 W 11th St, Tracy, CA 95376',ptype:'single',year:'1972',client:'Sandra Mitchell (buyer)',phone:'(209) 555-0147',agent:'Mike Torres, Century 21',findings:[
{type:'Subterranean termite evidence',loc:'Crawl space',sec:1,cost:1200,notes:'Shelter tubes along east foundation wall, approximately 8 linear feet. Active colony.',photo:null},
{type:'Fungus damage (dry rot)',loc:'Crawl space',sec:1,cost:900,notes:'Floor joists above termite activity show significant fungus damage. 3 joists need sistering.',photo:null},
{type:'Earth-to-wood contact',loc:'Exterior - South',sec:2,cost:350,notes:'Soil grade against wood siding at rear patio. Need to cut back soil 6 inches.',photo:null},
{type:'Insufficient ventilation',loc:'Crawl space',sec:2,cost:450,notes:'Only 4 foundation vents for 1,600 sq ft. Code requires 8. Add 4 vents.',photo:null}
],notes:'Overall structure shows deferred maintenance. Recommend full treatment before close of escrow.',total:2900,status:'completed',date:Date.now()-86400000*4,isDemo:true},
{id:'d2',addr:'3210 Corral Hollow Rd, Tracy, CA 95377',ptype:'single',year:'1985',client:'James & Pam Nguyen (buyer)',phone:'(209) 555-0289',agent:'Lisa Kwan, Coldwell Banker',findings:[
{type:'Drywood termite evidence',loc:'Attic',sec:1,cost:2800,notes:'Drywood termite pellets found under rafters. Recommend full-structure fumigation.',photo:null},
{type:'Water damage to wood',loc:'Bathroom',sec:2,cost:600,notes:'Master bathroom window frame shows water intrusion damage. Recaulk and treat.',photo:null}
],notes:'Attic findings significant. Buyer should budget for fumigation.',total:3400,status:'pending',date:Date.now()-86400000,isDemo:true},
];

async function init(){
await odb();
const insps=await ga();
if(!localStorage.getItem('tl_v')&&!insps.length){
for(const d of DEMOS)await pt(d);localStorage.setItem('tl_v','1');
}
renderList();renderTypeGrid();renderLocGrid();
}

function go(v){
document.querySelectorAll('.view').forEach(el=>el.classList.remove('active'));
const el=document.getElementById(v+'View');if(el)el.classList.add('active');
document.querySelectorAll('.ni,.dnav button').forEach(b=>b.classList.toggle('active',b.getAttribute('data-v')===v));
if(v==='list'){renderList();editId=null;}
if(v==='new'&&!editId)resetForm();
}

async function renderList(){
const insps=(await ga()).sort((a,b)=>b.date-a.date);
const el=document.getElementById('listEl');
document.getElementById('demoB').style.display=insps.some(i=>i.isDemo)?'flex':'none';
if(!insps.length){el.innerHTML=`<div class="empty"><svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"><path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2"/><rect x="9" y="3" width="6" height="4" rx="1"/></svg><h3>No inspections yet</h3><p>Start a new inspection from the field.</p><button class="btn btn-pri" onclick="go('new')">New Inspection</button></div>`;return;}
el.innerHTML=insps.map(i=>{
const d=new Date(i.date).toLocaleDateString('en-US',{month:'short',day:'numeric'});
const s1=i.findings.filter(f=>f.sec===1).length;
const s2=i.findings.filter(f=>f.sec===2).length;
return `<div class="card" onclick="viewInsp('${i.id}')" tabindex="0" aria-label="View ${i.addr}"><div class="card-top"><span class="card-addr">${i.addr}</span><span class="card-cost">$${i.total||0}</span></div><div class="card-sub">${i.client||'No client'}${i.agent?' -- '+i.agent:''}</div><div class="card-tags"><span class="tag tag-s1">${s1} Sec 1</span><span class="tag tag-s2">${s2} Sec 2</span><span class="tag tag-status">${i.status||'draft'}</span><span style="font-size:.72rem;color:var(--text-l)">${d}</span></div></div>`;
}).join('');
}

async function viewInsp(id){
const i=await gt(id);if(!i)return;editId=id;
const s1f=i.findings.filter(f=>f.sec===1),s2f=i.findings.filter(f=>f.sec===2);
const s1t=s1f.reduce((a,f)=>a+(f.cost||0),0),s2t=s2f.reduce((a,f)=>a+(f.cost||0),0);
document.getElementById('detailEl').innerHTML=`
<div style="background:var(--surf);border-radius:var(--rl);box-shadow:var(--sh-lg);overflow:hidden">
<div style="background:linear-gradient(135deg,var(--pri-dark),var(--pri));color:#fff;padding:20px;text-align:center"><h2 style="font-size:1.15rem">Take Care Termite</h2><p style="opacity:.8;font-size:.82rem">WDO Inspection Summary</p></div>
<div style="padding:16px">
<div style="margin-bottom:12px"><strong style="font-size:.78rem;color:var(--text-m)">Property</strong><p style="font-size:.95rem;font-weight:600">${i.addr}</p><p style="font-size:.82rem;color:var(--text-m)">${i.ptype||''} ${i.year?'('+i.year+')':''}</p></div>
<div style="margin-bottom:12px"><strong style="font-size:.78rem;color:var(--text-m)">Client</strong><p style="font-size:.88rem">${i.client||'-'}${i.agent?'<br><span style="font-size:.82rem;color:var(--text-m)">Agent: '+i.agent+'</span>':''}</p></div>
<div class="section-summary"><div class="ss-card s1"><div class="ss-label">Section 1</div><div class="ss-count">${s1f.length}</div><div class="ss-cost">$${s1t}</div></div><div class="ss-card s2"><div class="ss-label">Section 2</div><div class="ss-count">${s2f.length}</div><div class="ss-cost">$${s2t}</div></div></div>
${i.findings.map(f=>`<div class="finding ${f.sec===1?'s1':'s2'}"><div class="finding-type">${f.type}</div><div class="finding-loc">${f.loc} -- Section ${f.sec}</div><div class="finding-cost">$${f.cost||0}</div>${f.notes?'<p style="font-size:.8rem;color:var(--text-m);margin-top:4px">'+f.notes+'</p>':''}${f.photo?'<img class="finding-photo" src="'+f.photo+'" alt="Finding photo">':''}</div>`).join('')}
<div style="display:flex;justify-content:space-between;font-size:1.1rem;font-weight:700;padding:12px 0;margin-top:8px;border-top:2px solid var(--text);color:var(--pri)"><span>Total Estimated Repairs</span><span>$${i.total||0}</span></div>
${i.notes?'<div style="margin-top:10px;padding:10px;background:var(--surf-alt);border-radius:var(--r);font-size:.83rem"><strong>Notes:</strong> '+i.notes+'</div>':''}
</div></div>
<div style="display:flex;gap:8px;margin-top:12px">
<select style="flex:1;padding:8px;border:1.5px solid var(--bdr);border-radius:var(--r)" onchange="updStat('${id}',this.value)" aria-label="Update status"><option value="pending" ${i.status==='pending'?'selected':''}>Pending</option><option value="completed" ${i.status==='completed'?'selected':''}>Completed</option><option value="sent" ${i.status==='sent'?'selected':''}>Sent to Agent</option></select>
<button class="btn btn-danger btn-sm" onclick="delInsp('${id}')">Delete</button>
</div>`;
go('detail');
}

async function updStat(id,s){const i=await gt(id);if(i){i.status=s;await pt(i);toast('Updated');}}
async function delInsp(id){if(!confirm('Delete?'))return;await dl(id);toast('Deleted');go('list');}
function editInsp(){if(!editId)return;gt(editId).then(i=>{if(!i)return;document.getElementById('pAddr').value=i.addr||'';document.getElementById('pType').value=i.ptype||'single';document.getElementById('pYear').value=i.year||'';document.getElementById('cName').value=i.client||'';document.getElementById('cPhone').value=i.phone||'';document.getElementById('cAgent').value=i.agent||'';document.getElementById('notes').value=i.notes||'';findings=i.findings?i.findings.slice():[];renderFindings();document.getElementById('fTitle').textContent='Edit Inspection';go('new');});}

function resetForm(){
['pAddr','pYear','cName','cPhone','cAgent','notes'].forEach(id=>document.getElementById(id).value='');
document.getElementById('pType').value='single';
findings=[];renderFindings();
document.getElementById('fTitle').textContent='New Inspection';
}

function renderFindings(){
const el=document.getElementById('findingsEl');
el.innerHTML=findings.map((f,i)=>`<div class="finding ${f.sec===1?'s1':'s2'}"><div class="finding-type">${f.type}</div><div class="finding-loc">${f.loc} -- Section ${f.sec}</div><div class="finding-cost">$${f.cost||0}</div>${f.photo?'<img class="finding-photo" src="'+f.photo+'" alt="Photo">':''}<button class="finding-del" onclick="rmFinding(${i})" aria-label="Remove finding">remove</button></div>`).join('');
const s1=findings.filter(f=>f.sec===1),s2=findings.filter(f=>f.sec===2);
document.getElementById('s1Count').textContent=s1.length;
document.getElementById('s2Count').textContent=s2.length;
document.getElementById('s1Cost').textContent='$'+s1.reduce((a,f)=>a+(f.cost||0),0);
document.getElementById('s2Cost').textContent='$'+s2.reduce((a,f)=>a+(f.cost||0),0);
}

function rmFinding(i){findings.splice(i,1);renderFindings();}

function addFinding(){
curFinding={};curPhoto=null;curSec=1;selType='';selLoc='';
document.getElementById('fCost').value='';document.getElementById('fNotes').value='';
document.getElementById('photoPreview').innerHTML='';
document.getElementById('photoStatus').textContent='Tap to photograph this finding';
renderTypeGrid();renderLocGrid();setSec(1);
go('finding');
}

function renderTypeGrid(){
document.getElementById('typeGrid').innerHTML=TYPES.map(t=>`<div class="qp ${selType===t?'selected':''}" onclick="selType='${t}';renderTypeGrid()">${t}</div>`).join('');
}
function renderLocGrid(){
document.getElementById('locGrid').innerHTML=LOCS.map(l=>`<div class="qp ${selLoc===l?'selected':''}" onclick="selLoc='${l}';renderLocGrid()">${l}</div>`).join('');
}
function setSec(n){curSec=n;document.getElementById('secBtn1').className='qp'+(n===1?' selected':'');document.getElementById('secBtn2').className='qp'+(n===2?' selected':'');}

function saveFinding(){
if(!selType){toast('Pick a finding type');return;}
if(!selLoc){toast('Pick a location');return;}
findings.push({type:selType,loc:selLoc,sec:curSec,cost:parseInt(document.getElementById('fCost').value)||0,notes:document.getElementById('fNotes').value.trim(),photo:curPhoto});
renderFindings();toast('Finding added');go('new');
}
function cancelFinding(){go('new');}

async function saveInsp(){
const addr=document.getElementById('pAddr').value.trim();
if(!addr){toast('Enter property address');return;}
const total=findings.reduce((a,f)=>a+(f.cost||0),0);
const insp={id:editId||'i-'+Date.now(),addr,ptype:document.getElementById('pType').value,year:document.getElementById('pYear').value,client:document.getElementById('cName').value.trim(),phone:document.getElementById('cPhone').value.trim(),agent:document.getElementById('cAgent').value.trim(),findings:findings.slice(),notes:document.getElementById('notes').value.trim(),total,status:editId?(await gt(editId))?.status||'pending':'pending',date:editId?(await gt(editId))?.date||Date.now():Date.now(),isDemo:false};
await pt(insp);toast(editId?'Updated':'Saved');editId=null;go('list');
}

async function shareInsp(){
const addr=document.getElementById('pAddr').value.trim()||'(unsaved)';
const s1=findings.filter(f=>f.sec===1),s2=findings.filter(f=>f.sec===2);
const total=findings.reduce((a,f)=>a+(f.cost||0),0);
const text=`Take Care Termite -- WDO Inspection Summary\n${addr}\n\nSection 1 (${s1.length} findings): $${s1.reduce((a,f)=>a+(f.cost||0),0)}\n${s1.map(f=>'  - '+f.type+' ('+f.loc+'): $'+f.cost).join('\n')}\n\nSection 2 (${s2.length} findings): $${s2.reduce((a,f)=>a+(f.cost||0),0)}\n${s2.map(f=>'  - '+f.type+' ('+f.loc+'): $'+f.cost).join('\n')}\n\nTotal Estimated Repairs: $${total}`;
if(navigator.share){try{await navigator.share({title:'WDO Inspection',text});}catch(e){}}
else{try{await navigator.clipboard.writeText(text);toast('Copied to clipboard');}catch(e){}}
}

async function openCam(){
try{
const stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment',width:{ideal:1280}}});
camStream=stream;document.getElementById('camVid').srcObject=stream;
document.getElementById('camOv').classList.add('active');
}catch(e){
const inp=document.createElement('input');inp.type='file';inp.accept='image/*';inp.capture='environment';
inp.onchange=ev=>{const f=ev.target.files[0];if(!f)return;const r=new FileReader();r.onload=re=>{curPhoto=re.target.result;document.getElementById('photoPreview').innerHTML=`<img src="${curPhoto}" style="width:100%;max-height:200px;object-fit:cover;border-radius:var(--r)" alt="Finding photo">`;document.getElementById('photoStatus').textContent='Photo captured';toast('Photo added');};r.readAsDataURL(f);};inp.click();
}
}
function closeCam(){if(camStream){camStream.getTracks().forEach(t=>t.stop());camStream=null;}document.getElementById('camOv').classList.remove('active');}
function snap(){
const v=document.getElementById('camVid');const c=document.createElement('canvas');c.width=v.videoWidth;c.height=v.videoHeight;c.getContext('2d').drawImage(v,0,0);
curPhoto=c.toDataURL('image/jpeg',0.8);
document.getElementById('photoPreview').innerHTML=`<img src="${curPhoto}" style="width:100%;max-height:200px;object-fit:cover;border-radius:var(--r)" alt="Finding photo">`;
document.getElementById('photoStatus').textContent='Photo captured';closeCam();toast('Photo captured');
}

async function clearDemo(){const all=await ga();for(const i of all){if(i.isDemo)await dl(i.id);}document.getElementById('demoB').style.display='none';renderList();toast('Cleared');}
async function resetAll(){if(!confirm('Delete everything?'))return;await cl();findings=[];renderList();renderFindings();toast('Reset done');}
async function expData(){const d=await ga();const b=new Blob([JSON.stringify(d,null,2)],{type:'application/json'});const a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='termitelog-backup.json';a.click();}
async function impData(e){const f=e.target.files[0];if(!f)return;try{const t=await f.text();const d=JSON.parse(t);if(Array.isArray(d))for(const i of d)await pt(i);renderList();toast('Imported');}catch(err){toast('Bad file');}}

function toast(m){const el=document.createElement('div');el.className='toast';el.textContent=m;document.getElementById('toastC').appendChild(el);setTimeout(()=>el.remove(),2500);}
</script>
</body>
</html>
